{
  "contractName": "FutureChan",
  "constructorInputs": [
    {
      "name": "channel",
      "type": "bytes"
    }
  ],
  "abi": [
    {
      "name": "clearMessage",
      "inputs": []
    },
    {
      "name": "editMessage",
      "inputs": []
    }
  ],
  "bytecode": "OP_OVER OP_0 OP_NUMEQUAL OP_IF OP_INPUTINDEX OP_UTXOVALUE OP_10 OP_DIV e803 OP_MUL 80969800 OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_10 OP_MUL OP_NUMEQUAL OP_DUP OP_IF 00e1f505 OP_ROT OP_DROP OP_SWAP OP_ENDIF OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_NUMEQUAL OP_DUP OP_IF e803 OP_CHECKSEQUENCEVERIFY OP_DROP OP_ENDIF OP_NOT OP_SWAP OP_NOT OP_BOOLAND OP_IF OP_OVER 1027 OP_SUB OP_CHECKLOCKTIMEVERIFY OP_DROP OP_ELSE OP_OVER OP_SIZE OP_NIP OP_2 OP_PICK OP_CAT c0d3c0d0a06376b17568c0cec0d188c0cdc0c788c0d0c0c693c0d3c0cc939c77 OP_CAT aa20 OP_OVER OP_HASH256 OP_CAT 87 OP_CAT OP_DUP OP_SIZE OP_NIP OP_OVER OP_CAT OP_3 OP_PICK OP_SIZE OP_NIP OP_CAT OP_3 OP_PICK OP_CAT 00cc00c694a16900c788c08bc39c OP_CAT aa20 OP_OVER OP_HASH256 OP_CAT 87 OP_CAT OP_INPUTINDEX OP_OUTPUTBYTECODE OP_OVER OP_EQUALVERIFY OP_2DROP OP_2DROP OP_ENDIF OP_INPUTINDEX OP_OUTPUTTOKENCATEGORY OP_0 OP_EQUALVERIFY OP_2DROP OP_2DROP OP_1 OP_ELSE OP_SWAP OP_1 OP_NUMEQUALVERIFY OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_NUMEQUALVERIFY OP_INPUTINDEX OP_OUTPUTBYTECODE OP_INPUTINDEX OP_UTXOBYTECODE OP_EQUALVERIFY OP_TXINPUTCOUNT OP_1SUB OP_UTXOTOKENCATEGORY OP_INPUTINDEX OP_UTXOTOKENCATEGORY 20 OP_SPLIT OP_DROP OP_2 OP_CAT OP_EQUAL OP_NIP OP_ENDIF",
  "source": "pragma cashscript ~0.10.0;\n    \n// FutureChan - A message board contract.\n//\n// Message board for data written in mutable or immutable NFT commitments. \n//\n// - Messages can be removed after a week.\n// - Messages can be censored early by paying a 9 times multiplier penalty.  \n// - Messages must contain a value greater than 1/100th of a block time 2.5 months.\n// - Messages with insufficient value may be cleared by anyone at any time.\n// \n// - Messages can be edited (or deleted) using an NFT with minting capability.\n// \n// - Clearing (or censoring) messages must create 0.1 FBCH (or 1 FBCH) coupons.\n//\n// - Many different channels can be used by using a different channel identifier.\n// - Note: `cashc` compiler must be patched to not error from channel identifier usage. \n//\n//\n\ncontract FutureChan(bytes channel) {\n\n    // OP_OVER OP_0 OP_NUMEQUAL OP_IF\n    function clearMessage() {\n        \n        // Chan messages will create a 0.1 FBCH coupon targeting a FBCH vault \n        // where vault time is specified using the number of sats on the message.\n        // Example #1: 9873 sats => ( 9873 % 10 ) * 1000 => FBCH-0987000; 0.1 BCH coupon\n        //         #2:  543 sats =>  ( 543 % 10 ) * 1000 => MEV BURN\n        //         #3: 9873 sats =>               98,730 => FBCH-0987000; 1 BCH coupon\n\n        // OP_INPUTINDEX OP_UTXOVALUE OP_10 OP_DIV e803 OP_MUL \n        int vaultTime = int(tx.inputs[this.activeInputIndex].value / 10)*1000;\n\n        // Default to a 0.1 BCH series coupon\n        // 80969800 \n        int amount = 10000000;\n\n        // If the message is being censored, the burner must provide 9 X the initial value to a 1 BCH coupon\n        // OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_10 OP_MUL OP_NUMEQUAL \n        bool isPrematureBurn = tx.outputs[this.activeInputIndex].value == tx.inputs[this.activeInputIndex].value*10;\n\n        // If this is an early burn (moderation), create a 1 BCH coupon \n        // OP_DUP OP_IF   \n        if(isPrematureBurn){\n\n            // 00e1f505 OP_ROT OP_DROP OP_SWAP\n            amount = 100000000;\n        } // OP_ENDIF\n\n        // If the message has matured, the full value is used for a coupon\n        // OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_NUMEQUAL \n        bool hasMatured = tx.outputs[this.activeInputIndex].value == tx.inputs[this.activeInputIndex].value;\n\n        // If not early, require the message is a week old\n        // OP_DUP OP_IF \n        if(hasMatured){\n\n            // Require the message be at least a week old\n            // e803 OP_CHECKSEQUENCEVERIFY \n            require(tx.age >= 1000);\n\n        }  // OP_DROP OP_ENDIF \n\n        // If sats specifed a bad locktime (allow an early burn, no coupon, pure MEV)        \n        // OP_NOT OP_SWAP OP_NOT OP_BOOLAND OP_IF \n        if(!hasMatured && !isPrematureBurn){\n\n            // If the vault time indicated is less than ~2.5 months into the future.\n            // Let the message be cleared and the value be taken by anyone.\n            // OP_OVER 1027 OP_SUB OP_CHECKLOCKTIMEVERIFY OP_DROP \n            require(tx.time >= ( vaultTime - 10000 ));\n\n        } \n\n        // Otherwise, the sats must pay an FBCH coupon\n        // OP_ELSE \n        else{\n\n            // Calculate the future vault corresponding to the locktime\n            // OP_OVER OP_SIZE \n            // OP_NIP OP_2 OP_PICK \n            // OP_CAT c0d3c0d0a06376b17568c0cec0d188c0cdc0c788c0d0c0c693c0d3c0cc939c77 OP_CAT \n            bytes theVault = bytes(bytes(vaultTime).length) + \n                            bytes(vaultTime) + \n                            0xc0d3c0d0a06376b17568c0cec0d188c0cdc0c788c0d0c0c693c0d3c0cc939c77;\n\n            // Construct P2SH32 locking bytecode from redeem bytecode\n            // aa20 OP_OVER OP_HASH256 OP_CAT 87 \n            bytes vaultLockingBytecode = 0xaa20 + hash256(theVault) + 0x87;\n\n            // Calculate the coupon vault corresponding to the locktime\n            // OP_CAT OP_2 OP_PICK OP_SIZE OP_NIP \n            // OP_3 OP_PICK OP_CAT OP_OVER OP_SIZE OP_NIP \n            // OP_CAT OP_OVER OP_CAT 00cc00c694a16900c788c08bc39c OP_CAT \n            bytes theCoupon =  bytes(vaultLockingBytecode.length) + vaultLockingBytecode +\n                            bytes(bytes(amount).length) + bytes(amount) + \n                            0x00cc00c694a16900c788c08bc39c;\n\n            // Construct P2SH32 locking bytecode from redeem bytecode\n            // aa20 OP_OVER OP_HASH256 OP_CAT 87 OP_CAT \n            bytes couponLockingBytecode = 0xaa20 + hash256(theCoupon) + 0x87;\n\n            // Send the message value to the coupon vault.\n            // OP_INPUTINDEX OP_OUTPUTBYTECODE OP_OVER OP_EQUALVERIFY \n            require(tx.outputs[this.activeInputIndex].lockingBytecode == couponLockingBytecode);\n\n        } // OP_2DROP OP_2DROP OP_ENDIF\n\n        // Without CashTokens\n        // OP_INPUTINDEX OP_OUTPUTTOKENCATEGORY OP_0 OP_EQUALVERIFY \n        require(tx.outputs[this.activeInputIndex].tokenCategory == 0x);\n\n    } // OP_2DROP OP_2DROP \n\n\n    // Messages on mutable NFTs may be edited (or deleted) using a minting NFT of the same token category.  \n    // Messages on immutable NFTs may only be deleted. \n    //\n    // oldMessage[0]          -> editedMessage[0]\n    // oldMessage[1]          -> editedMessage[1]\n    // oldMessage[n]          -> editedMessage[n]\n    // mintingBaton[in.len-1] -> extendedMessage[n+1]\n    //                        -> extendedMessage[n+2]\n    //                        -> mintingBaton[out.len-1]\n    //\n    // OP_1 OP_ELSE OP_SWAP OP_1 OP_NUMEQUALVERIFY \n    function editMessage(){\n\n        // Sats must be carried forward.\n        // OP_INPUTINDEX OP_OUTPUTVALUE OP_INPUTINDEX OP_UTXOVALUE OP_NUMEQUALVERIFY \n        require(tx.outputs[this.activeInputIndex].value == tx.inputs[this.activeInputIndex].value);\n\n        // ... to an output on this same contract\n        // OP_INPUTINDEX OP_OUTPUTBYTECODE OP_INPUTINDEX OP_UTXOBYTECODE OP_EQUALVERIFY \n        require(tx.outputs[this.activeInputIndex].lockingBytecode == tx.inputs[this.activeInputIndex].lockingBytecode);\n        \n        // But neither the commitment, NFT nor token data are required as outputs. They may be omitted.\n\n        // As long as last input carried a matching minting NFT\n        // OP_TXINPUTCOUNT OP_1SUB OP_UTXOTOKENCATEGORY OP_INPUTINDEX OP_UTXOTOKENCATEGORY 20 OP_SPLIT OP_DROP OP_2 OP_CAT OP_EQUAL \n        require(tx.inputs[tx.inputs.length - 1].tokenCategory == tx.inputs[this.activeInputIndex].tokenCategory.split(32)[0] + 0x02);\n\n    } // OP_NIP  \n\n} // OP_ENDIF\n",
  "debug": {
    "bytecode": "5179009c63c0c65a9602e803950480969800c0ccc0c65a959c0079630400e1f505527a757c68c0ccc0c69c00796302e803b27568007a91517a919a63517902102794b175675179827752797e20c0d3c0d0a06376b17568c0cec0d188c0cdc0c788c0d0c0c693c0d3c0cc939c777e02aa205179aa7e01877e0079827751797e537982777e53797e0e00cc00c694a16900c788c08bc39c7e02aa205179aa7e01877ec0cd517987697575757568c0d1008769517777777767517a519c69c0ccc0c69c69c0cdc0c78769c35194cec0ce01207f75527e877768",
    "sourceMap": "24:4:114:5;;;;;33:38:33:59;:28::66:1;:69::71:0;:28:::1;:73::77:0;:24:::1;37:21:37:29:0;41:42:41:63;:31::70:1;:84::105:0;:74::112:1;:113::115:0;:74:::1;:31;45:11:45:26:0;;:27:49:9;48:21:48:30;:12::31:1;;;;45:27:49:9;53:37:53:58:0;:26::65:1;:79::100:0;:69::107:1;:26;57:11:57:21:0;;:22:63:9;61:30:61:34;:12::36:1;;57:22:63:9;67:12:67:22:0;;:11:::1;:27::42:0;;:26:::1;:11;:43:74:9:0;72:33:72:42;;:45::50;:33:::1;:12::54;;78::108:9:0;84:41:84:50;;:35::58:1;;85:34:85:43:0;;84:29::44:1;86:28:86:94:0;84:29:::1;90:41:90:47:0;:58::66;;:50::67:1;:41;:70::74:0;:41:::1;96:37:96:57:0;;:::64:1;;:68::88:0;;:31:::1;97:40:97:46:0;;:34::54:1;;96:31::55;97:64::70:0;;96:31::71:1;98:28:98:58:0;96:31:::1;102:42:102:48:0;:59::68;;:51::69:1;:42;:72::76:0;:42:::1;106:31:106:52:0;:20::69:1;:73::94:0;;:20:::1;:12::96;78::108:9;;;;;112:27:112:48:0;:16::63:1;:67::69:0;:16:::1;:8::71;24:4:114:5;;;;;;128::144::0;;;;;132:27:132:48;:16::55:1;:69::90:0;:59::97:1;:16;:8::99;136:27:136:48:0;:16::65:1;:79::100:0;:69::117:1;:16;:8::119;142:26:142:42:0;:45::46;:26:::1;:16::61;:75::96:0;:65::111:1;:118::120:0;:65::121:1;:::124;:127::131:0;:65:::1;:16;128:4:144:5;21:0:146:1",
    "logs": [],
    "requires": [
      {
        "ip": 38,
        "line": 61
      },
      {
        "ip": 53,
        "line": 72
      },
      {
        "ip": 101,
        "line": 106
      },
      {
        "ip": 111,
        "line": 112
      },
      {
        "ip": 128,
        "line": 132
      },
      {
        "ip": 134,
        "line": 136
      },
      {
        "ip": 147,
        "line": 142
      }
    ]
  },
  "compiler": {
    "name": "cashc",
    "version": "0.10.5"
  },
  "updatedAt": "2025-08-21T12:36:05.148Z"
}