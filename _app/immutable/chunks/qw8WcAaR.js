import{f as u,a as v,c as bt,t as ba}from"./DTc5U4eY.js";import{o as ga,a as ka}from"./_R59KZhj.js";import{p as Jt,c as i,r as n,s as l,t as k,a as Qt,f as at,I as a,aB as x,ak as _,ao as At,af as Vt,aA as wa}from"./CQU5mOuk.js";import{d as Xt,s as p}from"./CF3aPdyL.js";import{a as xa}from"./Cm-IrJru.js";import{i as m}from"./CZ0rTjPC.js";import{e as ya,i as qa}from"./CbL2L94E.js";import{s as S,r as Ta}from"./-rOGAMhN.js";import{r as Ea}from"./DRK1mIbe.js";import{a as Na,b as Ca}from"./Oj09dCTU.js";import{p as Sa,s as Aa}from"./DBDCTY7c.js";import{p as Pa}from"./BB3PNI33.js";import{$ as Oa,a as Pt}from"./BDt1pbpk.js";import{I as za,B as Da,W as Ia,T as Ra,g as Ba,N as jt,a as Gt}from"./BTBIn4-B.js";import{b as zt}from"./B8sppVjI.js";import{d as E,e as Ma,f as Ha,h as La}from"./Bt3MikUi.js";import{p as Ot,j as Ua,d as Za,s as Kt,b as ht,k as ft,q as Wa}from"./BQUio51k.js";import{B as Fa}from"./BzLj6JBc.js";import{s as Va}from"./CXfu__Ha.js";import{C as ja}from"./B7hCbxZp.js";import{D as Ga}from"./DMvn4Q5j.js";const Ka="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='15px'%20fill='%23000'%3e%3cpath%20d='M280-120q-33%200-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0%2033-23.5%2056.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160%200h80v-360h-80v360ZM280-720v520-520Z'/%3e%3c/svg%3e",Ja="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='48px'%20viewBox='0%20-960%20960%20960'%20width='48px'%20fill='%23888'%3e%3cpath%20d='M272-120v-512l278-288%2058%2046-52%20242h359v171L767-120H272Zm60-60h397l126-299v-93H482l53-249-203%20214v427Zm0-427v427-427ZM79-120v-512h193v60H139v392h133v60H79Z'/%3e%3c/svg%3e";var Qa=u('<img height="32px" class="svelte-1kup2az"/>'),Xa=u('<div style="width:32px"></div>'),Ya=(b,s)=>{_(s,!a(s))},$a=u('<div> <button class="svelte-1kup2az"> </button></div>'),te=(b,s)=>{_(s,!a(s))},ae=u('<div> <button class="svelte-1kup2az"> </button></div>'),ee=u('<div class="error svelte-1kup2az"> </div>'),se=(b,s)=>{s.likePost(s.hash)},oe=u('<img height="32px" class="svelte-1kup2az"/>'),re=u('<div style="width:32px"></div>'),ie=u('<div class="container svelte-1kup2az"><div class="auth svelte-1kup2az"><!></div> <div><div class="footer svelte-1kup2az"><div class="fill svelte-1kup2az"></div> <div class="action"></div></div> <!> <div class="footer svelte-1kup2az"><div class="hash svelte-1kup2az"> </div> <div class="fill svelte-1kup2az"></div> <div class="actions svelte-1kup2az"><button class="svelte-1kup2az"><img height="16px" alt="likes"/> </button></div> <div class="timestamp svelte-1kup2az"> </div></div></div> <div class="auth svelte-1kup2az"><!></div></div>');function ne(b,s){Jt(s,!0);let w=x(!1);const nt=400;var lt=ie(),ct=i(lt),gt=i(ct);{var y=r=>{var o=Qa();k(M=>{S(o,"src",M),S(o,"alt",s.auth)},[()=>zt(s.auth,16)]),v(r,o)},J=r=>{var o=Xa();v(r,o)};m(gt,r=>{s.thisAuth?r(J,!1):r(y)})}n(ct);var U=l(ct,2),D=l(i(U),2);{var mt=r=>{var o=bt(),M=at(o);{var wt=F=>{var X=$a(),V=i(X),Y=l(V);Y.__click=[Ya,w];var P=i(Y,!0);n(Y),n(X),k(()=>{p(V,`${s.body??""} `),p(P,a(w)?"show less":"show more")}),v(F,X)},xt=(F,X)=>{{var V=P=>{var j=ae(),dt=i(j),_t=l(dt);_t.__click=[te,w];var yt=i(_t,!0);n(_t),n(j),k(qt=>{p(dt,`${qt??""} `),p(yt,a(w)?"show less":"show more")},[()=>s.body.substring(0,nt)+" ..."]),v(P,j)},Y=P=>{var j=ba();k(()=>p(j,s.body)),v(P,j)};m(F,P=>{s.body.length>nt+20?P(V):P(Y,!1)},X)}};m(M,F=>{s.body.length>nt+20&&a(w)?F(wt):F(xt,!1)})}v(r,o)},q=r=>{var o=ee(),M=i(o,!0);n(o),k(()=>p(M,s.error)),v(r,o)};m(D,r=>{s.error?r(q,!1):r(mt)})}var Z=l(D,2),N=i(Z),I=i(N,!0);n(N);var et=l(N,4),W=i(et);W.__click=[se,s];var R=i(W),kt=l(R);n(W),n(et);var A=l(et,2),st=i(A);n(A),n(Z),n(U);var Q=l(U,2),B=i(Q);{var h=r=>{var o=oe();k(M=>{S(o,"src",M),S(o,"alt",s.auth)},[()=>zt(s.auth,16)]),v(r,o)},vt=r=>{var o=re();v(r,o)};m(B,r=>{s.thisAuth?r(h):r(vt,!1)})}n(Q),n(lt),k(()=>{Va(U,1,`post ${s.thisAuth?"op":""} `,"svelte-1kup2az"),p(I,s.hash),S(R,"src",Ja),p(kt,` ${s.likes??""}`),p(st,`${s.height??""} ■ ${s.sequence??""}`)}),v(b,lt),Qt()}Xt(["click"]);var le=(b,s)=>s(""),ce=u('<a target="_blank"> </a>'),ve=u("<img/>"),de=u('<img alt="Disconnected"/>'),_e=(b,s,w)=>s(a(w)),ue=u('<div class="deleteMe svelte-180sfqa"><button class="svelte-180sfqa"><img height="36px"/></button></div>'),he=u("<!> <!>",1),fe=u('<p style="color: red"> </p>'),me=(b,s)=>s(),pe=u('<div class="row footer svelte-180sfqa"><h2>Create new identity</h2> <button class="svelte-180sfqa">New identity 1M sats</button></div>'),be=u('<div class="row footer svelte-180sfqa"><p><a href="/wallet">Deposit funds</a> to create identity</p></div>'),ge=(b,s)=>s(),ke=u('<img height="32px" alt="avatar" class="svelte-180sfqa"/>'),we=u('<div style="font-size:x-small;"> <br/> </div>'),xe=(b,s,w)=>s(a(w)),ye=u('<div class="edit svelte-180sfqa"><textarea class="svelte-180sfqa"> </textarea> <div class="estimate svelte-180sfqa"> </div></div> <div class="send svelte-180sfqa"><div class="auth svelte-180sfqa"><!> <!></div> <button class="svelte-180sfqa">Send</button></div>',1),qe=u("<p>Not connected?</p>"),Te=u('<div class="row footer svelte-180sfqa"><!></div>'),Ee=(b,s)=>s(1e7),Ne=(b,s)=>s(1e6),Ce=(b,s)=>s(),Se=(b,s)=>s(),Ae=(b,s)=>s(),Pe=u('<button class="svelte-180sfqa">Empty Baton Sats</button>'),Oe=u('<div class="row footer svelte-180sfqa"><button class="svelte-180sfqa">Top up 10M sats</button> <button class="svelte-180sfqa">Top up 1M sats</button></div> <div class="row footer svelte-180sfqa"><button class="svelte-180sfqa">Clear Old Posts</button> <button class="svelte-180sfqa">Burn Spam</button></div> <div class="row footer svelte-180sfqa"><!></div>',1),ze=u('<div class="box svelte-180sfqa"><div class="row header svelte-180sfqa"> <sub>■</sub> <div style="flex: 2 2 auto;"></div> <b class="svelte-180sfqa"><a href="/pop/">pop</a> </b> <div style="flex: 2 2 auto;"></div> <!> <!> <!></div> <div id="chat" class="row content svelte-180sfqa"><!></div> <!> <div class="row footer svelte-180sfqa"><div style="margin: auto;">Advanced</div> <div><label class="switch svelte-180sfqa"><input type="checkbox" class="svelte-180sfqa"/> <span class="slider round svelte-180sfqa"></span></label></div></div> <!></div>');function as(b,s){Jt(s,!0);const w=Pa.url.hostname=="vox.cash",nt=w?"bitcoincash":"bchtest",lt=w?"bch.imaginary.cash":"chipnet.bch.ninja",ct=w?"https://explorer.salemkode.com/address/":"https://cbch.loping.net/address/",gt=Ot(`OP_RETURN <"${E.PROTOCOL_IDENTIFIER}">`);let y=x(0),J=x(0),U=x(0),D=x(""),mt=x(""),q=Sa(s,"topic",15),Z=x(""),N=x(""),I=x(0),et=x(0),W=x(!1);const R=Vt(()=>E.getScriptHash(q())),kt=Vt(()=>E.getAddress(q(),nt));let A=x(At([])),st=x(At([])),Q,B="",h,vt="",r,o=x(At([]));const M=()=>{clearTimeout(Q),Q=setTimeout(()=>{V(),dt()},1500)},wt=async function(t){if(t.method==="blockchain.headers.subscribe"){let e=t.params[0];_(y,e.height,!0)}else t.method==="blockchain.scripthash.subscribe"?t.params[1]!==a(mt)&&(_(mt,t.params[1],!0),_(D,Pt[h.status],!0),M()):console.log(t)},xt=function(){let t=document.getElementById("chat");var e=t.scrollHeight;t.scrollTo(0,e)},F=async function(t){let e=E.like(q(),t,a(o)[0],(Math.round(a(y)/1e3)+10)*10,B),c=ht(ft(e.transaction));await ut(c)},X=async function(){let t=await h.request("blockchain.headers.get_tip");if(t instanceof Error)throw t;_(y,t.height,!0)},V=async function(){let t=await h.request("blockchain.scripthash.listunspent",vt,"include_tokens");if(t instanceof Error)throw t;_(J,Kt(t),!0),_(o,t.filter(e=>e.token_data&&e.token_data.nft&&e.token_data.nft.commitment.startsWith(gt)),!0),a(o).length>0&&a(o)[0].token_data&&_(N,a(o)[0].token_data.category,!0)},Y=async function(){let t=await r.send([new Gt({cashaddr:r.getTokenDepositAddress(),tokenId:a(o)[0].token_data.category,amount:0,capability:a(o)[0].token_data.nft.capability,commitment:a(o)[0].token_data.nft.commitment,value:800})]);console.log(t)},P=async function(){let t=await h.request("blockchain.scripthash.listunspent",a(R),"include_tokens");if(t instanceof Error)throw t;let e=t.filter(c=>c.height>0&&a(y)-c.height>1e3).slice(0,300);if(e.length>0){let c=E.clear(q(),e,a(o)[0],B,a(y)),d=ht(ft(c.transaction));console.log(d),await ut(d)}},j=async function(){let t=await h.request("blockchain.scripthash.listunspent",a(R),"include_tokens");if(t instanceof Error)throw t;let e=t.filter(c=>Math.floor(c.value/10)*1e3-c.height<1e3);if(e.length>0){let c=E.clear(q(),e,a(o)[0],B,a(y)),d=ht(ft(c.transaction));console.log(d),await ut(d)}},dt=async function(){let t=await h.request("blockchain.scripthash.listunspent",a(R),"include_tokens");if(t instanceof Error)throw t;_(U,Kt(t),!0);let e=Array.from(new Set(t.map(d=>d.tx_hash))),c=await h.request("blockchain.scripthash.get_history",a(R),a(y)-1e4,-1);_(st,await Ma(h,e),!0),_(A,Ha(c,a(st),q()),!0),_(A,a(A).map(d=>({thisAuth:a(N)==d.auth,...d})),!0),a(A).slice(-1).length>0?_(I,a(A).slice(-1)[0].height<=0?a(A).slice(-1)[0].sequence+1:0,!0):_(I,0)},_t=async function(t){let e=await h.request("blockchain.scripthash.listunspent",a(R),"include_tokens");if(e instanceof Error)throw e;let c=e.filter(f=>f.tx_hash==t.hash).slice(0,200),d=E.clear(q(),c,a(o)[0],B,a(y)),g=ht(ft(d.transaction));console.log(g),await ut(g)},yt=()=>{clearTimeout(Q),Q=setTimeout(()=>{_(et,qt(a(Z)),!0)},500)},qt=function(t){if(t.length>0){let e=E.post(q(),t,a(o)[0],(Math.round(a(y)/1e3)+10)*10,B,a(I));const c=e.transaction.outputs[e.transaction.outputs.length-1].valueSatoshis;return Number(Wa(e.sourceOutputs)-c)}else return 0},Yt=async function(t){let e=(Math.round(a(y)/1e3)+10)*10,c=E.post(q(),t,a(o)[0],e,B,a(I)),d=ht(ft(c.transaction));await ut(d),_(Z,"")},ut=async function(t){let e=await h.request("blockchain.transaction.broadcast",t);if(_(I,a(I)+1),e instanceof Error)throw _(D,Pt[h.status],!0),e},$t=async function(){await r.sendMax(r.getDepositAddress());let t=Ot(`OP_RETURN <"${E.PROTOCOL_IDENTIFIER}"> <"pseudonymous">`);await r.tokenGenesis({cashaddr:r.getTokenDepositAddress(),commitment:t,capability:jt.minting,value:1e6})},Dt=async function(t){_(J,a(o)[0].value,!0),_(N,a(o)[0].token_data.category,!0);let e=Ot(`OP_RETURN <"${E.PROTOCOL_IDENTIFIER}"> <"pseudonymous">`);await r.send(new Gt({cashaddr:r.getTokenDepositAddress(),tokenId:a(N),commitment:e,capability:jt.minting,value:a(J)+t})),await V()};ga(async()=>{Da.StorageProvider=za,r=w?await Ia.named("vox"):await Ra.named("vox"),B=Ba(r.mnemonic,r.derivationPath.slice(0,-2),r.isTestnet);let t=Ua(r.getDepositAddress());if(typeof t=="string")throw t;vt=Za(t.bytecode),h=new Oa(E.USER_AGENT,"1.4.1",lt),await h.connect(),h.on("notification",wt),_(D,Pt[h.status],!0),await h.subscribe("blockchain.scripthash.subscribe",a(R)),await h.subscribe("blockchain.scripthash.subscribe",vt),await X(),await V(),await dt(),xt()}),ka(async()=>{await r.provider.disconnect(),await h.disconnect()});var Tt=ze(),Et=i(Tt),It=i(Et,!0),Rt=l(It,2),Nt=l(Rt,3),Bt=i(Nt);Bt.__click=[le,q];var ta=l(Bt);n(Nt);var Mt=l(Nt,4);{var aa=t=>{var e=ce(),c=i(e);n(e),k(d=>{S(e,"href",`${ct}${a(kt)??""}`),p(c,`${d??""}k sats  `)},[()=>Math.floor(Number(a(U))/1e3).toLocaleString()]),v(t,e)};m(Mt,t=>{a(U)&&t(aa)})}var Ht=l(Mt,2);Fa(Ht,{get template(){return E.template}});var ea=l(Ht,2);{var sa=t=>{var e=ve();k(()=>{S(e,"src",ja),S(e,"alt",a(D))}),v(t,e)},oa=t=>{var e=de();k(()=>S(e,"src",Ga)),v(t,e)};m(ea,t=>{a(D)=="CONNECTED"?t(sa):t(oa,!1)})}n(Et);var Ct=l(Et,2),ra=i(Ct);{var ia=t=>{var e=bt(),c=at(e);xa(c,()=>a(st),null,(d,g)=>{var f=bt(),H=at(f);ya(H,17,()=>a(A),qa,(ot,rt)=>{var T=he(),O=at(T);ne(O,Aa({likePost:F},()=>a(rt)));var $=l(O,2);{var L=G=>{var tt=ue(),z=i(tt);z.__click=[_e,_t,rt];var K=i(z);n(z),n(tt),k(()=>S(K,"src",Ka)),v(G,tt)};m($,G=>{a(W)&&G(L)})}v(ot,T)}),v(d,f)},(d,g)=>{var f=fe(),H=i(f,!0);n(f),k(()=>p(H,a(g).message)),v(d,f)}),v(t,e)};m(ra,t=>{a(st)&&t(ia)})}n(Ct);var Lt=l(Ct,2);{var na=t=>{var e=pe(),c=l(i(e),2);c.__click=[me,$t],n(e),v(t,e)},la=(t,e)=>{{var c=g=>{var f=be();v(g,f)},d=g=>{var f=Te(),H=i(f);{var ot=T=>{var O=ye(),$=at(O),L=i($);Ea(L),L.__keyup=[ge,yt];var G=l(L,2),tt=i(G);n(G),n($);var z=l($,2),K=i(z),Ft=i(K);{var da=C=>{var it=ke();k(pt=>S(it,"src",pt),[()=>zt(a(N),16)]),v(C,it)};m(Ft,C=>{a(N)&&C(da)})}var _a=l(Ft,2);{var ua=C=>{var it=we(),pt=i(it,!0),fa=l(pt,2);n(it),k((ma,pa)=>{p(pt,ma),p(fa,` ${pa??""}sats`)},[()=>La(a(o)[0].token_data.nft.commitment),()=>a(o)[0].value.toLocaleString()]),v(C,it)};m(_a,C=>{a(o).length>0&&C(ua)})}n(K);var ha=l(K,2);ha.__click=[xe,Yt,Z],n(z),k(C=>p(tt,`${C??""} sats`),[()=>a(et).toLocaleString()]),Ca(L,()=>a(Z),C=>_(Z,C)),v(T,O)},rt=T=>{var O=qe();v(T,O)};m(H,T=>{a(D)=="CONNECTED"?T(ot):T(rt,!1)})}n(f),v(g,f)};m(t,g=>{a(J)<11e5&&a(o).length==0?g(c):g(d,!1)},e)}};m(Lt,t=>{a(J)>1e6&&a(o).length==0?t(na):t(la,!1)})}var St=l(Lt,2),Ut=l(i(St),2),Zt=i(Ut),Wt=i(Zt);Ta(Wt),wa(2),n(Zt),n(Ut),n(St);var ca=l(St,2);{var va=t=>{var e=bt(),c=at(e);{var d=g=>{var f=Oe(),H=at(f),ot=i(H);ot.__click=[Ee,Dt];var rt=l(ot,2);rt.__click=[Ne,Dt],n(H);var T=l(H,2),O=i(T);O.__click=[Ce,P];var $=l(O,2);$.__click=[Se,j],n(T);var L=l(T,2),G=i(L);{var tt=z=>{var K=Pe();K.__click=[Ae,Y],v(z,K)};m(G,z=>{a(N)&&z(tt)})}n(L),v(g,f)};m(c,g=>{a(o).length>0&&g(d)})}v(t,e)};m(ca,t=>{a(W)&&t(va)})}n(Tt),k(t=>{p(It,t),p(Rt,` ${a(I)??""} `),p(ta,` ${q()??""}`)},[()=>a(y).toLocaleString()]),Na(Wt,()=>a(W),t=>_(W,t)),v(b,Tt),Qt()}Xt(["click","keyup"]);export{ne as C,as as a};
//# sourceMappingURL=qw8WcAaR.js.map
