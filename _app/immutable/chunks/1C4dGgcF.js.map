{"version":3,"file":"1C4dGgcF.js","sources":["../../../../../../../../node_modules/.pnpm/@bitauth+libauth@3.1.0-next.8/node_modules/@bitauth/libauth/build/lib/address/base58-address.js","../../../../../../../../node_modules/.pnpm/@bitauth+libauth@3.1.0-next.8/node_modules/@bitauth/libauth/build/lib/key/key-utils.js","../../../../../../../../node_modules/.pnpm/@bitauth+libauth@3.1.0-next.8/node_modules/@bitauth/libauth/build/lib/key/wallet-import-format.js","../../../../../../../../node_modules/.pnpm/@mainnet-cash+indexeddb-storage@2.7.8/node_modules/@mainnet-cash/indexeddb-storage/dist/module/IndexedDBProvider.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/getRuntimePlatform.js","../../../../../../__vite-browser-external","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/interface.js","../../../../../../../../node_modules/.pnpm/@electrum-cash+network@4.1.1-development.10647307155_patch_hash=f7b2ff0ce9059e21d0dfaca_02f6721151f3fd27c4df33a006d5d2c1/node_modules/@electrum-cash/network/dist/index.mjs","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/delay.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/transaction.js","../../../../../../../../node_modules/.pnpm/@scure+bip39@1.6.0/node_modules/@scure/bip39/esm/wordlists/english.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/constant.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/config.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/header.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/cache/IndexedDbCache.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/cache/WebStorageCache.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/cache/MemoryCache.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/ElectrumNetworkProvider.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/chain.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/enum.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/db/ExchangeRateProvider.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/rate/ExchangeRate.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/sanitizeUnit.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/amountInSatoshi.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/hash160.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/deriveCashaddr.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/model.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/asSendRequestObject.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/satoshiToAmount.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/convert.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/derivePublicKeyHash.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/getXPubKey.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/sumUtxoValue.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/floor.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/balanceObjectFromSatoshi.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/constant.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/configuration.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/util.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/default.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/Connection.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/Bcmr.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/message/signed.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/history/electrumTransformer.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/network/getRelayFeeCache.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/enum.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/transaction/allocateFee.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/sumSendRequestAmounts.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/transaction/Wif.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/checkUtxos.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/Util.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/Base.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/crypto.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/utils.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/hmac.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/pbkdf2.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/_md.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/_u64.js","../../../../../../../../node_modules/.pnpm/@noble+hashes@1.8.0/node_modules/@noble/hashes/esm/sha2.js","../../../../../../../../node_modules/.pnpm/@scure+base@1.2.6/node_modules/@scure/base/lib/esm/index.js","../../../../../../../../node_modules/.pnpm/@scure+bip39@1.6.0/node_modules/@scure/bip39/esm/index.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/checkForEmptySeed.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/checkWifNetwork.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/util/randomBytes.js","../../../../../../../../node_modules/.pnpm/mainnet-js@2.7.8_patch_hash=16d52577e1f6a8b0b78f7b8cc903dcb6be39d81dfe4014645d78a98aad873523/node_modules/mainnet-js/dist/module/wallet/Wif.js"],"sourcesContent":["import { hash256, sha256 as internalSha256 } from '../crypto/crypto.js';\nimport { base58ToBin, binToBase58, flattenBinArray, formatError, } from '../format/format.js';\n/**\n * Base58 version byte values for common Base58Address format\n * (A.K.A. \"Base58Check\") versions.\n */\nexport var Base58AddressFormatVersion;\n(function (Base58AddressFormatVersion) {\n    /**\n     * A Pay to Public Key Hash (P2PKH) address – base58 encodes to a leading `1`.\n     *\n     * Hex: `0x00`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2pkh\"] = 0] = \"p2pkh\";\n    /**\n     * A 20-byte Pay to Script Hash (P2SH20) address – base58 encodes to a leading\n     * `3`.\n     *\n     * Hex: `0x05`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2sh20\"] = 5] = \"p2sh20\";\n    /**\n     * A private key in Wallet Import Format. For private keys used with\n     * uncompressed public keys, the payload is 32 bytes and causes the version\n     * to be encoded as a `5`. For private keys used with compressed public keys,\n     * a final `0x01` byte is appended to the private key, increasing the payload\n     * to 33 bytes, and causing the version to be encoded as a `K` or `L`.\n     *\n     * Hex: `0x80`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"wif\"] = 128] = \"wif\";\n    /**\n     * A testnet Pay to Public Key Hash (P2PKH) address – base58 encodes to a\n     * leading `m` or `n`.\n     *\n     * Hex: `0x6f`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2pkhTestnet\"] = 111] = \"p2pkhTestnet\";\n    /**\n     * A testnet 20-byte Pay to Script Hash (P2SH20) address – base58 encodes to a\n     * leading `2`.\n     *\n     * Hex: `0xc4`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2sh20Testnet\"] = 196] = \"p2sh20Testnet\";\n    /**\n     * A private key in Wallet Import Format intended for testnet use. For private\n     * keys used with uncompressed public keys, the payload is 32 bytes and causes\n     * the version to be encoded as a `9`. For private keys used with compressed\n     * public keys, a final `0x01` byte is appended to the private key, increasing\n     * the payload to 33 bytes, and causing the version to be encoded as a `c`.\n     *\n     * Hex: `0xef`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"wifTestnet\"] = 239] = \"wifTestnet\";\n    /**\n     * A Pay to Public Key Hash (P2PKH) address intended for use on the Bitcoin\n     * Cash network – base58 encodes to a leading `C`. This version was\n     * temporarily used by the Copay project before the CashAddress format was\n     * standardized.\n     *\n     * Hex: `0x1c`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2pkhCopayBCH\"] = 28] = \"p2pkhCopayBCH\";\n    /**\n     * A 20-byte Pay to Script Hash (P2SH20) address intended for use on the\n     * Bitcoin Cash network – base58 encodes to a leading `H`. This version was\n     * temporarily used by the Copay project before the CashAddress format was\n     * standardized.\n     *\n     * Hex: `0x28`\n     */\n    Base58AddressFormatVersion[Base58AddressFormatVersion[\"p2sh20CopayBCH\"] = 40] = \"p2sh20CopayBCH\";\n})(Base58AddressFormatVersion || (Base58AddressFormatVersion = {}));\n/**\n * Encode a payload using the Base58Address format (A.K.A. \"Base58Check\"), the\n * original address format used by the Satoshi implementation.\n *\n * Note, this method does not enforce error handling via the type system. The\n * returned string will not be a valid Base58Address if `hash` is not exactly 20\n * bytes. If needed, validate the length of `hash` before calling this method.\n *\n * To decode a Base58Address-like format, use {@link decodeBase58AddressFormat}.\n *\n * @remarks\n * A Base58Address includes a 1-byte prefix to indicate the address version, a\n * variable-length payload, and a 4-byte checksum:\n *\n * `[version: 1 byte] [payload: variable length] [checksum: 4 bytes]`\n *\n * The checksum is the first 4 bytes of the double-SHA256 hash of the version\n * byte followed by the payload.\n *\n * @param version - the address version byte (see\n * {@link Base58AddressFormatVersion})\n * @param payload - the Uint8Array payload to encode\n * @param sha256 - an implementation of sha256 (defaults to the internal WASM\n * implementation)\n */\nexport const encodeBase58AddressFormat = (version, payload, sha256 = internalSha256) => {\n    const checksumBytes = 4;\n    const content = Uint8Array.from([version, ...payload]);\n    const checksum = hash256(content, sha256).slice(0, checksumBytes);\n    const bin = flattenBinArray([content, checksum]);\n    return binToBase58(bin);\n};\n/**\n * Encode a hash as a Base58Address.\n *\n * Note, this method does not enforce error handling via the type system. The\n * returned string will not be a valid Base58Address if `hash` is not exactly 20\n * bytes. If needed, validate the length of `hash` before calling this method.\n *\n * For other standards that use the Base58Address format but have other version\n * or length requirements, use {@link encodeCashAddressFormat}.\n *\n * To decode a Base58Address, see {@link decodeBase58Address}.\n *\n * @param type - the type of address to encode: `p2pkh`, `p2sh20`,\n * `p2pkh-testnet`, or `p2sh20-testnet`\n * @param hash - the 20-byte hash to encode\n * (`RIPEMD160(SHA256(public key or bytecode))`)\n * @param sha256 - an implementation of sha256 (defaults to the internal WASM\n * implementation)\n */\nexport const encodeBase58Address = (type, payload, sha256 = internalSha256) => encodeBase58AddressFormat({\n    p2pkh: Base58AddressFormatVersion.p2pkh,\n    p2pkhCopayBCH: Base58AddressFormatVersion.p2pkhCopayBCH,\n    p2pkhTestnet: Base58AddressFormatVersion.p2pkhTestnet,\n    p2sh20: Base58AddressFormatVersion.p2sh20,\n    p2sh20CopayBCH: Base58AddressFormatVersion.p2sh20CopayBCH,\n    p2sh20Testnet: Base58AddressFormatVersion.p2sh20Testnet,\n}[type], payload, sha256);\nexport var Base58AddressError;\n(function (Base58AddressError) {\n    Base58AddressError[\"unknownCharacter\"] = \"Base58Address error: address may only contain valid base58 characters.\";\n    Base58AddressError[\"tooShort\"] = \"Base58Address error: address is too short to be valid.\";\n    Base58AddressError[\"invalidChecksum\"] = \"Base58Address error: address has an invalid checksum.\";\n    Base58AddressError[\"unknownAddressVersion\"] = \"Base58Address error: address uses an unknown address version.\";\n    Base58AddressError[\"incorrectLength\"] = \"Base58Address error: the encoded payload is not the correct length (20 bytes).\";\n})(Base58AddressError || (Base58AddressError = {}));\n/**\n * Attempt to decode a Base58Address-formatted string. This is more lenient than\n * {@link decodeCashAddress}, which also validates the address version.\n *\n * Returns the contents of the address or an error message as a string.\n *\n * To encode a Base58Address-like format, use {@link encodeBase58AddressFormat}.\n *\n * @param address - the string to decode as a base58 address\n * @param sha256 - an implementation of sha256 (defaults to the internal WASM\n * implementation)\n */\nexport const decodeBase58AddressFormat = (address, sha256 = internalSha256) => {\n    const checksumBytes = 4;\n    const bin = base58ToBin(address);\n    if (typeof bin === 'string') {\n        return formatError(Base58AddressError.unknownCharacter, bin);\n    }\n    const minimumBase58AddressLength = 5;\n    if (bin.length < minimumBase58AddressLength) {\n        return Base58AddressError.tooShort;\n    }\n    const content = bin.slice(0, -checksumBytes);\n    const checksum = bin.slice(-checksumBytes);\n    const expectedChecksum = sha256\n        .hash(sha256.hash(content))\n        .slice(0, checksumBytes);\n    if (!checksum.every((value, i) => value === expectedChecksum[i])) {\n        return Base58AddressError.invalidChecksum;\n    }\n    return {\n        payload: content.slice(1),\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        version: content[0],\n    };\n};\n/**\n * Decode and validate a Base58Address, strictly checking the version and\n * payload length.\n *\n * Because the Wallet Import Format (WIF) private key serialization format uses\n * the Base58Address format, some libraries allow WIF key decoding via the same\n * method as base58 address decoding. This method accepts only Base58Address\n * types, but WIF keys can be decoded with {@link decodePrivateKeyWif}.\n *\n * For other address-like standards that closely follow the Base58Address\n * format (but have alternative version byte requirements), use\n * {@link decodeBase58AddressFormat}.\n *\n * To encode a Base58Address, see {@link encodeBase58Address}.\n *\n * @param address - the string to decode as a base58 address\n * @param sha256 - an implementation of sha256 (defaults to the internal WASM\n * implementation)\n */\nexport const decodeBase58Address = (address, sha256 = internalSha256) => {\n    const decoded = decodeBase58AddressFormat(address, sha256);\n    if (typeof decoded === 'string')\n        return decoded;\n    if (![\n        Base58AddressFormatVersion.p2pkh,\n        Base58AddressFormatVersion.p2sh20,\n        Base58AddressFormatVersion.p2pkhTestnet,\n        Base58AddressFormatVersion.p2sh20Testnet,\n        Base58AddressFormatVersion.p2pkhCopayBCH,\n        Base58AddressFormatVersion.p2sh20CopayBCH,\n    ].includes(decoded.version)) {\n        return Base58AddressError.unknownAddressVersion;\n    }\n    const hash160Length = 20;\n    if (decoded.payload.length !== hash160Length) {\n        return Base58AddressError.incorrectLength;\n    }\n    return decoded;\n};\n//# sourceMappingURL=base58-address.js.map","import { sha256 as internalSha256 } from '../crypto/crypto.js';\nimport { binsAreEqual, formatError } from '../format/format.js';\nimport { deriveHdPrivateNodeFromSeed, validateSecp256k1PrivateKey, } from './hd-key.js';\nexport var EntropyGenerationError;\n(function (EntropyGenerationError) {\n    EntropyGenerationError[\"duplicateResults\"] = \"Entropy generation error: the \\\"getRandomValues\\\" function provided by this JavaScript environment returned duplicate results across two evaluations; entropy generation was halted for safety.\";\n    EntropyGenerationError[\"insufficientEntropy\"] = \"Entropy generation error: the provided list of events contains insufficient entropy.\";\n})(EntropyGenerationError || (EntropyGenerationError = {}));\n/**\n * Generate a Uint8Array of the specified length containing a\n * cryptographically-random series of bytes. See {@link generateRandomBytes} for\n * a safer alternative.\n *\n * @param length - the length of the Uint8Array to generate\n * @param cryptoInstance - an instance of the `Crypto` object with the\n * `getRandomValues` function (defaults to the `crypto` global property).\n */\nexport const generateRandomBytesUnchecked = (length, cryptoInstance = crypto) => cryptoInstance.getRandomValues(new Uint8Array(length));\n/**\n * Generate a Uint8Array of the specified length containing a\n * cryptographically-random series of bytes.\n *\n * For safety, this function first verifies that the provided `generate`\n * function produces unique results across two evaluations; by default, this\n * verifies that the `crypto.getRandomValues` function provided by the\n * JavaScript environment appears to be producing random values.\n *\n * While this validation can't prevent a compromised environment from producing\n * attacker-known entropy, it may help to prevent software defects in unusual\n * environments (e.g. React Native) from impacting end-user security.\n *\n * An `Error` is thrown if this validation fails, otherwise, the `Uint8Array`\n * produced by the first evaluation is returned.\n *\n * @param length - the length of the Uint8Array to generate\n * @param generate - a function used to generate the random bytes, defaults\n * to {@link generateRandomBytesUnchecked}.\n */\nexport const generateRandomBytes = (length, generate = generateRandomBytesUnchecked) => {\n    const firstRun = generate(length);\n    const secondRun = generate(length);\n    if (firstRun === secondRun || binsAreEqual(firstRun, secondRun))\n        return formatError(EntropyGenerationError.duplicateResults, `First result: [${String(firstRun)}]; second result: [${String(secondRun)}].`, true);\n    return firstRun;\n};\n/**\n * Securely generate a 32-byte, cryptographically random seed (Uint8Array) for\n * use in Hierarchical Deterministic (HD) Key derivation\n * (see {@link deriveHdPrivateNodeFromSeed}).\n *\n * To generate a single Secp256k1 private key, use {@link generatePrivateKey}.\n */\nexport const generateRandomSeed = () => generateRandomBytes(32 /* KeyUtilConstants.privateKeyLength */);\n/**\n * Securely generate a valid Secp256k1 private key.\n *\n * By default, this function uses `crypto.getRandomValues` to produce\n * sufficiently-random key material, but another source of randomness may also\n * be provided.\n *\n * To generate an HD Key, use {@link generateHdPrivateKey}.\n *\n * @param secureRandom - a method that returns a securely-random 32-byte\n * Uint8Array\n */\nexport const generatePrivateKey = (secureRandom = generateRandomSeed) => {\n    // eslint-disable-next-line functional/no-let, @typescript-eslint/init-declarations\n    let maybeKey;\n    // eslint-disable-next-line functional/no-loop-statements\n    do {\n        // eslint-disable-next-line functional/no-expression-statements\n        maybeKey = secureRandom();\n    } while (!validateSecp256k1PrivateKey(maybeKey));\n    return maybeKey;\n};\n/**\n * Securely generate a valid {@link HdPrivateNode}, returning both the source\n * seed and the {@link HdPrivateNodeValid}.\n *\n * By default, this function uses `crypto.getRandomValues` to produce\n * sufficiently-random key material, but another source of randomness may also\n * be provided.\n *\n * To generate a single Secp256k1 private key, use {@link generatePrivateKey}.\n */\nexport const generateHdPrivateNode = (secureRandom = generateRandomSeed) => {\n    // eslint-disable-next-line functional/no-let, @typescript-eslint/init-declarations\n    let seed;\n    // eslint-disable-next-line functional/no-let, @typescript-eslint/init-declarations\n    let hdPrivateNode;\n    // eslint-disable-next-line functional/no-loop-statements\n    do {\n        // eslint-disable-next-line functional/no-expression-statements\n        seed = secureRandom();\n        // eslint-disable-next-line functional/no-expression-statements\n        hdPrivateNode = deriveHdPrivateNodeFromSeed(seed);\n    } while ('invalidMaterial' in hdPrivateNode);\n    return {\n        hdPrivateNode,\n        seed,\n    };\n};\n/*\n * TODO: export const generateLibauthSecretKey = (secureRandom = generateRandomSeed) => {\n *   const { seed } = generateHdPrivateNode(secureRandom);\n *   return encodeLibauthSecretKey({ seed });\n * };\n */\n/**\n * Given the number of equally-likely results per event, return the Shannon\n * entropy of the event in bits.\n *\n * @param possibleResults - the number of equally-likely results per event;\n * e.g. for a coin, `2`, for dice, the number of faces (for a standard die, `6`)\n */\nexport const shannonEntropyPerEvent = (possibleResults) => Math.log2(possibleResults);\n/**\n * Given the number of equally-likely results per event, return the number of\n * events required to achieve the required bits of Shannon entropy.\n * entropy of the event in bits.\n *\n * For example, to compute the number of standard, 6-sided dice rolls required\n * to generate a private key (with the recommended 128-bit entropy minimum),\n * `minimumEventsPerEntropyBits(6)`.\n *\n * @param possibleResults - the number of equally-likely results per event;\n * e.g. for a coin, `2`, for dice, the number of faces (for a standard die, `6`)\n * @param requiredEntropyBits - the number of bits of entropy required. Defaults\n * to `128`, the recommended value for all private key generation.\n */\nexport const minimumEventsPerEntropyBits = (possibleResults, requiredEntropyBits = 128 /* KeyUtilConstants.privateKeyRequiredEntropyBits */) => Math.ceil(requiredEntropyBits / shannonEntropyPerEvent(possibleResults));\n/**\n * Generate deterministic entropy by seeding SHA-256 with a list of random\n * events like coin flips or dice rolls. For coin flips, use `0` (\"heads\") and\n * `1` (\"tails\"); for dice, use the visible number.\n *\n * **Warning: this function's validation assumes that the provided events\n * are truly random (\"unbiased\").** If the events are biased, e.g. by a weighted\n * dice or a human attempting to type random numbers, the entropy of this\n * function's result will be degraded. Using insufficiently random results will\n * compromise the security of systems relying on the result, making it possible\n * for an attacker to, e.g. guess secret keys and steal funds.\n *\n * This method of entropy generation is designed to be easily auditable: the\n * list of results are simply concatenated (without any spaces or separating\n * characters), and the UTF8 encoding of the resulting string of digits is\n * hashed with SHA-256.\n *\n * For example, if a 20-sided dice (D20) is rolled 3 times with results 13, 4,\n * and 10, the UTF8 encoding of `13410` (`0x3133343130`) is hashed with SHA-256,\n * producing a result of\n * `6dd4f2758287be9f38e0e93c71146c76e90f83f0b8c9b49760fc0b594494607b`. This can\n * be verified in most command line environments with the command:\n * `echo -n 13410 | sha256sum`.\n *\n * Note that this function is compatible with Coldcard's deterministic key\n * generation workflow when used with six-sided dice (D6).\n *\n * @param possibleResults - the number of equally-likely results per event;\n * e.g. for a coin, `2`, for dice, the number of faces (for a standard die, `6`)\n * @param events - an array of numbers encoding the random events; for coin\n * flips, use `0` (\"heads\") and `1` (\"tails\"); for dice, use the exposed number\n * (e.g. `1` through `6` for 6-sided dice)\n * @param requiredEntropyBits - the number of bits of entropy required. Defaults\n * to `128`, the recommended value for all private key generation.\n * @param crypto - an optional object containing an implementation of sha256\n * to use\n */\nexport const generateDeterministicEntropy = (possibleResults, events, { crypto = { sha256: internalSha256 }, requiredEntropyBits = 128 /* KeyUtilConstants.privateKeyRequiredEntropyBits */, } = {}) => {\n    const minimumEventCount = minimumEventsPerEntropyBits(possibleResults, requiredEntropyBits);\n    if (possibleResults === 0 || events.length < minimumEventCount) {\n        return formatError(EntropyGenerationError.insufficientEntropy, `With ${possibleResults} possible results per event, a minimum of ${minimumEventCount} events are required to obtain sufficient entropy. Events provided: ${events.length}.`);\n    }\n    const concatenatedDigits = [...events.join('')].map((digit) => Number(digit) + 48 /* KeyUtilConstants.utf8NumbersOffset */);\n    const source = Uint8Array.from(concatenatedDigits);\n    return crypto.sha256.hash(source);\n};\n// TODO: export const generateLibauthSecretKeyFromCoinFlips = () => {}\n// TODO: export const generateLibauthSecretKeyFromDiceRolls = () => {}\n//# sourceMappingURL=key-utils.js.map","import { Base58AddressFormatVersion, decodeBase58AddressFormat, encodeBase58AddressFormat, } from '../address/address.js';\nimport { sha256 as internalSha256 } from '../crypto/crypto.js';\nexport var WalletImportFormatError;\n(function (WalletImportFormatError) {\n    WalletImportFormatError[\"incorrectLength\"] = \"The WIF private key payload is not the correct length.\";\n})(WalletImportFormatError || (WalletImportFormatError = {}));\n/**\n * Encode a private key using Wallet Import Format (WIF).\n *\n * WIF encodes the 32-byte private key, a 4-byte checksum, and a `type`\n * indicating the intended usage for the private key. See\n * {@link WalletImportFormatType} for details.\n *\n * @remarks\n * WIF-encoding uses the Base58Address format with version\n * {@link Base58AddressFormatVersion.wif} (`128`/`0x80`) or\n * {@link Base58AddressFormatVersion.wifTestnet} (`239`/`0xef`), respectively.\n *\n * To indicate that the private key is intended for use in a P2PKH address using\n * the compressed form of its derived public key, a `0x01` is appended to the\n * payload prior to encoding. For the uncompressed construction, the extra byte\n * is omitted.\n *\n * For the reverse, see {@link decodePrivateKeyWif}.\n *\n * @param privateKey - a 32-byte Secp256k1 ECDSA private key\n * @param type - the intended usage of the private key (e.g. `mainnet` or\n * `testnet`)\n * @param sha256 - an implementation of sha256\n */\nexport const encodePrivateKeyWif = (privateKey, type, sha256 = internalSha256) => {\n    const compressedByte = 0x01;\n    const mainnet = type === 'mainnet' || type === 'mainnetUncompressed';\n    const compressed = type === 'mainnet' || type === 'testnet';\n    const payload = compressed\n        ? Uint8Array.from([...privateKey, compressedByte])\n        : privateKey;\n    return encodeBase58AddressFormat(mainnet\n        ? Base58AddressFormatVersion.wif\n        : Base58AddressFormatVersion.wifTestnet, payload, sha256);\n};\n/**\n * Decode a private key using Wallet Import Format (WIF). See\n * {@link encodePrivateKeyWif} for details.\n *\n * For the reverse, use {@link encodePrivateKeyWif}.\n *\n * @param wifKey - the private key to decode (in Wallet Import Format)\n * @param sha256 - an implementation of sha256\n */\n// eslint-disable-next-line complexity\nexport const decodePrivateKeyWif = (wifKey, sha256 = internalSha256) => {\n    const compressedPayloadLength = 33;\n    const decoded = decodeBase58AddressFormat(wifKey, sha256);\n    if (typeof decoded === 'string')\n        return decoded;\n    const mainnet = decoded.version === Base58AddressFormatVersion.wif;\n    const compressed = decoded.payload.length === compressedPayloadLength;\n    const privateKey = compressed\n        ? decoded.payload.slice(0, -1)\n        : decoded.payload;\n    const type = mainnet\n        ? compressed\n            ? 'mainnet'\n            : 'mainnetUncompressed'\n        : compressed\n            ? 'testnet'\n            : 'testnetUncompressed';\n    return { privateKey, type };\n};\n//# sourceMappingURL=wallet-import-format.js.map","export default class IndexedDBProvider {\n    constructor(dbName = \"wallet\", storeName = \"wallet\") {\n        this.db = null;\n        this.dbName = dbName;\n        this.storeName = storeName;\n    }\n    async openDB() {\n        if (this.db)\n            return this.db;\n        return new Promise((resolve, reject) => {\n            const request = indexedDB.open(this.dbName, 31);\n            request.onupgradeneeded = (event) => {\n                const db = request.result;\n                if (!db.objectStoreNames.contains(this.storeName)) {\n                    db.createObjectStore(this.storeName, { keyPath: \"name\" });\n                }\n            };\n            request.onsuccess = () => {\n                this.db = request.result;\n                resolve(this.db);\n            };\n            request.onerror = () => reject(request.error);\n        });\n    }\n    async init() {\n        await this.openDB();\n        return this;\n    }\n    async close() {\n        if (this.db) {\n            this.db.close();\n            this.db = null;\n        }\n        return this;\n    }\n    getInfo() {\n        return \"indexedDB\";\n    }\n    async addWallet(name, walletId) {\n        const db = await this.openDB();\n        return new Promise((resolve, reject) => {\n            const tx = db.transaction(this.storeName, \"readwrite\");\n            const store = tx.objectStore(this.storeName);\n            const getReq = store.get(name);\n            getReq.onsuccess = () => {\n                if (getReq.result) {\n                    resolve(false);\n                }\n                else {\n                    const addReq = store.add({ name, wallet: walletId });\n                    addReq.onsuccess = () => resolve(true);\n                    addReq.onerror = () => reject(addReq.error);\n                }\n            };\n            getReq.onerror = () => reject(getReq.error);\n        });\n    }\n    async getWallet(name) {\n        const db = await this.openDB();\n        return new Promise((resolve, reject) => {\n            const tx = db.transaction(this.storeName, \"readonly\");\n            const store = tx.objectStore(this.storeName);\n            const req = store.get(name);\n            req.onsuccess = () => resolve(req.result);\n            req.onerror = () => reject(req.error);\n        });\n    }\n    async getWallets() {\n        const db = await this.openDB();\n        return new Promise((resolve, reject) => {\n            const tx = db.transaction(this.storeName, \"readonly\");\n            const store = tx.objectStore(this.storeName);\n            const req = store.getAll();\n            req.onsuccess = () => resolve(req.result || []);\n            req.onerror = () => reject(req.error);\n        });\n    }\n    async updateWallet(name, walletId) {\n        const db = await this.openDB();\n        return new Promise((resolve, reject) => {\n            const tx = db.transaction(this.storeName, \"readwrite\");\n            const store = tx.objectStore(this.storeName);\n            const getReq = store.get(name);\n            getReq.onsuccess = () => {\n                if (!getReq.result) {\n                    resolve();\n                }\n                else {\n                    const putReq = store.put({ name, wallet: walletId });\n                    putReq.onsuccess = () => resolve();\n                    putReq.onerror = () => reject(putReq.error);\n                }\n            };\n            getReq.onerror = () => reject(getReq.error);\n        });\n    }\n    async walletExists(name) {\n        return (await this.getWallet(name)) !== undefined;\n    }\n}\n//# sourceMappingURL=IndexedDBProvider.js.map","export var RuntimePlatform;\n(function (RuntimePlatform) {\n    RuntimePlatform[\"node\"] = \"node\";\n    RuntimePlatform[\"browser\"] = \"browser\";\n    RuntimePlatform[\"webworker\"] = \"webworker\";\n})(RuntimePlatform || (RuntimePlatform = {}));\nexport function getRuntimePlatform() {\n    // https://github.com/foo123/asynchronous.js/blob/master/asynchronous.js\n    if (\"undefined\" !== typeof global &&\n        (\"[object global]\" === toString.call(global) ||\n            \"[object Object]\" === toString.call(global))) {\n        return RuntimePlatform.node;\n    }\n    else {\n        if (\"undefined\" !== typeof WorkerGlobalScope &&\n            \"function\" === typeof importScripts &&\n            navigator instanceof WorkerNavigator) {\n            return RuntimePlatform.webworker;\n        }\n        else if (\"undefined\" !== typeof navigator &&\n            \"undefined\" !== typeof document) {\n            return RuntimePlatform.browser;\n        }\n        else {\n            throw Error(\"Could not determine runtime platform\");\n        }\n    }\n}\n//# sourceMappingURL=getRuntimePlatform.js.map","export default {}","// Weird setup to allow both Enum parameters, as well as literal strings\n// https://stackoverflow.com/questions/51433319/typescript-constructor-accept-string-for-enum\nconst literal = (l) => l;\nexport const Network = {\n    MAINNET: literal(\"mainnet\"),\n    TESTNET: literal(\"testnet\"),\n    REGTEST: literal(\"regtest\"),\n};\nexport const NFTCapability = {\n    none: literal(\"none\"),\n    mutable: literal(\"mutable\"),\n    minting: literal(\"minting\"),\n};\n//# sourceMappingURL=interface.js.map","import $dvphU$electrumcashdebuglogs from \"@electrum-cash/debug-logs\";\nimport {EventEmitter as $dvphU$EventEmitter} from \"eventemitter3\";\nimport {Mutex as $dvphU$Mutex} from \"async-mutex\";\nimport {ElectrumWebSocket as $dvphU$ElectrumWebSocket} from \"@electrum-cash/web-socket\";\nimport {parse as $dvphU$parse, parseNumberAndBigInt as $dvphU$parseNumberAndBigInt} from \"lossless-json\";\n\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n\n\nclass $24139611f53a54b8$export$5d955335434540c6 {\n    /**\n\t * Helper function that builds an Electrum request object.\n\t *\n\t * @param method     - method to call.\n\t * @param parameters - method parameters for the call.\n\t * @param requestId  - unique string or number referencing this request.\n\t *\n\t * @returns a properly formatted Electrum request string.\n\t */ static buildRequestObject(method, parameters, requestId) {\n        // Return the formatted request object.\n        // NOTE: Electrum either uses JsonRPC strictly or loosely.\n        //       If we specify protocol identifier without being 100% compliant, we risk being disconnected/blacklisted.\n        //       For this reason, we omit the protocol identifier to avoid issues.\n        return JSON.stringify({\n            method: method,\n            params: parameters,\n            id: requestId\n        });\n    }\n    /**\n\t * Constant used to verify if a provided string is a valid version number.\n\t *\n\t * @returns a regular expression that matches valid version numbers.\n\t */ static get versionRegexp() {\n        return /^\\d+(\\.\\d+)+$/;\n    }\n    /**\n\t * Constant used to separate statements/messages in a stream of data.\n\t *\n\t * @returns the delimiter used by Electrum to separate statements.\n\t */ static get statementDelimiter() {\n        return \"\\n\";\n    }\n}\n\n\nvar $e83d2e7688025acd$exports = {};\n\n$parcel$export($e83d2e7688025acd$exports, \"isVersionRejected\", () => $e83d2e7688025acd$export$e1f38ab2b4ebdde6);\n$parcel$export($e83d2e7688025acd$exports, \"isVersionNegotiated\", () => $e83d2e7688025acd$export$9598f0c76aa41d73);\nconst $e83d2e7688025acd$export$e1f38ab2b4ebdde6 = function(object) {\n    return \"error\" in object;\n};\nconst $e83d2e7688025acd$export$9598f0c76aa41d73 = function(object) {\n    return \"software\" in object && \"protocol\" in object;\n};\n\n\n// Acceptable parameter types for RPC messages\nconst $abcb763a48577a1e$export$d73a2e87a509880 = function(message) {\n    return \"id\" in message && \"error\" in message;\n};\nconst $abcb763a48577a1e$export$81276773828ff315 = function(message) {\n    return \"id\" in message && \"result\" in message;\n};\nconst $abcb763a48577a1e$export$280de919a0cf6928 = function(message) {\n    return !(\"id\" in message) && \"method\" in message;\n};\nconst $abcb763a48577a1e$export$94e3360fcddccc76 = function(message) {\n    return \"id\" in message && \"method\" in message;\n};\n\n\n\nvar $db7c797e63383364$exports = {};\n\n$parcel$export($db7c797e63383364$exports, \"ConnectionStatus\", () => $db7c797e63383364$export$7516420eb880ab68);\n// Disable indent rule for this file because it is broken (https://github.com/typescript-eslint/typescript-eslint/issues/1824)\n/* eslint-disable @typescript-eslint/indent */ /**\n * Enum that denotes the connection status of an ElectrumConnection.\n * @enum {number}\n * @property {0} DISCONNECTED    The connection is disconnected.\n * @property {1} AVAILABLE       The connection is connected.\n * @property {2} DISCONNECTING   The connection is disconnecting.\n * @property {3} CONNECTING      The connection is connecting.\n * @property {4} RECONNECTING    The connection is restarting.\n */ var $db7c797e63383364$export$7516420eb880ab68;\n(function(ConnectionStatus) {\n    ConnectionStatus[ConnectionStatus[\"DISCONNECTED\"] = 0] = \"DISCONNECTED\";\n    ConnectionStatus[ConnectionStatus[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    ConnectionStatus[ConnectionStatus[\"DISCONNECTING\"] = 2] = \"DISCONNECTING\";\n    ConnectionStatus[ConnectionStatus[\"CONNECTING\"] = 3] = \"CONNECTING\";\n    ConnectionStatus[ConnectionStatus[\"RECONNECTING\"] = 4] = \"RECONNECTING\";\n})($db7c797e63383364$export$7516420eb880ab68 || ($db7c797e63383364$export$7516420eb880ab68 = {}));\n\n\n\nclass $ff134c9a9e1f7361$export$de0f57fc22079b5e extends (0, $dvphU$EventEmitter) {\n    /**\n\t * Sets up network configuration for an Electrum client connection.\n\t *\n\t * @param application       - your application name, used to identify to the electrum host.\n\t * @param version           - protocol version to use with the host.\n\t * @param socketOrHostname  - pre-configured electrum socket or fully qualified domain name or IP number of the host\n\t * @param options           - ...\n\t *\n\t * @throws {Error} if `version` is not a valid version string.\n\t */ constructor(application, version, socketOrHostname, options){\n        // Initialize the event emitter.\n        super();\n        this.application = application;\n        this.version = version;\n        this.socketOrHostname = socketOrHostname;\n        this.options = options;\n        this.status = (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED;\n        this.verifications = [];\n        this.messageBuffer = \"\";\n        // Check if the provided version is a valid version number.\n        if (!(0, $24139611f53a54b8$export$5d955335434540c6).versionRegexp.test(version)) // Throw an error since the version number was not valid.\n        throw new Error(`Provided version string (${version}) is not a valid protocol version number.`);\n        // If a hostname was provided..\n        if (typeof socketOrHostname === \"string\") // Use a web socket with default parameters.\n        this.socket = new (0, $dvphU$ElectrumWebSocket)(socketOrHostname);\n        else // Use the provided socket.\n        this.socket = socketOrHostname;\n        // Set up handlers for connection and disconnection.\n        this.socket.on(\"connected\", this.onSocketConnect.bind(this));\n        this.socket.on(\"disconnected\", this.onSocketDisconnect.bind(this));\n        // Set up handler for incoming data.\n        this.socket.on(\"data\", this.parseMessageChunk.bind(this));\n        // Handle visibility changes when run in a browser environment (if not explicitly disabled).\n        if (typeof document !== \"undefined\" && !this.options.disableBrowserVisibilityHandling) document.addEventListener(\"visibilitychange\", this.handleVisibilityChange.bind(this));\n        // Handle network connection changes when run in a browser environment (if not explicitly disabled).\n        if (typeof window !== \"undefined\" && !this.options.disableBrowserConnectivityHandling) {\n            window.addEventListener(\"online\", this.handleNetworkChange.bind(this));\n            window.addEventListener(\"offline\", this.handleNetworkChange.bind(this));\n        }\n    }\n    // Expose hostIdentifier from the socket.\n    get hostIdentifier() {\n        return this.socket.hostIdentifier;\n    }\n    // Expose port from the socket.\n    get encrypted() {\n        return this.socket.encrypted;\n    }\n    /**\n\t * Assembles incoming data into statements and hands them off to the message parser.\n\t *\n\t * @param data - data to append to the current message buffer, as a string.\n\t *\n\t * @throws {SyntaxError} if the passed statement parts are not valid JSON.\n\t */ parseMessageChunk(data) {\n        // Update the timestamp for when we last received data.\n        this.lastReceivedTimestamp = Date.now();\n        // Emit a notification indicating that the connection has received data.\n        this.emit(\"received\");\n        // Clear and remove all verification timers.\n        this.verifications.forEach((timer)=>clearTimeout(timer));\n        this.verifications.length = 0;\n        // Add the message to the current message buffer.\n        this.messageBuffer += data;\n        // Check if the new message buffer contains the statement delimiter.\n        while(this.messageBuffer.includes((0, $24139611f53a54b8$export$5d955335434540c6).statementDelimiter)){\n            // Split message buffer into statements.\n            const statementParts = this.messageBuffer.split((0, $24139611f53a54b8$export$5d955335434540c6).statementDelimiter);\n            // For as long as we still have statements to parse..\n            while(statementParts.length > 1){\n                // Move the first statement to its own variable.\n                const currentStatementList = String(statementParts.shift());\n                // Parse the statement into an object or list of objects.\n                let statementList = (0, $dvphU$parse)(currentStatementList, null, this.options.useBigInt ? (0, $dvphU$parseNumberAndBigInt) : parseFloat);\n                // Wrap the statement in an array if it is not already a batched statement list.\n                if (!Array.isArray(statementList)) statementList = [\n                    statementList\n                ];\n                // For as long as there is statements in the result set..\n                while(statementList.length > 0){\n                    // Move the first statement from the batch to its own variable.\n                    const currentStatement = statementList.shift();\n                    // If the current statement is a subscription notification..\n                    if ((0, $abcb763a48577a1e$export$280de919a0cf6928)(currentStatement)) {\n                        // Emit the notification for handling higher up in the stack.\n                        this.emit(\"response\", currentStatement);\n                        continue;\n                    }\n                    // If the current statement is a version negotiation response..\n                    if (currentStatement.id === \"versionNegotiation\") {\n                        if ((0, $abcb763a48577a1e$export$d73a2e87a509880)(currentStatement)) // Then emit a failed version negotiation response signal.\n                        this.emit(\"version\", {\n                            error: currentStatement.error\n                        });\n                        else {\n                            // Extract the software and protocol version reported.\n                            const [software, protocol] = currentStatement.result;\n                            // Emit a successful version negotiation response signal.\n                            this.emit(\"version\", {\n                                software: software,\n                                protocol: protocol\n                            });\n                        }\n                        continue;\n                    }\n                    // If the current statement is a keep-alive response..\n                    if (currentStatement.id === \"keepAlive\") continue;\n                    // Emit the statements for handling higher up in the stack.\n                    this.emit(\"response\", currentStatement);\n                }\n            }\n            // Store the remaining statement as the current message buffer.\n            this.messageBuffer = statementParts.shift() || \"\";\n        }\n    }\n    /**\n\t * Sends a keep-alive message to the host.\n\t *\n\t * @returns true if the ping message was fully flushed to the socket, false if\n\t * part of the message is queued in the user memory\n\t */ ping() {\n        // Write a log message.\n        (0, $dvphU$electrumcashdebuglogs).ping(`Sending keep-alive ping to '${this.hostIdentifier}'`);\n        // Craft a keep-alive message.\n        const message = (0, $24139611f53a54b8$export$5d955335434540c6).buildRequestObject(\"server.ping\", [], \"keepAlive\");\n        // Send the keep-alive message.\n        const status = this.send(message);\n        // Return the ping status.\n        return status;\n    }\n    /**\n\t * Initiates the network connection negotiates a protocol version. Also emits the 'connect' signal if successful.\n\t *\n\t * @throws {Error} if the socket connection fails.\n\t * @returns a promise resolving when the connection is established\n\t */ async connect() {\n        // If we are already connected return true.\n        if (this.status === (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED) return;\n        // Indicate that the connection is connecting\n        this.status = (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTING;\n        // Emit a connect event now that the connection is being set up.\n        this.emit(\"connecting\");\n        // Define a function to wrap connection as a promise.\n        const connectionResolver = (resolve, reject)=>{\n            const rejector = (error)=>{\n                // Set the status back to disconnected\n                this.status = (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED;\n                // Emit a connect event indicating that we failed to connect.\n                this.emit(\"disconnected\");\n                // Reject with the error as reason\n                reject(error);\n            };\n            // Replace previous error handlers to reject the promise on failure.\n            this.socket.removeAllListeners(\"error\");\n            this.socket.once(\"error\", rejector);\n            // Define a function to wrap version negotiation as a callback.\n            const versionNegotiator = ()=>{\n                // Write a log message to show that we have started version negotiation.\n                (0, $dvphU$electrumcashdebuglogs).network(`Requesting protocol version ${this.version} with '${this.hostIdentifier}'.`);\n                // remove the one-time error handler since no error was detected.\n                this.socket.removeListener(\"error\", rejector);\n                // Build a version negotiation message.\n                const versionMessage = (0, $24139611f53a54b8$export$5d955335434540c6).buildRequestObject(\"server.version\", [\n                    this.application,\n                    this.version\n                ], \"versionNegotiation\");\n                // Define a function to wrap version validation as a function.\n                const versionValidator = (version)=>{\n                    // Check if version negotiation failed.\n                    if ((0, $e83d2e7688025acd$export$e1f38ab2b4ebdde6)(version)) {\n                        // Disconnect from the host.\n                        this.disconnect(true);\n                        // Declare an error message.\n                        const errorMessage = \"unsupported protocol version.\";\n                        // Log the error.\n                        (0, $dvphU$electrumcashdebuglogs).errors(`Failed to connect with ${this.hostIdentifier} due to ${errorMessage}`);\n                        // Reject the connection with false since version negotiation failed.\n                        reject(errorMessage);\n                    } else if (version.protocol !== this.version && `${version.protocol}.0` !== this.version && `${version.protocol}.0.0` !== this.version) {\n                        // Disconnect from the host.\n                        this.disconnect(true);\n                        // Declare an error message.\n                        const errorMessage = `incompatible protocol version negotiated (${version.protocol} !== ${this.version}).`;\n                        // Log the error.\n                        (0, $dvphU$electrumcashdebuglogs).errors(`Failed to connect with ${this.hostIdentifier} due to ${errorMessage}`);\n                        // Reject the connection with false since version negotiation failed.\n                        reject(errorMessage);\n                    } else {\n                        // Write a log message.\n                        (0, $dvphU$electrumcashdebuglogs).network(`Negotiated protocol version ${version.protocol} with '${this.hostIdentifier}', powered by ${version.software}.`);\n                        // Set connection status to connected\n                        this.status = (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED;\n                        // Emit a connect event now that the connection is usable.\n                        this.emit(\"connected\");\n                        // Resolve the connection promise since we successfully connected and negotiated protocol version.\n                        resolve();\n                    }\n                };\n                // Listen for version negotiation once.\n                this.once(\"version\", versionValidator);\n                // Send the version negotiation message.\n                this.send(versionMessage);\n            };\n            // Prepare the version negotiation.\n            this.socket.once(\"connected\", versionNegotiator);\n            // Set up handler for network errors.\n            this.socket.on(\"error\", this.onSocketError.bind(this));\n            // Connect to the server.\n            this.socket.connect();\n        };\n        // Wait until connection is established and version negotiation succeeds.\n        await new Promise(connectionResolver);\n    }\n    /**\n\t * Restores the network connection.\n\t */ async reconnect() {\n        // If a reconnect timer is set, remove it\n        await this.clearReconnectTimer();\n        // Write a log message.\n        (0, $dvphU$electrumcashdebuglogs).network(`Trying to reconnect to '${this.hostIdentifier}'..`);\n        // Set the status to reconnecting for more accurate log messages.\n        this.status = (0, $db7c797e63383364$export$7516420eb880ab68).RECONNECTING;\n        // Emit a connect event now that the connection is usable.\n        this.emit(\"reconnecting\");\n        // Disconnect the underlying socket.\n        this.socket.disconnect();\n        try {\n            // Try to connect again.\n            await this.connect();\n        } catch (error) {\n        // Do nothing as the error should be handled via the disconnect and error signals.\n        }\n    }\n    /**\n\t * Removes the current reconnect timer.\n\t */ clearReconnectTimer() {\n        // If a reconnect timer is set, remove it\n        if (this.reconnectTimer) clearTimeout(this.reconnectTimer);\n        // Reset the timer reference.\n        this.reconnectTimer = undefined;\n    }\n    /**\n\t * Removes the current keep-alive timer.\n\t */ clearKeepAliveTimer() {\n        // If a keep-alive timer is set, remove it\n        if (this.keepAliveTimer) clearTimeout(this.keepAliveTimer);\n        // Reset the timer reference.\n        this.keepAliveTimer = undefined;\n    }\n    /**\n\t * Initializes the keep alive timer loop.\n\t */ setupKeepAliveTimer() {\n        // If the keep-alive timer loop is not currently set up..\n        if (!this.keepAliveTimer) // Set a new keep-alive timer.\n        this.keepAliveTimer = setTimeout(this.ping.bind(this), this.options.sendKeepAliveIntervalInMilliSeconds);\n    }\n    /**\n\t * Tears down the current connection and removes all event listeners on disconnect.\n\t *\n\t * @param force       - disconnect even if the connection has not been fully established yet.\n\t * @param intentional - update connection state if disconnect is intentional.\n\t *\n\t * @returns true if successfully disconnected, or false if there was no connection.\n\t */ async disconnect(force = false, intentional = true) {\n        // Return early when there is nothing to disconnect from\n        if (this.status === (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED && !force) // Return false to indicate that there was nothing to disconnect from.\n        return false;\n        // Update connection state if the disconnection is intentional.\n        // NOTE: The state is meant to represent what the client is requesting, but\n        //       is used internally to handle visibility changes in browsers to ensure functional reconnection.\n        if (intentional) // Set connection status to null to indicate tear-down is currently happening.\n        this.status = (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTING;\n        // Emit a connect event to indicate that we are disconnecting.\n        this.emit(\"disconnecting\");\n        // If a keep-alive timer is set, remove it.\n        await this.clearKeepAliveTimer();\n        // If a reconnect timer is set, remove it\n        await this.clearReconnectTimer();\n        const disconnectResolver = (resolve)=>{\n            // Resolve to true after the connection emits a disconnect\n            this.once(\"disconnected\", ()=>resolve(true));\n            // Close the connection on the socket level.\n            this.socket.disconnect();\n        };\n        // Return true to indicate that we disconnected.\n        return new Promise(disconnectResolver);\n    }\n    /**\n\t * Updates the connection state based on browser reported connectivity.\n\t *\n\t * Most modern browsers are able to provide information on the connection state\n\t * which allows for significantly faster response times to network changes compared\n\t * to waiting for network requests to fail.\n\t *\n\t * When available, we make use of this to fail early to provide a better user experience.\n\t */ async handleNetworkChange() {\n        // Do nothing if we do not have the navigator available.\n        if (typeof window.navigator === \"undefined\") return;\n        // Attempt to reconnect to the network now that we may be online again.\n        if (window.navigator.onLine === true) this.reconnect();\n        // Disconnected from the network so that cleanup can happen while we're offline.\n        if (window.navigator.onLine !== true) {\n            const forceDisconnect = true;\n            const isIntentional = true;\n            this.disconnect(forceDisconnect, isIntentional);\n        }\n    }\n    /**\n\t * Updates connection state based on application visibility.\n\t *\n\t * Some browsers will disconnect network connections when the browser is out of focus,\n\t * which would normally cause our reconnect-on-timeout routines to trigger, but that\n\t * results in a poor user experience since the events are not handled consistently\n\t * and sometimes it can take some time after restoring focus to the browser.\n\t *\n\t * By manually disconnecting when this happens we prevent the default reconnection routines\n\t * and make the behavior consistent across browsers.\n\t */ async handleVisibilityChange() {\n        // Disconnect when application is removed from focus.\n        if (document.visibilityState === \"hidden\") {\n            const forceDisconnect = true;\n            const isIntentional = true;\n            this.disconnect(forceDisconnect, isIntentional);\n        }\n        // Reconnect when application is returned to focus.\n        if (document.visibilityState === \"visible\") this.reconnect();\n    }\n    /**\n\t * Sends an arbitrary message to the server.\n\t *\n\t * @param message - json encoded request object to send to the server, as a string.\n\t *\n\t * @returns true if the message was fully flushed to the socket, false if part of the message\n\t * is queued in the user memory\n\t */ send(message) {\n        // Remove the current keep-alive timer if it exists.\n        this.clearKeepAliveTimer();\n        // Get the current timestamp in milliseconds.\n        const currentTime = Date.now();\n        // Follow up and verify that the message got sent..\n        const verificationTimer = setTimeout(this.verifySend.bind(this, currentTime), this.socket.timeout);\n        // Store the verification timer locally so that it can be cleared when data has been received.\n        this.verifications.push(verificationTimer);\n        // Set a new keep-alive timer.\n        this.setupKeepAliveTimer();\n        // Write the message to the network socket.\n        return this.socket.write(message + (0, $24139611f53a54b8$export$5d955335434540c6).statementDelimiter);\n    }\n    // --- Event managers. --- //\n    /**\n\t * Marks the connection as timed out and schedules reconnection if we have not\n\t * received data within the expected time frame.\n\t */ verifySend(sentTimestamp) {\n        // If we haven't received any data since we last sent data out..\n        if (Number(this.lastReceivedTimestamp) < sentTimestamp) {\n            // If this connection is already disconnected, we do not change anything\n            if (this.status === (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED || this.status === (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTING) // debug.warning(`Tried to verify already disconnected connection to '${this.hostIdentifier}'`);\n            return;\n            // Remove the current keep-alive timer if it exists.\n            this.clearKeepAliveTimer();\n            // Write a notification to the logs.\n            (0, $dvphU$electrumcashdebuglogs).network(`Connection to '${this.hostIdentifier}' timed out.`);\n            // Close the connection to avoid re-use.\n            // NOTE: This initiates reconnection routines if the connection has not\n            //       been marked as intentionally disconnected.\n            this.socket.disconnect();\n        }\n    }\n    /**\n\t * Updates the connection status when a connection is confirmed.\n\t */ onSocketConnect() {\n        // If a reconnect timer is set, remove it.\n        this.clearReconnectTimer();\n        // Set up the initial timestamp for when we last received data from the server.\n        this.lastReceivedTimestamp = Date.now();\n        // Set up the initial keep-alive timer.\n        this.setupKeepAliveTimer();\n        // Clear all temporary error listeners.\n        this.socket.removeAllListeners(\"error\");\n        // Set up handler for network errors.\n        this.socket.on(\"error\", this.onSocketError.bind(this));\n    }\n    /**\n\t * Updates the connection status when a connection is ended.\n\t */ onSocketDisconnect() {\n        // Remove the current keep-alive timer if it exists.\n        this.clearKeepAliveTimer();\n        // If this is a connection we're trying to tear down..\n        if (this.status === (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTING) {\n            // Mark the connection as disconnected.\n            this.status = (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED;\n            // Send a disconnect signal higher up the stack.\n            this.emit(\"disconnected\");\n            // If a reconnect timer is set, remove it.\n            this.clearReconnectTimer();\n            // Remove all event listeners\n            this.removeAllListeners();\n            // Write a log message.\n            (0, $dvphU$electrumcashdebuglogs).network(`Disconnected from '${this.hostIdentifier}'.`);\n        } else {\n            // If this is for an established connection..\n            if (this.status === (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED) // Write a notification to the logs.\n            (0, $dvphU$electrumcashdebuglogs).errors(`Connection with '${this.hostIdentifier}' was closed, trying to reconnect in ${this.options.reconnectAfterMilliSeconds / 1000} seconds.`);\n            // Mark the connection as disconnected for now..\n            this.status = (0, $db7c797e63383364$export$7516420eb880ab68).DISCONNECTED;\n            // Send a disconnect signal higher up the stack.\n            this.emit(\"disconnected\");\n            // If we don't have a pending reconnection timer..\n            if (!this.reconnectTimer) // Attempt to reconnect after one keep-alive duration.\n            this.reconnectTimer = setTimeout(this.reconnect.bind(this), this.options.reconnectAfterMilliSeconds);\n        }\n    }\n    /**\n\t * Notify administrator of any unexpected errors.\n\t */ onSocketError(error) {\n        // Report a generic error if no error information is present.\n        // NOTE: When using WSS, the error event explicitly\n        //       only allows to send a \"simple\" event without data.\n        //       https://stackoverflow.com/a/18804298\n        if (typeof error === \"undefined\") // Do nothing, and instead rely on the socket disconnect event for further information.\n        return;\n        // Log the error, as there is nothing we can do to actually handle it.\n        (0, $dvphU$electrumcashdebuglogs).errors(`Network error ('${this.hostIdentifier}'): `, error);\n    }\n}\n\n\n\n// Define number of milliseconds per second for legibility.\nconst $d801b1f9b7fc3074$var$MILLI_SECONDS_PER_SECOND = 1000;\nconst $d801b1f9b7fc3074$export$5ba3a4134d0d751d = {\n    // By default, all numbers including integers are parsed as regular JavaScript numbers.\n    useBigInt: false,\n    // Send a ping message every seconds, to detect network problem as early as possible.\n    sendKeepAliveIntervalInMilliSeconds: 1 * $d801b1f9b7fc3074$var$MILLI_SECONDS_PER_SECOND,\n    // Try to reconnect 5 seconds after unintentional disconnects.\n    reconnectAfterMilliSeconds: 5 * $d801b1f9b7fc3074$var$MILLI_SECONDS_PER_SECOND,\n    // Try to detect stale connections 5 seconds after every send.\n    verifyConnectionTimeoutInMilliSeconds: 5 * $d801b1f9b7fc3074$var$MILLI_SECONDS_PER_SECOND,\n    // Automatically manage the connection for a consistent behavior across browsers and devices.\n    disableBrowserVisibilityHandling: false,\n    disableBrowserConnectivityHandling: false\n};\n\n\n\n\n\n\n/**\n * High-level Electrum client that lets applications send requests and subscribe to notification events from a server.\n */ class $558b46d3f899ced5$var$ElectrumClient extends (0, $dvphU$EventEmitter) {\n    /**\n\t * Number corresponding to the underlying connection status.\n\t */ get status() {\n        return this.connection.status;\n    }\n    /**\n\t * Initializes an Electrum client.\n\t *\n\t * @param application       - your application name, used to identify to the electrum host.\n\t * @param version           - protocol version to use with the host.\n\t * @param socketOrHostname  - pre-configured electrum socket or fully qualified domain name or IP number of the host\n\t * @param options           - ...\n\t *\n\t * @throws {Error} if `version` is not a valid version string.\n\t */ constructor(application, version, socketOrHostname, options = {}){\n        // Initialize the event emitter.\n        super();\n        this.application = application;\n        this.version = version;\n        this.socketOrHostname = socketOrHostname;\n        this.options = options;\n        this.subscriptionMethods = {};\n        this.requestId = 0;\n        this.requestResolvers = {};\n        this.connectionLock = new (0, $dvphU$Mutex)();\n        // Update default options with the provided values.\n        const networkOptions = {\n            ...(0, $d801b1f9b7fc3074$export$5ba3a4134d0d751d),\n            ...options\n        };\n        // Set up a connection to an electrum server.\n        this.connection = new (0, $ff134c9a9e1f7361$export$de0f57fc22079b5e)(application, version, socketOrHostname, networkOptions);\n    }\n    // Expose hostIdentifier from the connection.\n    get hostIdentifier() {\n        return this.connection.hostIdentifier;\n    }\n    // Expose port from the connection.\n    get encrypted() {\n        return this.connection.encrypted;\n    }\n    /**\n\t * Connects to the remote server.\n\t *\n\t * @throws {Error} if the socket connection fails.\n\t * @returns a promise resolving when the connection is established.\n\t */ async connect() {\n        // Create a lock so that multiple connects/disconnects cannot race each other.\n        const unlock = await this.connectionLock.acquire();\n        try {\n            // If we are already connected, do not attempt to connect again.\n            if (this.connection.status === (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED) return;\n            // Listen for parsed statements.\n            this.connection.on(\"response\", this.response.bind(this));\n            // Hook up handles for the connected and disconnected events.\n            this.connection.on(\"connected\", this.resubscribeOnConnect.bind(this));\n            this.connection.on(\"disconnected\", this.onConnectionDisconnect.bind(this));\n            // Relay connecting and reconnecting events.\n            this.connection.on(\"connecting\", this.handleConnectionStatusChanges.bind(this, \"connecting\"));\n            this.connection.on(\"disconnecting\", this.handleConnectionStatusChanges.bind(this, \"disconnecting\"));\n            this.connection.on(\"reconnecting\", this.handleConnectionStatusChanges.bind(this, \"reconnecting\"));\n            // Hook up client metadata gathering functions.\n            this.connection.on(\"version\", this.storeSoftwareVersion.bind(this));\n            this.connection.on(\"received\", this.updateLastReceivedTimestamp.bind(this));\n            // Relay error events.\n            this.connection.on(\"error\", this.emit.bind(this, \"error\"));\n            // Connect with the server.\n            await this.connection.connect();\n        } finally{\n            unlock();\n        }\n    }\n    /**\n\t * Disconnects from the remote server and removes all event listeners/subscriptions and open requests.\n\t *\n\t * @param force               - disconnect even if the connection has not been fully established yet.\n\t * @param retainSubscriptions - retain subscription data so they will be restored on reconnection.\n\t *\n\t * @returns true if successfully disconnected, or false if there was no connection.\n\t */ async disconnect(force = false, retainSubscriptions = false) {\n        if (!retainSubscriptions) {\n            // Cancel all event listeners.\n            this.removeAllListeners();\n            // Remove all subscription data\n            this.subscriptionMethods = {};\n        }\n        // Disconnect from the remote server.\n        return this.connection.disconnect(force);\n    }\n    /**\n\t * Calls a method on the remote server with the supplied parameters.\n\t *\n\t * @param method     - name of the method to call.\n\t * @param parameters - one or more parameters for the method.\n\t *\n\t * @throws {Error} if the client is disconnected.\n\t * @returns a promise that resolves with the result of the method or an Error.\n\t */ async request(method, ...parameters) {\n        // If we are not connected to a server..\n        if (this.connection.status !== (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED) // Reject the request with a disconnected error message.\n        throw new Error(`Unable to send request to a disconnected server '${this.hostIdentifier}'.`);\n        // Increase the request ID by one.\n        this.requestId += 1;\n        // Store a copy of the request id.\n        const id = this.requestId;\n        // Format the arguments as an electrum request object.\n        const message = (0, $24139611f53a54b8$export$5d955335434540c6).buildRequestObject(method, parameters, id);\n        // Define a function to wrap the request in a promise.\n        const requestResolver = (resolve)=>{\n            // Add a request resolver for this promise to the list of requests.\n            this.requestResolvers[id] = (error, data)=>{\n                // If the resolution failed..\n                if (error) // Resolve the promise with the error for the application to handle.\n                resolve(error);\n                else // Resolve the promise with the request results.\n                resolve(data);\n            };\n            // Send the request message to the remote server.\n            this.connection.send(message);\n        };\n        // Write a log message.\n        (0, $dvphU$electrumcashdebuglogs).network(`Sending request '${method}' to '${this.hostIdentifier}'`);\n        // return a promise to deliver results later.\n        return new Promise(requestResolver);\n    }\n    /**\n\t * Subscribes to the method and payload at the server.\n\t *\n\t * @remarks the response for the subscription request is issued as a notification event.\n\t *\n\t * @param method     - one of the subscribable methods the server supports.\n\t * @param parameters - one or more parameters for the method.\n\t *\n\t * @throws {Error} if the client is disconnected.\n\t * @returns a promise resolving when the subscription is established.\n\t */ async subscribe(method, ...parameters) {\n        // Initialize an empty list of subscription payloads, if needed.\n        if (!this.subscriptionMethods[method]) this.subscriptionMethods[method] = new Set();\n        // Store the subscription parameters to track what data we have subscribed to.\n        this.subscriptionMethods[method].add(JSON.stringify(parameters));\n        // Send initial subscription request.\n        const requestData = await this.request(method, ...parameters);\n        // If the request failed, throw it as an error.\n        if (requestData instanceof Error) throw requestData;\n        // If the request returned more than one data point..\n        if (Array.isArray(requestData)) // .. throw an error, as this breaks our expectation for subscriptions.\n        throw new Error(\"Subscription request returned an more than one data point.\");\n        // Construct a notification structure to package the initial result as a notification.\n        const notification = {\n            jsonrpc: \"2.0\",\n            method: method,\n            params: [\n                ...parameters,\n                requestData\n            ]\n        };\n        // Manually emit an event for the initial response.\n        this.emit(\"notification\", notification);\n        // Try to update the chain height.\n        this.updateChainHeightFromHeadersNotifications(notification);\n    }\n    /**\n\t * Unsubscribes to the method at the server and removes any callback functions\n\t * when there are no more subscriptions for the method.\n\t *\n\t * @param method     - a previously subscribed to method.\n\t * @param parameters - one or more parameters for the method.\n\t *\n\t * @throws {Error} if no subscriptions exist for the combination of the provided `method` and `parameters.\n\t * @throws {Error} if the client is disconnected.\n\t * @returns a promise resolving when the subscription is removed.\n\t */ async unsubscribe(method, ...parameters) {\n        // Throw an error if the client is disconnected.\n        if (this.connection.status !== (0, $db7c797e63383364$export$7516420eb880ab68).CONNECTED) throw new Error(`Unable to send unsubscribe request to a disconnected server '${this.hostIdentifier}'.`);\n        // If this method has no subscriptions..\n        if (!this.subscriptionMethods[method]) // Reject this promise with an explanation.\n        throw new Error(`Cannot unsubscribe from '${method}' since the method has no subscriptions.`);\n        // Pack up the parameters as a long string.\n        const subscriptionParameters = JSON.stringify(parameters);\n        // If the method payload could not be located..\n        if (!this.subscriptionMethods[method].has(subscriptionParameters)) // Reject this promise with an explanation.\n        throw new Error(`Cannot unsubscribe from '${method}' since it has no subscription with the given parameters.`);\n        // Remove this specific subscription payload from internal tracking.\n        this.subscriptionMethods[method].delete(subscriptionParameters);\n        // Send unsubscription request to the server\n        // NOTE: As a convenience we allow users to define the method as the subscribe or unsubscribe version.\n        await this.request(method.replace(\".subscribe\", \".unsubscribe\"), ...parameters);\n        // Write a log message.\n        (0, $dvphU$electrumcashdebuglogs).client(`Unsubscribed from '${String(method)}' for the '${subscriptionParameters}' parameters.`);\n    }\n    /**\n\t * Restores existing subscriptions without updating status or triggering manual callbacks.\n\t *\n\t * @throws {Error} if subscription data cannot be found for all stored event names.\n\t * @throws {Error} if the client is disconnected.\n\t * @returns a promise resolving to true when the subscriptions are restored.\n\t *\n\t * @ignore\n\t */ async resubscribeOnConnect() {\n        // Write a log message.\n        (0, $dvphU$electrumcashdebuglogs).client(`Connected to '${this.hostIdentifier}'.`);\n        // Synchronize with the underlying connection status.\n        this.handleConnectionStatusChanges(\"connected\");\n        // Initialize an empty list of resubscription promises.\n        const resubscriptionPromises = [];\n        // For each method we have a subscription for..\n        for(const method in this.subscriptionMethods){\n            // .. and for each parameter we have previously been subscribed to..\n            for (const parameterJSON of this.subscriptionMethods[method].values()){\n                // restore the parameters from JSON.\n                const parameters = JSON.parse(parameterJSON);\n                // Send a subscription request.\n                resubscriptionPromises.push(this.subscribe(method, ...parameters));\n            }\n            // Wait for all re-subscriptions to complete.\n            await Promise.all(resubscriptionPromises);\n        }\n        // Write a log message if there was any subscriptions to restore.\n        if (resubscriptionPromises.length > 0) (0, $dvphU$electrumcashdebuglogs).client(`Restored ${resubscriptionPromises.length} previous subscriptions for '${this.hostIdentifier}'`);\n    }\n    /**\n\t * Parser messages from the remote server to resolve request promises and emit subscription events.\n\t *\n\t * @param message - the response message\n\t *\n\t * @throws {Error} if the message ID does not match an existing request.\n\t * @ignore\n\t */ response(message) {\n        // If the received message is a notification, we forward it to all event listeners\n        if ((0, $abcb763a48577a1e$export$280de919a0cf6928)(message)) {\n            // Write a log message.\n            (0, $dvphU$electrumcashdebuglogs).client(`Received notification for '${message.method}' from '${this.hostIdentifier}'`);\n            // Forward the message content to all event listeners.\n            this.emit(\"notification\", message);\n            // Try to update the chain height.\n            this.updateChainHeightFromHeadersNotifications(message);\n            // Return since it does not have an associated request resolver\n            return;\n        }\n        // If the response ID is null we cannot use it to index our request resolvers\n        if (message.id === null) // Throw an internal error, this should not happen.\n        throw new Error(\"Internal error: Received an RPC response with ID null.\");\n        // Look up which request promise we should resolve this.\n        const requestResolver = this.requestResolvers[message.id];\n        // If we do not have a request resolver for this response message..\n        if (!requestResolver) {\n            // Log that a message was ignored since the request has already been rejected.\n            (0, $dvphU$electrumcashdebuglogs).warning(`Ignoring response #${message.id} as the request has already been rejected.`);\n            // Return as this has now been fully handled.\n            return;\n        }\n        // Remove the promise from the request list.\n        delete this.requestResolvers[message.id];\n        // If the message contains an error..\n        if ((0, $abcb763a48577a1e$export$d73a2e87a509880)(message)) // Forward the message error to the request resolver and omit the `result` parameter.\n        requestResolver(new Error(message.error.message));\n        else {\n            // Forward the message content to the request resolver and omit the `error` parameter\n            // (by setting it to undefined).\n            requestResolver(undefined, message.result);\n            // Attempt to extract genesis hash from feature requests.\n            this.storeGenesisHashFromFeaturesResponse(message);\n        }\n    }\n    /**\n\t * Callback function that is called when connection to the Electrum server is lost.\n\t * Aborts all active requests with an error message indicating that connection was lost.\n\t *\n\t * @ignore\n\t */ async onConnectionDisconnect() {\n        // Loop over active requests\n        for(const resolverId in this.requestResolvers){\n            // Extract request resolver for readability\n            const requestResolver = this.requestResolvers[resolverId];\n            // Resolve the active request with an error indicating that the connection was lost.\n            requestResolver(new Error(\"Connection lost\"));\n            // Remove the promise from the request list.\n            delete this.requestResolvers[resolverId];\n        }\n        // Synchronize with the underlying connection status.\n        this.handleConnectionStatusChanges(\"disconnected\");\n    }\n    /**\n\t * Stores the server provider software version field on successful version negotiation.\n\t *\n\t * @ignore\n\t */ async storeSoftwareVersion(versionStatement) {\n        // TODO: handle failed version negotiation better.\n        if (versionStatement.error) // Do nothing.\n        return;\n        // Store the software version.\n        this.software = versionStatement.software;\n    }\n    /**\n\t * Updates the last received timestamp.\n\t *\n\t * @ignore\n\t */ async updateLastReceivedTimestamp() {\n        // Update the timestamp for when we last received data.\n        this.lastReceivedTimestamp = Date.now();\n    }\n    /**\n\t * Checks if the provided message is a response to a headers subscription,\n\t * and if so updates the locally stored chain height value for this client.\n\t *\n\t * @ignore\n\t */ async updateChainHeightFromHeadersNotifications(message) {\n        // If the message is a notification for a new chain height..\n        if (message.method === \"blockchain.headers.subscribe\") // ..also store the updated chain height locally.\n        this.chainHeight = message.params[0].height;\n    }\n    /**\n\t * Checks if the provided message is a response to a server.features request,\n\t * and if so stores the genesis hash for this client locally.\n\t *\n\t * @ignore\n\t */ async storeGenesisHashFromFeaturesResponse(message) {\n        try {\n            // If the message is a response to a features request..\n            if (typeof message.result.genesis_hash !== \"undefined\") // ..store the genesis hash locally.\n            this.genesisHash = message.result.genesis_hash;\n        } catch (error) {\n        // Do nothing.\n        }\n    }\n    /**\n\t * Helper function to synchronize state and events with the underlying connection.\n\t */ async handleConnectionStatusChanges(eventName) {\n        // Re-emit the event.\n        this.emit(eventName);\n    }\n}\nvar // Export the client.\n$558b46d3f899ced5$export$2e2bcd8739ae039 = $558b46d3f899ced5$var$ElectrumClient;\n\n\n\n\n\n\nexport {$558b46d3f899ced5$export$2e2bcd8739ae039 as ElectrumClient, $e83d2e7688025acd$export$e1f38ab2b4ebdde6 as isVersionRejected, $e83d2e7688025acd$export$9598f0c76aa41d73 as isVersionNegotiated, $db7c797e63383364$export$7516420eb880ab68 as ConnectionStatus};\n//# sourceMappingURL=index.mjs.map\n","export function delay(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\n//# sourceMappingURL=delay.js.map","import { hexToBin, sha256, binToHex } from \"@bitauth/libauth\";\nexport async function getTransactionHash(rawTransactionHex) {\n    const transactionBin = hexToBin(rawTransactionHex);\n    // transaction hash is a double sha256 of a raw transaction data, reversed byte order\n    return binToHex(sha256.hash(sha256.hash(transactionBin)).reverse());\n}\n//# sourceMappingURL=transaction.js.map","export const wordlist = `abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo`.split('\\n');\n","export const DELIMITER = \":\";\n// Min amount utxo can be to be accepted by the network\nexport const DUST_UTXO_THRESHOLD = 546;\n// Current chained tx limit\nexport const MEMPOOL_CHAIN_LIMIT = 50;\n// time in milliseconds to cache the usd exchange rate\nexport const EXCHANGE_RATE_TTL = 250000;\n// list of common derivation paths\n// a la: https://github.com/Electron-Cash/Electron-Cash/blob/1de24c509992cfebc22217a2a77c862c2b02bc54/electroncash_gui/qt/installwizard.py#L624\nexport const DERIVATION_PATHS = [\n    \"m/0\",\n    \"m/0'\",\n    \"m/0'/0\",\n    \"m/0'/0'\",\n    \"m/0'/0'/0'\",\n    \"m/44'/0'/0'\",\n    \"m/44'/0'/0'/0\",\n    \"m/44'/145'/0'\",\n    \"m/44'/145'/0'/0\",\n    \"m/44'/245'/0\",\n    \"m/44'/245'/0'\",\n    \"m/44'/245'/0'/0\",\n];\nexport const WORDLIST_CHECKSUMS = {\n    czech: \"92e035ca0e3680fab85fa18b9e5c7e7582b3bd9caeb6d4bc8a2ecc8e492100c9\",\n    english: \"f18b9a84c83e38e98eceb0102b275e26438af83ab08f080cdb780a2caa9f3a6d\",\n    french: \"fd4cd57c8e86a99ac53cd0f21a6b89af366769b0143ac0d268ac7d7a39200145\",\n    italian: \"d9664953fe4c49e0b40eb6f6378c421f5f01dc9360aaac6d2a3c294f046ef520\",\n    japanese: \"e641781d89213031233ebc5130020c3de297cad96065ecc688d1c00e010ea71c\",\n    korean: \"0c26059ed7ede977d7fa1c40443e71793e7850aa6a3d8aabf0cbcec91c1f95ec\",\n    portuguese: \"85fea658f90c42c182823807a1d30db587abb72c14a3098e1a65f8b78d1ffcf4\",\n    simplifiedChinese: \"a86e2bd870e228d19a887c9faae8c1374b4e624e85d2b245b59e36583cba4afc\",\n    spanish: \"27e99ad4328299108663c19eb611310bd3b77260af852169108713019831d07d\",\n    traditionalChinese: \"11ef479f2f44b6d4f7fb6239dff06e3cd7a1473b83df6cf91adcbbbee598acf6\",\n};\n//# sourceMappingURL=constant.js.map","import { wordlist as english } from \"@scure/bip39/wordlists/english\";\nimport { WORDLIST_CHECKSUMS } from \"./constant.js\";\nimport { sha256, binToHex, utf8ToBin } from \"@bitauth/libauth\";\nexport class Config {\n    // enforces all token-related methods to specify tokenaddr as recepient and change cashaddr\n    static { this.EnforceCashTokenReceiptAddresses = false; }\n    static { this.DefaultParentDerivationPath = \"m/44'/0'/0'\"; }\n    static { this.DefaultIpfsGateway = \"https://dweb.link/ipfs/\"; }\n    // default currency for balance and rate conversions\n    static { this.DefaultCurrency = \"usd\"; }\n    // caches the raw transactions in browser's local storage instead of memory\n    static { this.UseLocalStorageCache = false; }\n    // caches the raw transactions in browser's indexedDB instead of memory\n    static { this.UseIndexedDBCache = false; }\n    // caches the raw transactions in browser's memory\n    static { this.UseMemoryCache = false; }\n    static { this.DefaultWordlist = english; }\n    static setIpfsGateway(ipfsGateway) {\n        this.DefaultIpfsGateway = ipfsGateway;\n    }\n    static setWordlist(wordlist) {\n        let checksum = binToHex(sha256.hash(utf8ToBin(wordlist.join(\" \"))));\n        if (!Object.values(WORDLIST_CHECKSUMS).includes(checksum))\n            throw Error(\"Error matching provided wordlist to a known list, see @scure/bip39/wordlists\");\n        Config.DefaultWordlist = wordlist;\n    }\n    static getWordlist() {\n        return [...Config.DefaultWordlist];\n    }\n}\n//# sourceMappingURL=config.js.map","import { assertSuccess, binToHex, hexToBin, readUint32LE, } from \"@bitauth/libauth\";\nexport const decodeHeader = (hexHeader) => {\n    const result = {};\n    const header = hexToBin(hexHeader.hex);\n    result.version = assertSuccess(readUint32LE({ bin: header, index: 0 })).result;\n    result.previousBlockHash = binToHex(header.slice(4, 36).reverse());\n    result.merkleRoot = binToHex(header.slice(36, 68).reverse());\n    result.timestamp = assertSuccess(readUint32LE({ bin: header, index: 68 })).result;\n    result.bits = assertSuccess(readUint32LE({ bin: header, index: 72 })).result;\n    result.nonce = assertSuccess(readUint32LE({ bin: header, index: 76 })).result;\n    result.height = hexHeader.height;\n    return result;\n};\n//# sourceMappingURL=header.js.map","// super thin wrapper around indexedDB, compatible with localStorage API\nexport class IndexedDbCache {\n    constructor(objectStoreName = \"ElectrumNetworkProviderCache\") {\n        this.objectStoreName = objectStoreName;\n        this.db = null;\n        this.objectStoreName = objectStoreName;\n    }\n    getDatabaseObjectFromTarget(target) {\n        if (!target) {\n            return null;\n        }\n        const targetWithType = target;\n        return targetWithType.result;\n    }\n    throwDatabaseOpenError(reject, database) {\n        if (!database) {\n            reject(new Error(\"Something went wrong and the database transaction was not opened.\"));\n        }\n    }\n    async init() {\n        const db = indexedDB.open(\"ElectrumNetworkProviderCache\", 1);\n        this.db = await new Promise((resolve, reject) => {\n            const request = db;\n            request.onerror = reject;\n            request.onsuccess = ({ target }) => {\n                const database = this.getDatabaseObjectFromTarget(target);\n                this.throwDatabaseOpenError(reject, database);\n                resolve(database);\n            };\n            request.onupgradeneeded = ({ target }) => {\n                const database = this.getDatabaseObjectFromTarget(target);\n                this.throwDatabaseOpenError(reject, database);\n                database?.createObjectStore(this.objectStoreName);\n            };\n        });\n    }\n    async setItem(key, value) {\n        if (!this.db) {\n            throw new Error(\"Database is not initialized\");\n        }\n        const transaction = this.db.transaction(this.objectStoreName, \"readwrite\");\n        const objectStore = transaction.objectStore(this.objectStoreName);\n        return new Promise((resolve, reject) => {\n            const request = objectStore.put(value, key);\n            request.onerror = reject;\n            request.onsuccess = () => resolve();\n        });\n    }\n    async getItem(key) {\n        if (!this.db) {\n            throw new Error(\"Database is not initialized\");\n        }\n        const transaction = this.db.transaction(this.objectStoreName, \"readonly\");\n        const objectStore = transaction.objectStore(this.objectStoreName);\n        return new Promise((resolve, reject) => {\n            const request = objectStore.get(key);\n            request.onerror = reject;\n            request.onsuccess = () => resolve(request.result ?? null);\n        });\n    }\n    async removeItem(key) {\n        if (!this.db) {\n            throw new Error(\"Database is not initialized\");\n        }\n        const transaction = this.db.transaction(this.objectStoreName, \"readwrite\");\n        const objectStore = transaction.objectStore(this.objectStoreName);\n        return new Promise((resolve, reject) => {\n            const request = objectStore.delete(key);\n            request.onerror = reject;\n            request.onsuccess = () => resolve();\n        });\n    }\n    async clear() {\n        if (!this.db) {\n            throw new Error(\"Database is not initialized\");\n        }\n        const transaction = this.db.transaction(this.objectStoreName, \"readwrite\");\n        const objectStore = transaction.objectStore(this.objectStoreName);\n        return new Promise((resolve, reject) => {\n            const request = objectStore.clear();\n            request.onerror = reject;\n            request.onsuccess = () => resolve();\n        });\n    }\n}\n//# sourceMappingURL=IndexedDbCache.js.map","// super thin wrapper around localStorage\nexport class WebStorageCache {\n    async init() {\n        return;\n    }\n    async setItem(key, value) {\n        localStorage.setItem(key, value);\n    }\n    async getItem(key) {\n        return localStorage.getItem(key);\n    }\n    async removeItem(key) {\n        localStorage.removeItem(key);\n    }\n    async clear() {\n        localStorage.clear();\n    }\n}\n//# sourceMappingURL=WebStorageCache.js.map","export class MemoryCache {\n    constructor() {\n        this.cache = {};\n    }\n    async init() {\n        return;\n    }\n    async setItem(key, value) {\n        this.cache[key] = value;\n    }\n    async getItem(key) {\n        return this.cache[key] ?? null;\n    }\n    async removeItem(key) {\n        delete this.cache[key];\n    }\n    async clear() {\n        this.cache = {};\n    }\n}\n//# sourceMappingURL=MemoryCache.js.map","import { ConnectionStatus, } from \"@electrum-cash/network\";\nimport { Network } from \"../interface.js\";\nimport { delay } from \"../util/delay.js\";\nimport { getTransactionHash } from \"../util/transaction.js\";\nimport { Config } from \"../config.js\";\nimport { decodeHeader } from \"../util/header.js\";\nimport { IndexedDbCache } from \"../cache/IndexedDbCache.js\";\nimport { WebStorageCache } from \"../cache/WebStorageCache.js\";\nimport { MemoryCache } from \"../cache/MemoryCache.js\";\nexport default class ElectrumNetworkProvider {\n    get cache() {\n        if (!Config.UseMemoryCache &&\n            !Config.UseLocalStorageCache &&\n            !Config.UseIndexedDBCache) {\n            this._cache = undefined;\n            return this._cache;\n        }\n        if (Config.UseMemoryCache && !(this._cache instanceof MemoryCache)) {\n            this._cache = new IndexedDbCache();\n            return this._cache;\n        }\n        if (Config.UseLocalStorageCache &&\n            !(this._cache instanceof WebStorageCache)) {\n            this._cache = new WebStorageCache();\n            return this._cache;\n        }\n        if (Config.UseIndexedDBCache && !(this._cache instanceof IndexedDbCache)) {\n            this._cache = new IndexedDbCache();\n            return this._cache;\n        }\n        return this._cache;\n    }\n    constructor(electrum, network = Network.MAINNET, manualConnectionManagement) {\n        this.network = network;\n        this.manualConnectionManagement = manualConnectionManagement;\n        this.subscriptions = 0;\n        this.subscribedToHeaders = false;\n        this.subscriptionMap = {};\n        if (electrum) {\n            this.electrum = electrum;\n            this.connectPromise = this.getConnectPromise();\n            this.version = this.electrum.version;\n        }\n        else {\n            throw new Error(`A electrum-cash client is required.`);\n        }\n    }\n    async getConnectPromise(_timeout = 3000) {\n        // connects to the electrum cash and waits until the connection is ready to accept requests\n        let timeoutHandle;\n        await Promise.race([\n            new Promise(async (resolve) => {\n                this.connectPromise = undefined;\n                resolve(await this.connectClient());\n            }),\n        ]);\n        clearTimeout(timeoutHandle);\n    }\n    async getUtxos(cashaddr) {\n        const result = await this.performRequest(\"blockchain.address.listunspent\", cashaddr, \"include_tokens\");\n        return result.map((utxo) => ({\n            txid: utxo.tx_hash,\n            vout: utxo.tx_pos,\n            satoshis: utxo.value,\n            height: utxo.height,\n            token: utxo.token_data\n                ? {\n                    amount: BigInt(utxo.token_data.amount),\n                    tokenId: utxo.token_data.category,\n                    capability: utxo.token_data.nft?.capability,\n                    commitment: utxo.token_data.nft?.commitment,\n                }\n                : undefined,\n        }));\n    }\n    async getBalance(cashaddr) {\n        const result = await this.performRequest(\"blockchain.address.get_balance\", cashaddr);\n        return result.confirmed + result.unconfirmed;\n    }\n    async getHeader(height, verbose = false) {\n        const key = `header-${this.network}-${height}-${verbose}`;\n        if (this.cache) {\n            const cached = await this.cache.getItem(key);\n            if (cached) {\n                return verbose ? decodeHeader(JSON.parse(cached)) : JSON.parse(cached);\n            }\n        }\n        const result = await this.performRequest(\"blockchain.header.get\", height);\n        if (this.cache) {\n            await this.cache.setItem(key, JSON.stringify(result));\n        }\n        return verbose ? decodeHeader(result) : result;\n    }\n    async getBlockHeight() {\n        return (await this.performRequest(\"blockchain.headers.get_tip\"))\n            .height;\n    }\n    async getRawTransaction(txHash, verbose = false, loadInputValues = false) {\n        const key = `tx-${this.network}-${txHash}-${verbose}-${loadInputValues}`;\n        if (this.cache) {\n            const cached = await this.cache.getItem(key);\n            if (cached) {\n                return verbose ? JSON.parse(cached) : cached;\n            }\n        }\n        try {\n            const transaction = (await this.performRequest(\"blockchain.transaction.get\", txHash, verbose));\n            if (this.cache) {\n                await this.cache.setItem(key, verbose\n                    ? JSON.stringify(transaction)\n                    : transaction);\n            }\n            if (verbose && loadInputValues) {\n                // get unique transaction hashes\n                const hashes = [...new Set(transaction.vin.map((val) => val.txid))];\n                const transactions = await Promise.all(hashes.map((hash) => this.getRawTransactionObject(hash, false)));\n                const transactionMap = new Map();\n                transactions.forEach((val) => transactionMap.set(val.hash, val));\n                transaction.vin.forEach((input) => {\n                    const output = transactionMap\n                        .get(input.txid)\n                        .vout.find((val) => val.n === input.vout);\n                    input.address = output.scriptPubKey.addresses[0];\n                    input.value = output.value;\n                    input.tokenData = output.tokenData;\n                });\n            }\n            return transaction;\n        }\n        catch (error) {\n            if (error.message.indexOf(\"No such mempool or blockchain transaction.\") > -1)\n                throw Error(`Could not decode transaction ${txHash}. It might not exist on the current blockchain (${this.network}).`);\n            else\n                throw error;\n        }\n    }\n    // gets the decoded transaction in human readable form\n    async getRawTransactionObject(txHash, loadInputValues = false) {\n        return (await this.getRawTransaction(txHash, true, loadInputValues));\n    }\n    async sendRawTransaction(txHex, awaitPropagation = true) {\n        return new Promise(async (resolve, reject) => {\n            let txHash = await getTransactionHash(txHex);\n            if (!awaitPropagation) {\n                this.performRequest(\"blockchain.transaction.broadcast\", txHex);\n                resolve(txHash);\n            }\n            else {\n                let cancel;\n                const waitForTransactionCallback = async (data) => {\n                    if (data && data[0] === txHash && data[1] !== null) {\n                        await cancel?.();\n                        resolve(txHash);\n                    }\n                };\n                cancel = await this.subscribeToTransaction(txHash, waitForTransactionCallback);\n                this.performRequest(\"blockchain.transaction.broadcast\", txHex).catch(async (error) => {\n                    await cancel?.();\n                    reject(error);\n                });\n            }\n        });\n    }\n    // Get transaction history of a given cashaddr\n    async getHistory(cashaddr, fromHeight = 0, toHeight = -1) {\n        const result = await this.performRequest(\"blockchain.address.get_history\", cashaddr, fromHeight, toHeight);\n        return result;\n    }\n    // Get the minimum fee a low-priority transaction must pay in order to be accepted to the daemon's memory pool.\n    async getRelayFee() {\n        const result = (await this.performRequest(\"blockchain.relayfee\"));\n        return result;\n    }\n    async watchAddressStatus(cashaddr, callback) {\n        const watchAddressStatusCallback = async (data) => {\n            // subscription acknowledgement is the latest known status or null if no status is known\n            // status is an array: [ cashaddr, statusHash ]\n            if (data instanceof Array) {\n                const addr = data[0];\n                if (addr !== cashaddr) {\n                    return;\n                }\n                const status = data[1];\n                callback(status);\n            }\n        };\n        return this.subscribeToAddress(cashaddr, watchAddressStatusCallback);\n    }\n    async watchAddress(cashaddr, callback) {\n        const historyMap = {};\n        this.getHistory(cashaddr).then((history) => history.forEach((val) => (historyMap[val.tx_hash] = true)));\n        const watchAddressStatusCallback = async () => {\n            const newHistory = await this.getHistory(cashaddr);\n            // sort history to put unconfirmed transactions in the beginning, then transactions in block height descenting order\n            const txHashes = newHistory\n                .sort((a, b) => a.height <= 0 || b.height <= 0 ? -1 : b.height - a.height)\n                .map((val) => val.tx_hash);\n            for (const hash of txHashes) {\n                if (!(hash in historyMap)) {\n                    historyMap[hash] = true;\n                    callback(hash);\n                    // exit early to prevent further map lookups\n                    break;\n                }\n            }\n        };\n        return this.watchAddressStatus(cashaddr, watchAddressStatusCallback);\n    }\n    async watchAddressTransactions(cashaddr, callback) {\n        return this.watchAddress(cashaddr, async (txHash) => {\n            const tx = await this.getRawTransactionObject(txHash);\n            callback(tx);\n        });\n    }\n    async watchAddressTokenTransactions(cashaddr, callback) {\n        return this.watchAddress(cashaddr, async (txHash) => {\n            const tx = await this.getRawTransactionObject(txHash, true);\n            if (tx.vin.some((val) => val.tokenData) ||\n                tx.vout.some((val) => val.tokenData)) {\n                callback(tx);\n            }\n        });\n    }\n    // watch for block headers and block height, if `skipCurrentHeight` is set, the notification about current block will not arrive\n    async watchBlocks(callback, skipCurrentHeight = true) {\n        let acknowledged = !skipCurrentHeight;\n        const waitForBlockCallback = (_header) => {\n            if (!acknowledged) {\n                acknowledged = true;\n                return;\n            }\n            _header = _header instanceof Array ? _header[0] : _header;\n            callback(_header);\n        };\n        return this.subscribeToHeaders(waitForBlockCallback);\n    }\n    // Wait for the next block or a block at given blockchain height.\n    async waitForBlock(height) {\n        return new Promise(async (resolve) => {\n            let cancelWatch;\n            if (this.electrum.chainHeight && !height) {\n                height = this.electrum.chainHeight + 1;\n            }\n            cancelWatch = await this.watchBlocks(async (header) => {\n                if (!height) {\n                    height = header.height + 1;\n                    return;\n                }\n                if (header.height >= height) {\n                    await cancelWatch?.();\n                    resolve(header);\n                    return;\n                }\n            });\n        });\n    }\n    // subscribe to notifications sent when new block is found, the block header is sent to callback\n    async subscribeToHeaders(callback) {\n        return this.subscribeRequest(\"blockchain.headers.subscribe\", callback);\n    }\n    async subscribeToAddress(cashaddr, callback) {\n        return this.subscribeRequest(\"blockchain.address.subscribe\", callback, cashaddr);\n    }\n    async subscribeToTransaction(txHash, callback) {\n        return this.subscribeRequest(\"blockchain.transaction.subscribe\", callback, txHash);\n    }\n    async performRequest(name, ...parameters) {\n        await this.ready();\n        const requestTimeout = new Promise(function (_resolve, reject) {\n            setTimeout(function () {\n                reject(\"electrum-cash request timed out, retrying\");\n            }, 30000);\n        }).catch(function (e) {\n            throw e;\n        });\n        const request = this.electrum.request(name, ...parameters);\n        return await Promise.race([request, requestTimeout])\n            .then((value) => {\n            if (value instanceof Error)\n                throw value;\n            let result = value;\n            return result;\n        })\n            .catch(async () => {\n            // console.warn(\n            //   \"initial electrum-cash request attempt timed out, retrying...\"\n            // );\n            return await Promise.race([request, requestTimeout])\n                .then((value) => {\n                if (value instanceof Error)\n                    throw value;\n                let result = value;\n                return result;\n            })\n                .catch(function (e) {\n                throw e;\n            });\n        });\n    }\n    async trackSubscription(methodName, ...parameters) {\n        const key = `${methodName}-${this.network}-${JSON.stringify(parameters)}`;\n        if (this.subscriptionMap[key]) {\n            this.subscriptionMap[key]++;\n        }\n        else {\n            this.subscriptionMap[key] = 1;\n        }\n        await this.electrum.subscribe(methodName, ...parameters);\n    }\n    async untrackSubscription(methodName, ...parameters) {\n        const key = `${methodName}-${this.network}-${JSON.stringify(parameters)}`;\n        if (this.subscriptionMap[key]) {\n            this.subscriptionMap[key]--;\n            if (this.subscriptionMap[key] <= 0) {\n                // only really unsubscribe if there are no more subscriptions for this `key`\n                delete this.subscriptionMap[key];\n                try {\n                    await this.electrum.unsubscribe(methodName, ...parameters);\n                }\n                catch { }\n            }\n        }\n    }\n    async subscribeRequest(methodName, callback, ...parameters) {\n        await this.ready();\n        const handler = (data) => {\n            if (data.method === methodName) {\n                callback(data.params);\n            }\n        };\n        this.electrum.on(\"notification\", handler);\n        // safeguard against multiple subscriptions to headers\n        if (methodName === \"blockhain.headers.subscribe\") {\n            if (!this.subscribedToHeaders) {\n                this.subscribedToHeaders = true;\n                await this.trackSubscription(methodName, ...parameters);\n            }\n        }\n        else {\n            await this.trackSubscription(methodName, ...parameters);\n        }\n        this.subscriptions++;\n        return async () => {\n            this.electrum.off(\"notification\", handler);\n            this.subscriptions--;\n            // there are no blockchain.headers.unsubscribe method, so let's safeguard against it\n            if (methodName !== \"blockchain.headers.subscribe\") {\n                await this.untrackSubscription(methodName, ...parameters);\n            }\n        };\n    }\n    async ready() {\n        return this.connect();\n    }\n    async connect() {\n        await this.cache?.init();\n        return await this.connectPromise;\n    }\n    disconnect() {\n        if (this.subscriptions > 0) {\n            // console.warn(\n            //   `Trying to disconnect a network provider with ${this.subscriptions} active subscriptions. This is in most cases a bad idea.`\n            // );\n        }\n        return this.disconnectClient();\n    }\n    async readyClient(timeout) {\n        timeout = typeof timeout !== \"undefined\" ? timeout : 3000;\n        let connectPromise = async () => {\n            while (this.electrum.status !== ConnectionStatus.CONNECTED) {\n                await delay(100);\n            }\n            return true;\n        };\n        return connectPromise;\n    }\n    async connectClient() {\n        let connectionPromise = async () => {\n            try {\n                return await this.electrum.connect();\n            }\n            catch (e) {\n                console.warn(`Warning: Failed to connect to client on ${this.network} at ${this.electrum.hostIdentifier}.`, e);\n                return;\n            }\n        };\n        return connectionPromise();\n    }\n    async disconnectClient() {\n        return this.electrum.disconnect(true, false);\n    }\n}\n//# sourceMappingURL=ElectrumNetworkProvider.js.map","export const bchParam = {\n    subUnits: 100000000,\n};\n//# sourceMappingURL=chain.js.map","import { CashAddressNetworkPrefix } from \"@bitauth/libauth\";\nexport var NetworkType;\n(function (NetworkType) {\n    NetworkType[\"Mainnet\"] = \"mainnet\";\n    NetworkType[\"Testnet\"] = \"testnet\";\n    NetworkType[\"Regtest\"] = \"regtest\";\n})(NetworkType || (NetworkType = {}));\nexport var NetworkEnum;\n(function (NetworkEnum) {\n    NetworkEnum[NetworkEnum[\"Mainnet\"] = \"mainnet\"] = \"Mainnet\";\n    NetworkEnum[NetworkEnum[\"Testnet\"] = \"testnet\"] = \"Testnet\";\n    NetworkEnum[NetworkEnum[\"Regtest\"] = \"regtest\"] = \"Regtest\";\n    NetworkEnum[NetworkEnum[\"Simtest\"] = \"simtest\"] = \"Simtest\";\n})(NetworkEnum || (NetworkEnum = {}));\nexport const networkPrefixMap = {\n    bitcoincash: \"mainnet\",\n    bchtest: \"testnet\",\n    bchreg: \"regtest\",\n};\nexport const prefixFromNetworkMap = {\n    mainnet: CashAddressNetworkPrefix.mainnet,\n    testnet: CashAddressNetworkPrefix.testnet,\n    regtest: CashAddressNetworkPrefix.regtest,\n};\nconst literal = (l) => l;\nexport const UnitEnum = {\n    BCH: literal(\"bch\"),\n    USD: literal(\"usd\"),\n    BIT: literal(\"bit\"),\n    BITS: literal(\"bits\"),\n    SAT: literal(\"sat\"),\n    SATS: literal(\"sats\"),\n    SATOSHI: literal(\"satoshi\"),\n    SATOSHIS: literal(\"satoshis\"),\n};\n//# sourceMappingURL=enum.js.map","export default class ExchangeRateProvider {\n    /*\n     *   Exchange Rate functions\n     */\n    async getRate(symbol) {\n        const valueString = localStorage.getItem(`rate-${symbol}`);\n        if (valueString) {\n            return JSON.parse(valueString);\n        }\n        return undefined;\n    }\n    async setRate(symbol, rate, ttl) {\n        localStorage.setItem(`rate-${symbol}`, JSON.stringify({ symbol: symbol, rate: rate, ttl: ttl }));\n        return true;\n    }\n}\n//# sourceMappingURL=ExchangeRateProvider.js.map","import { EXCHANGE_RATE_TTL } from \"../constant.js\";\nimport { RuntimePlatform, getRuntimePlatform, } from \"../util/getRuntimePlatform.js\";\nimport ExchangeRateProvider from \"../db/ExchangeRateProvider.js\";\nexport class ExchangeRate {\n    constructor({ symbol, rate, ttl, }) {\n        this.symbol = symbol;\n        this.rate = rate;\n        this.ttl = ttl;\n    }\n    toString() {\n        this.rate.toFixed(2);\n    }\n    static async get(symbol, useCache = true) {\n        const platform = getRuntimePlatform();\n        if (platform === RuntimePlatform.browser) {\n            try {\n                return await this.getRateFromLocalStorage(symbol, useCache);\n            }\n            catch {\n                return await this.getRateFromGlobalScope(symbol, useCache);\n            }\n        }\n        else {\n            return await this.getRateFromGlobalScope(symbol, useCache);\n        }\n    }\n    static async getRateFromLocalStorage(symbol, useCache = true) {\n        if (!useCache) {\n            return await getRateFromExchange(symbol);\n        }\n        let cache = new ExchangeRateProvider();\n        let cacheRate = await cache.getRate(symbol);\n        if (cacheRate) {\n            // if the cache is still good, return it\n            if (cacheRate.ttl > Date.now()) {\n                return cacheRate.rate;\n            }\n            // else fall through\n        }\n        let freshRate = await getRateFromExchange(symbol);\n        cache.setRate(symbol, freshRate, getTtl());\n        return freshRate;\n    }\n    static async getRateFromGlobalScope(symbol, useCache = true) {\n        if (!useCache) {\n            return await getRateFromExchange(symbol);\n        }\n        if (globalThis.RATE) {\n            let rateObject = globalThis.RATE;\n            if (symbol in rateObject) {\n                let cachedRate = rateObject[symbol];\n                // If the cache is still good return ie\n                if (cachedRate.ttl > Date.now()) {\n                    return cachedRate.rate;\n                }\n            }\n        }\n        let freshRate = await getRateFromExchange(symbol);\n        this.cacheRateInGlobalScope(symbol, freshRate);\n        return freshRate;\n    }\n    static cacheRateInGlobalScope(symbol, rate) {\n        if (!globalThis.RATE) {\n            globalThis.RATE = {};\n        }\n        else {\n            globalThis.RATE[symbol] = {\n                symbol: symbol,\n                rate: rate,\n                ttl: getTtl(),\n            };\n        }\n    }\n}\nexport function getTtl() {\n    return Math.trunc(Date.now() + EXCHANGE_RATE_TTL);\n}\n// Attempt to get the usd rate from some web app\nexport async function getRateFromExchange(symbol) {\n    if (symbol.length > 0) {\n        symbol = symbol.toLocaleLowerCase();\n    }\n    if (symbol === \"usd\") {\n        try {\n            const response = await fetch(\"https://markets.api.bitcoin.com/live/bitcoin\");\n            const data = await response.json();\n            return data[\"data\"][\"BCH\"];\n        }\n        catch { }\n    }\n    const response = await fetch(\"https://bitpay.com/rates/BCH\");\n    const data = (await response.json());\n    const rates = data.data.reduce((acc, rate) => ({ ...acc, [rate.code.toLocaleLowerCase()]: rate.rate }), {});\n    if (symbol in rates) {\n        return rates[symbol];\n    }\n    throw Error(`Currency '${symbol}' is not supported.`);\n}\n// do not await and do not throw in case we are offline\nExchangeRate.get(\"usd\").catch(() => { });\n//# sourceMappingURL=ExchangeRate.js.map","export function sanitizeUnit(rawUnit) {\n    if (rawUnit) {\n        return rawUnit.toLocaleLowerCase();\n    }\n    else {\n        throw Error(\"Attempted to sanitize a unit of value, but the unit was undefined.\");\n    }\n}\n//# sourceMappingURL=sanitizeUnit.js.map","import { bchParam } from \"../chain.js\";\nimport { UnitEnum } from \"../enum.js\";\nimport { ExchangeRate } from \"../rate/ExchangeRate.js\";\nimport { sanitizeUnit } from \"../util/sanitizeUnit.js\";\n/**\n * converts given value and unit into satoshi\n *\n * @param {value} number           some value\n * @param {rawUnit} any            the unit of value\n *\n * @returns a promise to the value in satoshi\n */\nexport async function amountInSatoshi(value, rawUnit) {\n    const unit = sanitizeUnit(rawUnit);\n    switch (unit) {\n        case UnitEnum.BCH:\n            return Math.round(value * bchParam.subUnits);\n        case UnitEnum.SATOSHI:\n            return value;\n        case UnitEnum.SAT:\n            return value;\n        case UnitEnum.SATS:\n            return value;\n        case UnitEnum.SATOSHIS:\n            return value;\n        default:\n            const Currency_over_BCH = await ExchangeRate.get(rawUnit);\n            const SAT_over_BCH = bchParam.subUnits;\n            return Math.round(Number(value * (SAT_over_BCH / Currency_over_BCH)));\n    }\n}\n//# sourceMappingURL=amountInSatoshi.js.map","import { ripemd160, sha256 } from \"@bitauth/libauth\";\n/**\n * hash160 - Calculate the sha256, ripemd160 hash of a value\n *\n * @param {message} Uint8Array       value to hash as a binary array\n *\n * @returns a promise to the hash160 value of the input\n */\nexport function hash160(message) {\n    return ripemd160.hash(sha256.hash(message));\n}\n//# sourceMappingURL=hash160.js.map","import { CashAddressType, decodeCashAddress, encodeCashAddress, secp256k1, } from \"@bitauth/libauth\";\nimport { prefixFromNetworkMap } from \"../enum.js\";\nimport { hash160 } from \"./hash160.js\";\nexport function isValidAddress(cashaddr) {\n    const result = decodeCashAddress(cashaddr);\n    if (typeof result === \"string\") {\n        return false;\n    }\n    return true;\n}\nexport function deriveCashaddr(privateKey, networkPrefix) {\n    let publicKey = secp256k1.derivePublicKeyCompressed(privateKey);\n    if (typeof publicKey === \"string\") {\n        throw new Error(publicKey);\n    }\n    let pkh = hash160(publicKey);\n    return encodeCashAddress({\n        prefix: networkPrefix,\n        type: CashAddressType.p2pkh,\n        payload: pkh,\n    }).address;\n}\nexport function deriveTokenaddr(key, networkPrefix) {\n    let publicKeyHash;\n    // private key\n    if (key.length === 32) {\n        let publicKeyCompressed = secp256k1.derivePublicKeyCompressed(key);\n        if (typeof publicKeyCompressed === \"string\") {\n            throw new Error(publicKeyCompressed);\n        }\n        publicKeyHash = hash160(publicKeyCompressed);\n    }\n    else if (key.length === 65) {\n        // uncompressed public key\n        let publicKeyCompressed = secp256k1.compressPublicKey(key);\n        if (typeof publicKeyCompressed === \"string\") {\n            throw new Error(publicKeyCompressed);\n        }\n        publicKeyHash = hash160(publicKeyCompressed);\n    }\n    else if (key.length === 33) {\n        // compressed public key\n        publicKeyHash = hash160(key);\n    }\n    else if (key.length === 20) {\n        // public key hash\n        publicKeyHash = key;\n    }\n    else {\n        throw new Error(\"Unsupported type of key\");\n    }\n    return encodeCashAddress({\n        prefix: networkPrefix,\n        type: CashAddressType.p2pkhWithTokens,\n        payload: publicKeyHash,\n    }).address;\n}\nfunction decodeAddress(address) {\n    const result = decodeCashAddress(address);\n    if (typeof result === \"string\") {\n        throw new Error(result);\n    }\n    return result;\n}\nexport function toCashaddr(address) {\n    const result = decodeAddress(address);\n    return encodeCashAddress({\n        prefix: result.prefix,\n        type: result.type.replace(\"WithTokens\", \"\"),\n        payload: result.payload,\n    }).address;\n}\nexport function toTokenaddr(address) {\n    const result = decodeAddress(address);\n    return encodeCashAddress({\n        prefix: result.prefix,\n        type: (result.type.replace(\"WithTokens\", \"\") +\n            \"WithTokens\"),\n        payload: result.payload,\n    }).address;\n}\nexport function isTokenaddr(address) {\n    const result = decodeAddress(address);\n    return result.type.endsWith(\"WithTokens\");\n}\n// This function converts a cash address to a cash address of the specified network.\n// If withTokens is true, it will return a token-aware address.\n// If withTokens is false, it will return a non-token-aware address.\n// If withTokens is undefined, it will not change the token-awareness.\nexport function convertAddress(address, network = \"mainnet\", withTokens = undefined) {\n    const result = decodeAddress(address);\n    return encodeCashAddress({\n        prefix: prefixFromNetworkMap[network],\n        type: withTokens === undefined\n            ? result.type\n            : (result.type.replace(\"WithTokens\", \"\") +\n                (withTokens ? \"WithTokens\" : \"\")),\n        payload: result.payload,\n    }).address;\n}\nexport function checkTokenaddr(cashaddr, enforce) {\n    if (enforce && !isTokenaddr(cashaddr)) {\n        throw new Error(\"Error trying to send to a non-tokenaware cash address\");\n    }\n}\n//# sourceMappingURL=deriveCashaddr.js.map","import { sanitizeUnit } from \"../util/sanitizeUnit.js\";\nimport { DELIMITER } from \"../constant.js\";\nimport { binToNumberUint16LE, binToUtf8, hexToBin, utf8ToBin, } from \"@bitauth/libauth\";\nimport { Config } from \"../config.js\";\nimport { checkTokenaddr } from \"../util/deriveCashaddr.js\";\nexport class SendRequest {\n    constructor({ cashaddr, value, unit, }) {\n        this.cashaddr = cashaddr;\n        this.value = value;\n        this.unit = sanitizeUnit(unit);\n    }\n}\nexport class TokenGenesisRequest {\n    constructor({ amount, capability, commitment, cashaddr, value, }) {\n        this.amount = amount;\n        this.capability = capability;\n        this.commitment = commitment;\n        this.cashaddr = cashaddr;\n        this.value = value;\n    }\n}\nexport class TokenBurnRequest {\n    constructor({ tokenId, capability, commitment, amount, cashaddr, }) {\n        this.tokenId = tokenId;\n        this.capability = capability;\n        this.commitment = commitment;\n        this.amount = amount ? BigInt(amount) : 0n;\n        this.cashaddr = cashaddr;\n    }\n}\nexport class TokenSendRequest {\n    constructor({ cashaddr, value, amount, tokenId, capability, commitment, }) {\n        checkTokenaddr(cashaddr, Config.EnforceCashTokenReceiptAddresses);\n        this.cashaddr = cashaddr;\n        this.value = value;\n        this.amount = amount ? BigInt(amount) : 0n;\n        this.tokenId = tokenId;\n        this.capability = capability;\n        this.commitment = commitment;\n    }\n}\nexport class TokenMintRequest {\n    constructor({ capability, commitment, cashaddr, value, }) {\n        this.capability = capability;\n        this.commitment = commitment;\n        this.cashaddr = cashaddr;\n        this.value = value;\n    }\n}\nexport class OpReturnData {\n    constructor(buffer) {\n        this.buffer = Uint8Array.from(buffer);\n    }\n    /**\n     * from - Construct OP_RETURN data from arbitrary data type\n     *\n     * @param string   UTF-8 encoded string message to be converted to OP_RETURN data\n     *\n     * @returns class instance\n     */\n    static from(data) {\n        return this.fromArray([data]);\n    }\n    /**\n     * fromString - Accept data as a simple UTF-8 string message and append an OP_RETURN and PUSH_DATA1 opcodes to it\n     *\n     * @param string   UTF-8 encoded string message to be converted to OP_RETURN data\n     *\n     * @returns class instance\n     */\n    static fromString(string) {\n        return this.fromArray([string]);\n    }\n    /**\n     * buffer - Accept OP_RETURN data as a binary buffer.\n     * If buffer lacks the OP_RETURN and OP_PUSHDATA opcodes, they will be prepended.\n     *\n     * @param buffer   Data buffer to be assigned to the OP_RETURN outpit\n     *\n     * @returns class instance\n     */\n    static fromUint8Array(uint8Array) {\n        if (uint8Array[0] !== 0x6a) {\n            return this.fromArray([uint8Array]);\n        }\n        return new this(Uint8Array.from(uint8Array));\n    }\n    /**\n     * fromArray - Accept array of data\n     *\n     * @param array   Array of Uint8Array or UTF-8 encoded string messages to be converted to OP_RETURN data\n     *\n     * @returns class instance\n     */\n    static fromArray(array) {\n        let data = Uint8Array.from([0x6a]); // OP_RETURN\n        for (const element of array) {\n            let length;\n            let elementData;\n            let lengthData;\n            if (typeof element === \"string\") {\n                elementData = utf8ToBin(element);\n                length = elementData.length;\n            }\n            else if (element instanceof Uint8Array) {\n                elementData = element;\n                length = elementData.length;\n            }\n            else {\n                throw new Error(\"Wrong data array element\");\n            }\n            if (length < 76) {\n                // OP_PUSHDATA_1\n                lengthData = [length];\n            }\n            else if (length < 223) {\n                // default max `-datacarriersize`\n                lengthData = [0x4c, length];\n            }\n            else {\n                throw new Error(\"OP_RETURN data can not exceed 220 bytes in size\");\n            }\n            data = Uint8Array.from([...data, ...lengthData, ...elementData]);\n        }\n        if (data.length > 220) {\n            throw new Error(\"OP_RETURN data can not exceed 220 bytes in size\");\n        }\n        return new this(data);\n    }\n    /**\n     * parseBinary - parse OP_RETURN data and return pushed chunks of binary data\n     *\n     * @param opReturn   Raw OP_RETURN data\n     *\n     * @returns array of binary data chunks pushed\n     */\n    static parseBinary(opReturn) {\n        const chunks = [];\n        let position = 1;\n        // handle direct push, OP_PUSHDATA1, OP_PUSHDATA2;\n        // OP_PUSHDATA4 is not supported in OP_RETURNs by consensus\n        while (opReturn[position]) {\n            let length = 0;\n            if (opReturn[position] === 0x4c) {\n                length = opReturn[position + 1];\n                position += 2;\n            }\n            else if (opReturn[position] === 0x4d) {\n                length = binToNumberUint16LE(opReturn.slice(position + 1, position + 3));\n                position += 3;\n            }\n            else {\n                length = opReturn[position];\n                position += 1;\n            }\n            chunks.push(opReturn.slice(position, position + length));\n            position += length;\n        }\n        return chunks;\n    }\n    /**\n     * parse - parse OP_RETURN hex data and return pushed chunks of binary data, converted to utf8 strings\n     *\n     * @param opReturn   Raw OP_RETURN hex data\n     *\n     * @returns array of binary data chunks pushed, converted to utf8 strings\n     */\n    static parse(opReturnHex) {\n        return this.parseBinary(hexToBin(opReturnHex)).map((val) => binToUtf8(val));\n    }\n}\nexport class SendResponse {\n    constructor({ txId, balance, explorerUrl, }) {\n        this.txId = txId;\n        this.balance = balance;\n        this.explorerUrl = explorerUrl;\n    }\n}\nexport class XPubKey {\n    constructor({ path, xPubKey }) {\n        this.path = path;\n        this.xPubKey = xPubKey;\n    }\n    async ready() {\n        await this.xPubKey;\n        return this.asObject();\n    }\n    asObject() {\n        return {\n            path: this.path,\n            xPubKey: this.xPubKey,\n        };\n    }\n}\nexport const fromUtxoId = (utxoId) => {\n    const [txid, vout, satoshis, tokenId, amount, capability, commitment] = utxoId.split(DELIMITER);\n    return {\n        satoshis: satoshis ? parseInt(satoshis) : 0,\n        vout: parseInt(vout),\n        txid,\n        token: tokenId\n            ? {\n                tokenId,\n                amount: BigInt(amount),\n                capability: capability || undefined,\n                commitment: commitment || undefined,\n            }\n            : undefined,\n    };\n};\nexport const toUtxoId = (utxo) => {\n    return [\n        utxo.txid,\n        utxo.vout,\n        utxo.satoshis,\n        utxo.token?.tokenId,\n        utxo.token?.amount,\n        utxo.token?.capability,\n        utxo.token?.commitment,\n    ]\n        .join(DELIMITER)\n        .replace(/:+$/, \"\");\n};\n//# sourceMappingURL=model.js.map","import { base64ToBin } from \"@bitauth/libauth\";\nimport { OpReturnData, SendRequest, TokenSendRequest, } from \"../wallet/model.js\";\nexport function asSendRequestObject(requests) {\n    let resp = [];\n    if (Array.isArray(requests)) {\n        requests.forEach((r) => {\n            // the SendRequestArray[] case\n            if (Array.isArray(r)) {\n                if (r[0] === \"OP_RETURN\") {\n                    // ['OP_RETURN', utf8ToBin('MEMO\\x10')],\n                    resp.push(OpReturnData.from(r[1]));\n                }\n                else if (r[0] === \"OP_RETURNB64\") {\n                    resp.push(OpReturnData.fromUint8Array(Uint8Array.from(base64ToBin(r[1]))));\n                }\n                else {\n                    // ['cashaddr', 120, 'sats'],\n                    resp.push(new SendRequest({\n                        cashaddr: r[0],\n                        value: r[1],\n                        unit: r[2],\n                    }));\n                }\n            }\n            else {\n                // SendRequest | TokenSendRequest | OpReturnRequest case\n                resp.push(convertToClass(r));\n            }\n        });\n    }\n    else {\n        // the SendRequest | OpReturnData object case\n        resp.push(convertToClass(requests));\n    }\n    return resp;\n}\nfunction convertToClass(object) {\n    if (object.hasOwnProperty(\"unit\")) {\n        return new SendRequest(object);\n    }\n    else if (object.hasOwnProperty(\"tokenId\")) {\n        return new TokenSendRequest(object);\n    }\n    else if (object.hasOwnProperty(\"buffer\")) {\n        return OpReturnData.fromUint8Array(object.buffer);\n    }\n    // endcoding in REST\n    else if (object.hasOwnProperty(\"dataString\")) {\n        return OpReturnData.fromString(object.dataString);\n    }\n    else if (object.hasOwnProperty(\"dataBuffer\")) {\n        return OpReturnData.fromUint8Array(Uint8Array.from(base64ToBin(object.dataBuffer)));\n    }\n    throw new Error(\"Unsupported send object\");\n}\n//# sourceMappingURL=asSendRequestObject.js.map","import { bchParam } from \"../chain.js\";\nimport { UnitEnum } from \"../enum.js\";\nimport { ExchangeRate } from \"../rate/ExchangeRate.js\";\nimport { sanitizeUnit } from \"../util/sanitizeUnit.js\";\n/**\n * converts given value and unit from satoshi\n *\n * @param {value} number           some value in satoshi\n * @param {rawUnit} any            the target unit\n *\n * @returns a promise to the value in the unit of account given by rawUnit\n */\nexport async function satoshiToAmount(value, rawUnit) {\n    const unit = sanitizeUnit(rawUnit);\n    switch (unit) {\n        case UnitEnum.BCH:\n            return value / bchParam.subUnits;\n        case UnitEnum.SATOSHI:\n            return value;\n        case UnitEnum.SAT:\n            return value;\n        case UnitEnum.SATS:\n            return value;\n        case UnitEnum.SATOSHIS:\n            return value;\n        default:\n            const Currency_over_BCH = await ExchangeRate.get(rawUnit);\n            // truncate currency amounts to fixed precision (2),\n            // then return the fixed value string as a float.\n            const currencyValue = Number(value * (Currency_over_BCH / bchParam.subUnits)).toFixed(2);\n            return Number.parseFloat(currencyValue);\n    }\n}\n//# sourceMappingURL=satoshiToAmount.js.map","import { amountInSatoshi } from \"./amountInSatoshi.js\";\nimport { satoshiToAmount } from \"./satoshiToAmount.js\";\n/**\n * convert transforms unit of measurement for some monetary value\n *\n * @param {value} number           amount to convert\n * @param {from} any               unit of measurement to convert from\n * @param {to} any                 unit of measurement to convert to\n *\n * @returns a promise to the value in \"to\" units\n */\nexport async function convert(value, from, to) {\n    let satoshi = await amountInSatoshi(value, from);\n    return satoshiToAmount(satoshi, to);\n}\nexport async function convertObject({ value, from, to, }) {\n    return await convert(value, from, to);\n}\n//# sourceMappingURL=convert.js.map","import { decodeCashAddressFormat, decodeCashAddressFormatWithoutPrefix, } from \"@bitauth/libauth\";\n/**\n * Helper function to convert an address to a public key hash\n *\n * @param address   Address to convert to a hash\n *\n * @returns a public key hash corresponding to the passed address\n */\nexport function derivePublicKeyHash(address) {\n    let result;\n    // If the address has a prefix decode it as is\n    if (address.includes(\":\")) {\n        result = decodeCashAddressFormat(address);\n    }\n    // otherwise, derive the network from the address without prefix\n    else {\n        result = decodeCashAddressFormatWithoutPrefix(address);\n    }\n    if (typeof result === \"string\")\n        throw new Error(result);\n    // return the public key hash\n    return result.payload;\n}\n/**\n * Helper function to convert an address prefix\n *\n * @param address   Address with or without prefix\n *\n * @returns the address prefix\n */\nexport function derivePrefix(address) {\n    let result;\n    if (address.includes(\":\")) {\n        result = decodeCashAddressFormat(address);\n    }\n    else {\n        result = decodeCashAddressFormatWithoutPrefix(address);\n    }\n    if (typeof result === \"string\")\n        throw new Error(result);\n    // TODO pass the network in and check it or raise Error\n    return result.prefix;\n}\n//# sourceMappingURL=derivePublicKeyHash.js.map","import { deriveHdPrivateNodeFromSeed, deriveHdPath, deriveHdPublicNode, encodeHdPublicKey, hexToBin, } from \"@bitauth/libauth\";\nexport function getXPubKey(seed, derivationPath, network) {\n    if (typeof seed === \"string\") {\n        seed = hexToBin(seed);\n    }\n    let hdNode = deriveHdPrivateNodeFromSeed(seed, {\n        assumeValidity: true, // TODO: we should switch to libauth's BIP39 implementation and set this to false\n        throwErrors: true,\n    });\n    let node = deriveHdPath(hdNode, derivationPath);\n    if (typeof node === \"string\") {\n        throw node;\n    }\n    let parentPublicNode = deriveHdPublicNode(node);\n    let xPubKey = encodeHdPublicKey({\n        network: network,\n        node: parentPublicNode,\n    }, {\n        throwErrors: true,\n    }).hdPublicKey;\n    return xPubKey;\n}\n//# sourceMappingURL=getXPubKey.js.map","export function sumUtxoValue(utxos) {\n    if (utxos.length > 0) {\n        const balanceArray = utxos.map((o) => {\n            return o.satoshis;\n        });\n        const balance = balanceArray.reduce((a, b) => a + b, 0);\n        return balance;\n    }\n    else {\n        return 0;\n    }\n}\nexport function sumTokenAmounts(utxos, tokenId) {\n    if (utxos.length > 0) {\n        const tokenArray = utxos\n            .filter((utxo) => utxo.token?.tokenId === tokenId)\n            .map((o) => {\n            return o.token?.amount || 0n;\n        });\n        const balance = tokenArray.reduce((a, b) => a + b, 0n);\n        return balance;\n    }\n    else {\n        return 0n;\n    }\n}\n//# sourceMappingURL=sumUtxoValue.js.map","export function floor(value, precision) {\n    var multiplier = Math.pow(10, precision || 0);\n    return Math.floor(value * multiplier) / multiplier;\n}\n//# sourceMappingURL=floor.js.map","import { bchParam } from \"../chain.js\";\nimport { UnitEnum } from \"../enum.js\";\nimport { floor } from \"./floor.js\";\nimport { ExchangeRate } from \"../rate/ExchangeRate.js\";\nimport { sanitizeUnit } from \"./sanitizeUnit.js\";\nimport { Config } from \"../config.js\";\nexport async function balanceResponseFromSatoshi(value, priceCache = true) {\n    const response = {};\n    response.bch = value / bchParam.subUnits;\n    response.sat = value;\n    const currencyValue = (value / bchParam.subUnits) *\n        (await ExchangeRate.get(Config.DefaultCurrency, priceCache));\n    response[Config.DefaultCurrency] = floor(currencyValue, 2);\n    return response;\n}\nexport async function balanceFromSatoshi(value, rawUnit, priceCache = true) {\n    const unit = sanitizeUnit(rawUnit);\n    switch (unit) {\n        case UnitEnum.BCH:\n            return value / bchParam.subUnits;\n        case UnitEnum.SAT:\n            return value;\n        case UnitEnum.SATS:\n            return value;\n        case UnitEnum.SATOSHI:\n            return value;\n        case UnitEnum.SATOSHIS:\n            return value;\n        default:\n            const currencyValue = (value / bchParam.subUnits) *\n                (await ExchangeRate.get(Config.DefaultCurrency, priceCache));\n            return Number(currencyValue.toFixed(2));\n    }\n}\n//# sourceMappingURL=balanceObjectFromSatoshi.js.map","export const ELECTRUM_CASH_PROTOCOL_VERSION = \"1.5\";\nexport const networkTickerMap = {\n    mainnet: \"BCH\",\n    testnet: \"tBCH\",\n    regtest: \"rBCH\",\n};\nexport const mainnetServers = [\n    \"wss://bch.imaginary.cash:50004\",\n    //\"wss://blackie.c3-soft.com:50004\",\n    // \"wss://electrum.imaginary.cash:50004\",\n    // \"wss://fulcrum.fountainhead.cash\",\n];\n// export const testnetServers = [\n//   // \"wss://tbch.loping.net:60004\",\n//   \"wss://blackie.c3-soft.com:60004\",\n//   // \"wss://testnet.bitcoincash.network:60004\",\n//   //,\"wss://unavailable.invalid:50004\"\n// ];\n// testnet4\n// export const testnetServers = [\n//   //\"wss://t4fork.c3-soft.com:61004\",\n//   \"wss://testnet4.imaginary.cash:50004\",\n//   //,\"wss://unavailable.invalid:50004\"\n// ];\n// chipnet\nexport const testnetServers = [\n    // \"wss://chipnet.imaginary.cash:50004\",\n    //\"wss://blackie.c3-soft.com:64004\", // chipnet with protocol 1.5.0\n    \"wss://chipnet.bch.ninja:50004\",\n];\nexport const regtestServers = [\"ws://127.0.0.1:60003\"];\nexport const defaultServers = {\n    mainnet: mainnetServers,\n    testnet: testnetServers,\n    regtest: regtestServers,\n};\n//# sourceMappingURL=constant.js.map","import { getRuntimePlatform } from \"../util/index.js\";\nimport * as primary from \"./constant.js\";\nlet mainnetServers, testnetServers, regtestServers;\nexport class DefaultProvider {\n    static { this.servers = {\n        mainnet: [],\n        testnet: [],\n        regtest: [],\n    }; }\n}\nexport function getDefaultServers(network) {\n    let env;\n    if (getRuntimePlatform() == \"node\") {\n        env = process.env;\n    }\n    else {\n        env = {};\n    }\n    mainnetServers = DefaultProvider.servers.mainnet.length\n        ? DefaultProvider.servers.mainnet\n        : env.ELECTRUM\n            ? env.ELECTRUM.split(\",\")\n            : primary.mainnetServers;\n    testnetServers = DefaultProvider.servers.testnet.length\n        ? DefaultProvider.servers.testnet\n        : env.ELECTRUM_TESTNET\n            ? env.ELECTRUM_TESTNET.split(\",\")\n            : primary.testnetServers;\n    regtestServers = DefaultProvider.servers.regtest.length\n        ? DefaultProvider.servers.regtest\n        : env.ELECTRUM_REGTEST\n            ? env.ELECTRUM_REGTEST.split(\",\")\n            : primary.regtestServers;\n    return {\n        mainnet: mainnetServers,\n        testnet: testnetServers,\n        regtest: regtestServers,\n    }[network];\n}\nexport function getUserAgent() {\n    // Allow users to configure the cluster confidence\n    let ua;\n    if (getRuntimePlatform() === \"node\") {\n        ua = process.env.ELECTRUM_USER_AGENT\n            ? process.env.ELECTRUM_USER_AGENT\n            : \"mainnet-js-\" + getRuntimePlatform();\n    }\n    else {\n        ua = \"mainnet-js-\" + getRuntimePlatform();\n    }\n    return ua;\n}\nexport function getConfidence() {\n    // Allow users to configure the cluster confidence\n    let confidence;\n    if (getRuntimePlatform() === \"node\") {\n        confidence = process.env.ELECTRUM_CONFIDENCE\n            ? parseInt(process.env.ELECTRUM_CONFIDENCE)\n            : 1;\n    }\n    else {\n        confidence = 1;\n    }\n    return confidence;\n}\n//# sourceMappingURL=configuration.js.map","export function parseElectrumUrl(givenUrl) {\n    let url = new URL(givenUrl);\n    let port = parseInt(url.port || \"443\");\n    let scheme = getElectrumScheme(url.protocol);\n    return { host: url.hostname, port: port, scheme: scheme };\n}\nfunction getElectrumScheme(protocol) {\n    let transport;\n    switch (protocol) {\n        case \"http:\":\n            transport = \"tcp\";\n            break;\n        case \"https:\":\n            transport = \"tcp_tls\";\n            break;\n        case \"ws:\":\n            transport = \"ws\";\n            break;\n        case \"wss:\":\n            transport = \"wss\";\n            break;\n        default:\n            throw Error(\"Electrum transport protocol not understood.\");\n    }\n    return transport;\n}\n//# sourceMappingURL=util.js.map","import { default as ElectrumNetworkProvider } from \"./ElectrumNetworkProvider.js\";\nimport { ElectrumClient } from \"@electrum-cash/network\";\nimport { ElectrumWebSocket } from \"@electrum-cash/web-socket\";\nimport { getDefaultServers, getUserAgent } from \"./configuration.js\";\nimport { parseElectrumUrl } from \"./util.js\";\nimport { Network } from \"../interface.js\";\nimport { networkTickerMap, ELECTRUM_CASH_PROTOCOL_VERSION, } from \"./constant.js\";\nexport function setGlobalProvider(network, provider) {\n    const accessor = networkTickerMap[network];\n    globalThis[accessor] = provider;\n    return provider;\n}\nexport function getGlobalProvider(network) {\n    const accessor = networkTickerMap[network];\n    return globalThis[accessor];\n}\nexport function removeGlobalProvider(network) {\n    const accessor = networkTickerMap[network];\n    if (accessor in globalThis) {\n        delete globalThis[accessor];\n    }\n}\nexport function getNetworkProvider(network = Network.MAINNET, servers, manualConnectionManagement, options) {\n    const globalContext = servers === undefined &&\n        manualConnectionManagement === undefined &&\n        options === undefined;\n    if (globalContext) {\n        const globalProvider = getGlobalProvider(network);\n        if (globalProvider) {\n            return globalProvider;\n        }\n    }\n    manualConnectionManagement = manualConnectionManagement\n        ? manualConnectionManagement\n        : false;\n    servers = servers ? servers : getDefaultServers(network);\n    // If the user has passed a single string, assume a single client connection\n    if (typeof servers === \"string\") {\n        servers = [servers];\n    }\n    // There were server(s)\n    if (servers) {\n        const client = getClient(servers[0], network, options);\n        let provider = new ElectrumNetworkProvider(client, network, manualConnectionManagement);\n        if (globalContext) {\n            return setGlobalProvider(network, provider);\n        }\n        return provider;\n    }\n    else {\n        throw Error(\"No servers provided, defaults not available.\");\n    }\n}\n// create a client with a server\nfunction getClient(server, network, options) {\n    let url = parseElectrumUrl(server);\n    return getElectrumClient(url, options?.timeout ?? 120000, network);\n}\nfunction getElectrumClient(params, timeout, network) {\n    if (params.scheme?.includes(\"tcp\")) {\n        throw Error(\"TCP connections are not supported.\");\n    }\n    const webSocket = new ElectrumWebSocket(params.host, params.port, params.scheme === \"wss\", timeout);\n    return new ElectrumClient(getUserAgent(), ELECTRUM_CASH_PROTOCOL_VERSION, webSocket, {\n        disableBrowserConnectivityHandling: true,\n        disableBrowserVisibilityHandling: true,\n    });\n}\n//# sourceMappingURL=default.js.map","import { getNetworkProvider, setGlobalProvider, getGlobalProvider, removeGlobalProvider, } from \"./default.js\";\nimport { networkTickerMap } from \"./constant.js\";\nimport { prefixFromNetworkMap } from \"../enum.js\";\nexport async function initProvider(network) {\n    if (!getGlobalProvider(network)) {\n        const conn = new Connection(network);\n        const provider = (await conn.ready()).networkProvider;\n        setGlobalProvider(network, provider);\n        return provider;\n    }\n    return getGlobalProvider(network);\n}\nexport async function initProviders(networks) {\n    networks = networks ? networks : Object.keys(networkTickerMap);\n    let initPromises = networks.map((n) => initProvider(n));\n    await Promise.all(initPromises).catch((e) => {\n        console.warn(`Warning, couldn't establish a connection for ${e}`);\n    });\n}\nasync function disconnectProvider(network) {\n    const provider = getGlobalProvider(network);\n    if (provider) {\n        await provider.disconnect();\n        removeGlobalProvider(network);\n        return;\n    }\n    else {\n        // console.warn(\n        //   `Ignoring attempt to disconnect non-existent ${network} provider`\n        // );\n        return true;\n    }\n}\nexport async function disconnectProviders(networks) {\n    networks = networks ? networks : Object.keys(networkTickerMap);\n    let disconnectPromises = networks.map((n) => disconnectProvider(n));\n    await Promise.all(disconnectPromises);\n}\nexport class Connection {\n    constructor(network, servers) {\n        this.network = network ? network : \"mainnet\";\n        this.networkPrefix = prefixFromNetworkMap[this.network];\n        this.networkProvider = getNetworkProvider(this.network, servers, true);\n    }\n    async ready() {\n        await this.networkProvider.connect();\n        await this.networkProvider.ready();\n        return this;\n    }\n    async disconnect() {\n        await this.networkProvider.disconnect();\n        return this;\n    }\n}\n//# sourceMappingURL=Connection.js.map","import { binToHex, binToUtf8, decodeTransaction, hexToBin, sha256, utf8ToBin, } from \"@bitauth/libauth\";\nimport { Network } from \"../interface.js\";\nimport { initProvider } from \"../network/Connection.js\";\nimport { OpReturnData } from \"./model.js\";\nimport { Config } from \"../config.js\";\n// Implementation of CHIP-BCMR v2.0.0-draft, refer to https://github.com/bitjson/chip-bcmr\nexport class BCMR {\n    // List of tracked registries\n    static { this.metadataRegistries = []; }\n    static getRegistries() {\n        return this.metadataRegistries;\n    }\n    static resetRegistries() {\n        this.metadataRegistries = [];\n    }\n    /**\n     * fetchMetadataRegistry Fetch the BCMR registry JSON file from a remote URI, optionally verifying its content hash\n     *\n     * @param  {string} uri URI of the registry to fetch from\n     * @param  {string?} contentHash SHA256 hash of the resource the `uri` parameter points at.\n     * If specified, calculates the hash of the data fetched from `uri` and matches it with provided one.\n     * Yields an error upon mismatch.\n     *\n     * @returns {Registry} resolved registry\n     */\n    static async fetchMetadataRegistry(uri, contentHash) {\n        if (uri.indexOf(\"https://\") < 0) {\n            uri = `https://${uri}`;\n        }\n        // content hashes HTTPS Publication Outputs per spec\n        if (contentHash) {\n            // request as text and verify hash\n            const response = await fetch(uri);\n            const data = await response.text();\n            const hash = binToHex(sha256.hash(utf8ToBin(data)));\n            if (contentHash != hash) {\n                throw new Error(`Content hash mismatch for URI: ${uri}\\nreceived: ${hash}\\nrequired: ${contentHash}`);\n            }\n            return JSON.parse(data);\n        }\n        // request as JSON\n        const response = await fetch(uri);\n        const data = await response.json();\n        return data;\n    }\n    /**\n     * addMetadataRegistry Add the metadata registry to the list of tracked registries\n     *\n     * @param  {Registry} registry Registry object per schema specification, see https://raw.githubusercontent.com/bitjson/chip-bcmr/master/bcmr-v1.schema.json\n     *\n     */\n    static addMetadataRegistry(registry) {\n        if (this.metadataRegistries.some((val) => JSON.stringify(val) === JSON.stringify(registry))) {\n            return;\n        }\n        this.metadataRegistries.push(registry);\n    }\n    /**\n     * addMetadataRegistryFromUri Add the metadata registry by fetching a JSON file from a remote URI, optionally verifying its content hash\n     *\n     * @param  {string} uri URI of the registry to fetch from\n     * @param  {string?} contentHash SHA256 hash of the resource the `uri` parameter points at.\n     * If specified, calculates the hash of the data fetched from `uri` and matches it with provided one.\n     * Yields an error upon mismatch.\n     *\n     */\n    static async addMetadataRegistryFromUri(uri, contentHash) {\n        const registry = await this.fetchMetadataRegistry(uri, contentHash);\n        this.addMetadataRegistry(registry);\n    }\n    // helper function to enforce the constraints on the 0th output, decode the BCMR's OP_RETURN data\n    // returns resolved AuthChainElement\n    static makeAuthChainElement(rawTx, hash) {\n        let opReturns;\n        let spends0thOutput = false;\n        if (rawTx.hasOwnProperty(\"vout\")) {\n            const electrumTransaction = rawTx;\n            opReturns = electrumTransaction.vout\n                .filter((val) => val.scriptPubKey.type === \"nulldata\")\n                .map((val) => val.scriptPubKey.hex);\n            spends0thOutput = electrumTransaction.vin.some((val) => val.vout === 0);\n        }\n        else {\n            const libauthTransaction = rawTx;\n            opReturns = libauthTransaction.outputs\n                .map((val) => binToHex(val.lockingBytecode))\n                .filter((val) => val.indexOf(\"6a\") === 0);\n            spends0thOutput = libauthTransaction.inputs.some((val) => val.outpointIndex === 0);\n        }\n        if (!spends0thOutput) {\n            throw new Error(\"Invalid authchain transaction (does not spend 0th output of previous transaction)\");\n        }\n        const bcmrOpReturns = opReturns.filter((val) => val.indexOf(\"6a0442434d52\") === 0 ||\n            val.indexOf(\"6a4c0442434d52\") === 0 ||\n            val.indexOf(\"6a4d040042434d52\") === 0 ||\n            val.indexOf(\"6a4e0400000042434d52\") === 0);\n        if (bcmrOpReturns.length === 0) {\n            return {\n                txHash: hash,\n                contentHash: \"\",\n                uris: [],\n                httpsUrl: \"\",\n            };\n        }\n        const opReturnHex = opReturns[0];\n        const chunks = OpReturnData.parseBinary(hexToBin(opReturnHex));\n        if (chunks.length < 2) {\n            throw new Error(`Malformed BCMR output: ${opReturnHex}`);\n        }\n        const result = {\n            txHash: hash,\n            contentHash: \"\",\n            uris: [],\n            httpsUrl: \"\",\n        };\n        if (chunks.length === 2) {\n            // IPFS Publication Output\n            result.contentHash = binToHex(chunks[1]);\n            const ipfsCid = binToUtf8(chunks[1]);\n            result.uris = [`ipfs://${ipfsCid}`];\n            result.httpsUrl = `${Config.DefaultIpfsGateway}${ipfsCid}`;\n        }\n        else {\n            // URI Publication Output\n            // content hash is in OP_SHA256 byte order per spec\n            result.contentHash = binToHex(chunks[1].slice());\n            const uris = chunks.slice(2);\n            for (const uri of uris) {\n                const uriString = binToUtf8(uri);\n                result.uris.push(uriString);\n                if (result.httpsUrl) {\n                    continue;\n                }\n                if (uriString.indexOf(\"ipfs://\") === 0) {\n                    const ipfsCid = uriString.replace(\"ipfs://\", \"\");\n                    result.httpsUrl = `${Config.DefaultIpfsGateway}${ipfsCid}`;\n                }\n                else if (uriString.indexOf(\"https://\") === 0) {\n                    result.httpsUrl = uriString;\n                }\n                else if (uriString.indexOf(\"https://\") === -1) {\n                    result.httpsUrl = uriString;\n                    // case for domain name specifier, like example.com\n                    if (uriString.indexOf(\"/\") === -1) {\n                        const parts = uriString.toLowerCase().split(\".\");\n                        if (!(parts?.[0]?.indexOf(\"baf\") === 0 && parts?.[1] === \"ipfs\")) {\n                            result.httpsUrl = `${result.httpsUrl}/.well-known/bitcoin-cash-metadata-registry.json`;\n                        }\n                    }\n                    result.httpsUrl = `https://${result.httpsUrl}`;\n                }\n                else {\n                    throw new Error(`Unsupported uri type: ${uriString}`);\n                }\n            }\n        }\n        return result;\n    }\n    /**\n     * buildAuthChain Build an authchain - Zeroth-Descendant Transaction Chain, refer to https://github.com/bitjson/chip-bcmr#zeroth-descendant-transaction-chains\n     * The authchain in this implementation is specific to resolve to a valid metadata registry\n     *\n     * @param  {string} options.transactionHash (required) transaction hash from which to build the auth chain\n     * @param  {Network?} options.network (default=mainnet) network to query the data from\n     * @param  {boolean?} options.resolveBase (default=false) boolean flag to indicate that autchain building should resolve and verify elements back to base or be stopped at this exact chain element\n     * @param  {boolean?} options.followToHead (default=true) boolean flag to indicate that autchain building should progress to head or be stopped at this exact chain element\n     * @param  {ElectrumRawTransaction?} options.rawTx cached raw transaction obtained previously, spares a Fulcrum call\n     * @param  {TxI[]?} options.historyCache cached address history to be reused if authchain building proceeds with the same address, spares a flurry of Fulcrum calls\n     *\n     * @returns {AuthChain} returns the resolved authchain\n     */\n    static async buildAuthChain(options) {\n        if (options.network === undefined) {\n            options.network = Network.MAINNET;\n        }\n        if (options.followToHead === undefined) {\n            options.followToHead = true;\n        }\n        if (options.resolveBase === undefined) {\n            options.resolveBase = false;\n        }\n        const provider = (await initProvider(options.network));\n        if (options.rawTx === undefined) {\n            options.rawTx = await provider.getRawTransactionObject(options.transactionHash);\n        }\n        // figure out the autchain by moving towards authhead\n        const getAuthChainChild = async () => {\n            const history = options.historyCache ||\n                (await provider.getHistory(options.rawTx.vout[0].scriptPubKey.addresses[0]));\n            const thisTx = history.find((val) => val.tx_hash === options.transactionHash);\n            let filteredHistory = history.filter((val) => val.height > 0\n                ? val.height >= thisTx.height || val.height <= 0\n                : val.height <= 0 && val.tx_hash !== thisTx.tx_hash);\n            for (const historyTx of filteredHistory) {\n                const historyRawTx = await provider.getRawTransactionObject(historyTx.tx_hash);\n                const authChainVin = historyRawTx.vin.find((val) => val.txid === options.transactionHash && val.vout === 0);\n                // if we've found continuation of authchain, we shall recurse into it\n                if (authChainVin) {\n                    // reuse queried address history if the next element in chain is the same address\n                    const historyCache = options.rawTx.vout[0].scriptPubKey.addresses[0] ===\n                        historyRawTx.vout[0].scriptPubKey.addresses[0]\n                        ? filteredHistory\n                        : undefined;\n                    // combine the authchain element with the rest obtained\n                    return { rawTx: historyRawTx, historyCache };\n                }\n            }\n            return undefined;\n        };\n        // make authchain element and combine with the rest obtained\n        let element;\n        try {\n            element = BCMR.makeAuthChainElement(options.rawTx, options.rawTx.hash);\n        }\n        catch (error) {\n            // special case for cashtoken authchain lookup by categoryId - allow to fail first lookup and inspect the genesis transaction\n            // follow authchain to head and look for BCMR outputs\n            const child = await getAuthChainChild();\n            if (child) {\n                return await BCMR.buildAuthChain({\n                    ...options,\n                    transactionHash: child.rawTx.hash,\n                    rawTx: child.rawTx,\n                    historyCache: child.historyCache,\n                });\n            }\n            else {\n                throw error;\n            }\n        }\n        let chainBase = [];\n        if (options.resolveBase) {\n            // check for accelerated path if \"authchain\" extension is in registry\n            const registry = await this.fetchMetadataRegistry(element.httpsUrl, element.contentHash);\n            if (registry.extensions &&\n                registry.extensions[\"authchain\"] &&\n                Object.keys(registry.extensions[\"authchain\"]).length) {\n                const chainTxArray = Object.values(registry.extensions[\"authchain\"]);\n                chainBase = chainTxArray\n                    .map((tx) => {\n                    const transactionBin = hexToBin(tx);\n                    const decoded = decodeTransaction(transactionBin);\n                    if (typeof decoded === \"string\") {\n                        throw new Error(`Error decoding transaction ${JSON.stringify(tx)}, ${decoded}`);\n                    }\n                    const hash = binToHex(sha256.hash(sha256.hash(transactionBin)).reverse());\n                    return { decoded, hash };\n                })\n                    .map(({ decoded, hash }) => BCMR.makeAuthChainElement(decoded, hash));\n            }\n            else {\n                // simply go back in history towards authhead\n                let stop = false;\n                let tx = { ...options.rawTx };\n                let maxElements = 10;\n                while (stop == false || maxElements === 0) {\n                    const vin = tx.vin.find((val) => val.vout === 0);\n                    tx = await provider.getRawTransactionObject(vin.txid);\n                    try {\n                        const pastElement = BCMR.makeAuthChainElement(tx, tx.hash);\n                        chainBase.unshift(pastElement);\n                        maxElements--;\n                    }\n                    catch {\n                        stop = true;\n                    }\n                }\n            }\n        }\n        // if we follow to head, we need to locate the next transaction spending our 0th output\n        // and repeat the building process recursively\n        if (options.followToHead) {\n            const child = await getAuthChainChild();\n            if (child) {\n                const chainHead = await BCMR.buildAuthChain({\n                    transactionHash: child.rawTx.hash,\n                    network: options.network,\n                    rawTx: child.rawTx,\n                    historyCache: child.historyCache,\n                    followToHead: options.followToHead,\n                    resolveBase: false,\n                });\n                // combine the authchain element with the rest obtained\n                return [...chainBase, element, ...chainHead].filter((val) => val.httpsUrl.length);\n            }\n        }\n        // return the last chain element (or the only found in an edge case)\n        return [...chainBase, element].filter((val) => val.httpsUrl.length);\n    }\n    /**\n     * fetchAuthChainFromChaingraph Fetch the authchain information from a trusted external indexer\n     * The authchain in this implementation is specific to resolve to a valid metadata registry\n     *\n     * @param  {string} options.chaingraphUrl (required) URL of a chaingraph indexer instance to fetch info from\n     * @param  {string} options.transactionHash (required) transaction hash from which to build the auth chain\n     * @param  {string?} options.network (default=undefined) network to query the data from, specific to the queried instance,\n     *  can be 'mainnet', 'chipnet', or anything else.\n     *  if left undefined all chaingraph transactions will be looked at, disregarding the chain\n     *\n     * @returns {AuthChain} returns the resolved authchain\n     */\n    static async fetchAuthChainFromChaingraph(options) {\n        if (!options.chaingraphUrl) {\n            throw new Error(\"Provide `chaingraphUrl` param.\");\n        }\n        const response = await fetch(options.chaingraphUrl, {\n            method: \"POST\",\n            headers: {\n                Accept: \"*/*\",\n                \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({\n                operationName: null,\n                variables: {},\n                query: `\n{\n  transaction(\n    where: {\n      hash:{_eq:\"\\\\\\\\x${options.transactionHash}\"}\n    }\n  ) {\n    hash\n    authchains {\n      authchain_length\n      migrations(\n        where: {\n          transaction: {\n            outputs: { locking_bytecode_pattern: { _like: \"6a04%\" } }\n          }\n        }\n      ) {\n        transaction {\n          hash\n          inputs(where:{ outpoint_index: { _eq:\"0\" } }){\n            outpoint_index\n          }\n          outputs(where: { locking_bytecode_pattern: { _like: \"6a04%\" } }) {\n            output_index\n            locking_bytecode\n          }\n        }\n      }\n    }\n  }\n}`,\n            }),\n        });\n        const responseData = await response.json();\n        const result = [];\n        const migrations = responseData.data.transaction[0]?.authchains[0].migrations;\n        if (!migrations) {\n            return result;\n        }\n        for (const migration of migrations) {\n            const transaction = migration.transaction[0];\n            if (!transaction) {\n                continue;\n            }\n            transaction.inputs.forEach((input) => (input.outpointIndex = Number(input.outpoint_index)));\n            transaction.outputs.forEach((output) => {\n                output.outputIndex = Number(output.output_index);\n                output.lockingBytecode = hexToBin(output.locking_bytecode.replace(\"\\\\x\", \"\"));\n            });\n            const txHash = transaction.hash.replace(\"\\\\x\", \"\");\n            result.push(BCMR.makeAuthChainElement(transaction, txHash));\n        }\n        return result.filter((element) => element.contentHash.length && element.httpsUrl.length);\n    }\n    /**\n     * addMetadataRegistryAuthChain Add BCMR metadata registry by resolving an authchain\n     *\n     * @param  {string} options.transactionHash (required) transaction hash from which to build the auth chain\n     * @param  {Network?} options.network (default=mainnet) network to query the data from\n     * @param  {boolean?} options.followToHead (default=true) boolean flag to indicate that autchain building should progress to head (most recent registry version) or be stopped at this exact chain element\n     * @param  {ElectrumRawTransaction?} options.rawTx cached raw transaction obtained previously, spares a Fulcrum call\n     *\n     * @returns {AuthChain} returns the resolved authchain\n     */\n    static async addMetadataRegistryAuthChain(options) {\n        const authChain = await this.buildAuthChain({\n            ...options,\n            resolveBase: false,\n        });\n        if (!authChain.length) {\n            throw new Error(`There were no BCMR entries in the resolved authchain ${JSON.stringify(authChain, null, 2)}`);\n        }\n        const registry = await this.fetchMetadataRegistry(authChain.reverse()[0].httpsUrl);\n        this.addMetadataRegistry(registry);\n        return authChain;\n    }\n    /**\n     * getTokenInfo Return the token info (or the identity snapshot as per spec)\n     *\n     * @param  {string} tokenId token id to look up\n     *\n     * @returns {IdentitySnapshot?} return the info for the token found, otherwise undefined\n     */\n    static getTokenInfo(tokenId) {\n        for (const registry of this.metadataRegistries.slice().reverse()) {\n            const history = registry.identities?.[tokenId];\n            if (!history) {\n                continue;\n            }\n            const latestIdentityIndex = Object.keys(history)[0];\n            if (latestIdentityIndex === undefined) {\n                continue;\n            }\n            return history[latestIdentityIndex];\n        }\n        return undefined;\n    }\n}\n//# sourceMappingURL=Bcmr.js.map","import { base64ToBin, binToBase64, CashAddressType, encodeCashAddress, hexToBin, instantiateSecp256k1, instantiateSha256, utf8ToBin, } from \"@bitauth/libauth\";\nimport { derivePrefix } from \"../util/derivePublicKeyHash.js\";\nimport { hash160 } from \"../util/hash160.js\";\n/**\n * message_magic - Add \"Magic\", per standard bitcoin message signing.\n *\n * In this case, the magic is simply adding the number 24 as binary \"\\x16\", and \"Bitcoin Signed Message\\n\" followed\n * by the size of the message in binary followed by the message encoded as binary.\n *\n * @param {str} string    The string to add the magic syntax to.\n *\n * @returns a promise to the string as binary array with magic syntax\n */\n// see    https://github.com/Electron-Cash/Electron-Cash/blob/49f9f672364f50053a026e4a5cb30e92db2d195d/electroncash/bitcoin.py#L524\nfunction message_magic(str) {\n    const length = utf8ToBin(str).length.toString(16);\n    let payload = `\\x18Bitcoin Signed Message:\\n`;\n    return new Uint8Array([\n        ...utf8ToBin(payload),\n        ...hexToBin(length),\n        ...utf8ToBin(str),\n    ]);\n}\n/**\n * hash_magic - Return the hash of the string that has undergone standard formatting\n *\n * @param {str} string    The string to hash\n *\n * @returns a promise to the hash of the string.\n */\nexport async function hash_message(str) {\n    const h = (await instantiateSha256()).hash;\n    return h(h(message_magic(str)));\n}\nexport class SignedMessage {\n    /**\n     * sign - Calculate the recoverable signed checksum of a string message.\n     *\n     * @param {message} string          The\n     * @param {privateKey} Uint8Array   The private key to sign the message with\n     *\n     * @returns a promise to signature as a string\n     */\n    async sign(message, privateKey) {\n        const secp256k1 = await instantiateSecp256k1();\n        let messageHash = await hash_message(message);\n        let rs = secp256k1.signMessageHashRecoverableCompact(privateKey, messageHash);\n        if (typeof rs === \"string\") {\n            throw new Error(rs);\n        }\n        let sigDer = secp256k1.signMessageHashDER(privateKey, messageHash);\n        let sigSchnorr = secp256k1.signMessageHashSchnorr(privateKey, messageHash);\n        let electronEncoding = new Uint8Array([\n            ...[31 + rs.recoveryId],\n            ...rs.signature,\n        ]);\n        return {\n            raw: {\n                ecdsa: binToBase64(rs.signature),\n                schnorr: binToBase64(sigSchnorr),\n                der: binToBase64(sigDer),\n            },\n            details: {\n                recoveryId: rs.recoveryId,\n                compressed: true,\n                messageHash: binToBase64(messageHash),\n            },\n            signature: binToBase64(electronEncoding),\n        };\n    }\n    static async sign(message, privateKey) {\n        return new this().sign(message, privateKey);\n    }\n    /**\n     * verify - Validate that the message is valid against a given signature\n     *\n     * @param {message} string     The message to verify as a utf8 string\n     * @param {signature} string   The signature as a base64 encoded string\n     * @param {cashaddr} string    The cashaddr to validate the signature against a recoverable signature.\n     * @param {publicKey} string    If publicKey is not recoverable from the signature type, the publicKey must be passed.\n     *\n     * @returns a promise to signature as a string\n     */\n    async verify(message, signature, cashaddr, publicKey) {\n        // Check that the signature is valid for the given message.\n        const secp256k1 = await instantiateSecp256k1();\n        let messageHash = await hash_message(message);\n        let sig = base64ToBin(signature);\n        let signatureValid = false;\n        let keyMatch = false;\n        let pkhMatch = false;\n        let pkh, signatureType;\n        if (sig.length === 65) {\n            let rawSig = sig.length === 65 ? sig.slice(1) : sig;\n            let recoveryId = sig.slice(0, 1)[0] - 31;\n            let recoveredPk = secp256k1.recoverPublicKeyCompressed(rawSig, recoveryId, messageHash);\n            if (typeof recoveredPk === \"string\") {\n                throw new Error(recoveredPk);\n            }\n            pkh = await hash160(recoveredPk);\n            signatureType = \"recoverable\";\n            signatureValid = secp256k1.verifySignatureCompact(rawSig, recoveredPk, messageHash);\n            if (cashaddr) {\n                // Validate that the signature actually matches the provided cashaddr\n                let prefix = derivePrefix(cashaddr);\n                let resultingCashaddr = encodeCashAddress({\n                    prefix,\n                    type: CashAddressType.p2pkh,\n                    payload: pkh,\n                }).address;\n                if (resultingCashaddr === cashaddr) {\n                    pkhMatch = true;\n                }\n            }\n        }\n        else if (publicKey) {\n            if (secp256k1.verifySignatureDER(sig, publicKey, messageHash)) {\n                signatureType = \"der\";\n                signatureValid = true;\n                keyMatch = true;\n            }\n            else if (secp256k1.verifySignatureSchnorr(sig, publicKey, messageHash)) {\n                signatureType = \"schnorr\";\n                signatureValid = true;\n                keyMatch = true;\n            }\n            else if (secp256k1.verifySignatureCompact(sig, publicKey, messageHash)) {\n                signatureType = \"ecdsa\";\n                signatureValid = true;\n                keyMatch = true;\n            }\n            else {\n                signatureType = \"na\";\n            }\n        }\n        return {\n            valid: signatureValid && (keyMatch || pkhMatch),\n            details: {\n                signatureValid: signatureValid,\n                signatureType: signatureType,\n                messageHash: binToBase64(messageHash),\n                publicKeyHashMatch: pkhMatch,\n                publicKeyMatch: keyMatch,\n            },\n        };\n    }\n    static async verify(message, signature, cashaddr, publicKey) {\n        return new this().verify(message, signature, cashaddr, publicKey);\n    }\n}\n//# sourceMappingURL=signed.js.map","import { binToHex, decodeTransaction, hexToBin, lockingBytecodeToCashAddress, decodeCashAddress, assertSuccess, Opcodes, } from \"@bitauth/libauth\";\nimport { convert } from \"../util/convert.js\";\nexport const getAddressHistory = async ({ address, provider, unit = \"sat\", fromHeight = 0, toHeight = -1, start = 0, count = -1, }) => {\n    if (count === -1) {\n        count = 1e10;\n    }\n    const history = (await provider.getHistory(address, fromHeight, toHeight))\n        .sort((a, b) => a.height <= 0 || b.height <= 0 ? a.height - b.height : b.height - a.height)\n        .slice(start, start + count);\n    // fill transaction timestamps by requesting headers from network and parsing them\n    const heights = history\n        .map((tx) => tx.height)\n        .filter((height) => height > 0)\n        .filter((value, index, array) => array.indexOf(value) === index);\n    const timestampMap = (await Promise.all(heights.map(async (height) => [\n        height,\n        (await provider.getHeader(height, true)).timestamp,\n    ]))).reduce((acc, [height, timestamp]) => ({ ...acc, [height]: timestamp }), {});\n    // first load all transactions\n    const historicTransactions = await Promise.all(history.map(async (tx) => {\n        const txHex = (await provider.getRawTransaction(tx.tx_hash));\n        const transactionCommon = decodeTransaction(hexToBin(txHex));\n        if (typeof transactionCommon === \"string\") {\n            throw transactionCommon;\n        }\n        const transaction = transactionCommon;\n        transaction.blockHeight = tx.height;\n        transaction.timestamp = timestampMap[tx.height];\n        transaction.hash = tx.tx_hash;\n        transaction.size = txHex.length / 2;\n        return transaction;\n    }));\n    // then load their prevout transactions\n    const prevoutTransactionHashes = historicTransactions\n        .map((tx) => tx.inputs.map((input) => binToHex(input.outpointTransactionHash)))\n        .flat()\n        .filter((value, index, array) => array.indexOf(value) === index);\n    const prevoutTransactionMap = (await Promise.all(prevoutTransactionHashes.map(async (hash) => {\n        const txHex = (await provider.getRawTransaction(hash));\n        const transaction = decodeTransaction(hexToBin(txHex));\n        if (typeof transaction === \"string\") {\n            throw transaction;\n        }\n        return [hash, transaction];\n    }))).reduce((acc, [hash, transaction]) => ({\n        ...acc,\n        [hash]: transaction,\n    }), {});\n    const decoded = decodeCashAddress(address);\n    if (typeof decoded === \"string\") {\n        throw decoded;\n    }\n    const addressCache = {};\n    // map decoded transaction data to TransactionHistoryItem\n    const historyItems = historicTransactions.map((tx) => {\n        const result = {};\n        let inputTotalValue = 0n;\n        let outputTotalValue = 0n;\n        result.inputs = tx.inputs.map((input) => {\n            const prevoutTx = prevoutTransactionMap[binToHex(input.outpointTransactionHash)];\n            if (!prevoutTx) {\n                throw new Error(\"Could not find prevout transaction\");\n            }\n            const prevoutOutput = prevoutTx.outputs[input.outpointIndex];\n            if (!prevoutOutput) {\n                throw new Error(\"Could not find prevout output\");\n            }\n            const cached = addressCache[prevoutOutput.lockingBytecode];\n            let address;\n            if (!cached) {\n                address = assertSuccess(lockingBytecodeToCashAddress({\n                    bytecode: prevoutOutput.lockingBytecode,\n                    prefix: decoded.prefix,\n                })).address;\n                addressCache[prevoutOutput.lockingBytecode] = address;\n            }\n            else {\n                address = cached;\n            }\n            inputTotalValue += prevoutOutput.valueSatoshis;\n            return {\n                address: address,\n                value: Number(prevoutOutput.valueSatoshis),\n                token: prevoutOutput.token\n                    ? {\n                        tokenId: binToHex(prevoutOutput.token.category),\n                        amount: prevoutOutput.token.amount,\n                        capability: prevoutOutput.token.nft?.capability\n                            ? prevoutOutput.token.nft.capability\n                            : undefined,\n                        commitment: prevoutOutput.token.nft?.capability\n                            ? binToHex(prevoutOutput.token.nft.commitment)\n                            : undefined,\n                    }\n                    : undefined,\n            };\n        });\n        result.outputs = tx.outputs.map((output) => {\n            const cached = addressCache[output.lockingBytecode];\n            let address;\n            if (!cached) {\n                if (output.lockingBytecode[0] === Opcodes.OP_RETURN) {\n                    address = `OP_RETURN: ${binToHex(output.lockingBytecode)}`;\n                }\n                else {\n                    address = assertSuccess(lockingBytecodeToCashAddress({\n                        bytecode: output.lockingBytecode,\n                        prefix: decoded.prefix,\n                    })).address;\n                    addressCache[output.lockingBytecode] = address;\n                }\n            }\n            else {\n                address = cached;\n            }\n            outputTotalValue += output.valueSatoshis;\n            return {\n                address: address,\n                value: Number(output.valueSatoshis),\n                token: output.token\n                    ? {\n                        tokenId: binToHex(output.token.category),\n                        amount: output.token.amount,\n                        capability: output.token.nft?.capability\n                            ? output.token.nft.capability\n                            : undefined,\n                        commitment: output.token.nft?.capability\n                            ? binToHex(output.token.nft.commitment)\n                            : undefined,\n                    }\n                    : undefined,\n            };\n        });\n        result.blockHeight = tx.blockHeight;\n        result.timestamp = tx.timestamp;\n        result.hash = tx.hash;\n        result.size = tx.size;\n        result.fee = Number(inputTotalValue - outputTotalValue);\n        return result;\n    });\n    // compute value changes\n    historyItems.forEach((tx) => {\n        let satoshiBalance = 0;\n        const ftTokenBalances = {};\n        const nftTokenBalances = {};\n        tx.inputs.forEach((input) => {\n            if (input.address === address) {\n                satoshiBalance -= input.value;\n                if (input.token?.amount) {\n                    ftTokenBalances[input.token.tokenId] =\n                        (ftTokenBalances[input.token.tokenId] || BigInt(0)) -\n                            input.token.amount;\n                }\n                if (input.token?.capability) {\n                    nftTokenBalances[input.token.tokenId] =\n                        (nftTokenBalances[input.token.tokenId] || BigInt(0)) - 1n;\n                }\n            }\n        });\n        tx.outputs.forEach((output) => {\n            if (output.address === address) {\n                satoshiBalance += Number(output.value);\n                if (output.token?.amount) {\n                    ftTokenBalances[output.token.tokenId] =\n                        (ftTokenBalances[output.token.tokenId] || BigInt(0)) +\n                            output.token.amount;\n                }\n                if (output.token?.capability) {\n                    nftTokenBalances[output.token.tokenId] =\n                        (nftTokenBalances[output.token.tokenId] || BigInt(0)) + 1n;\n                }\n            }\n        });\n        tx.valueChange = satoshiBalance;\n        tx.tokenAmountChanges = Object.entries(ftTokenBalances).map(([tokenId, amount]) => ({\n            tokenId,\n            amount,\n            nftAmount: BigInt(0),\n        }));\n        for (const [tokenId, nftAmount] of Object.entries(nftTokenBalances)) {\n            const tokenChange = tx.tokenAmountChanges.find((tokenChange) => tokenChange.tokenId === tokenId);\n            if (tokenChange) {\n                tokenChange.nftAmount = nftAmount;\n            }\n            else {\n                tx.tokenAmountChanges.push({\n                    tokenId,\n                    amount: BigInt(0),\n                    nftAmount,\n                });\n            }\n        }\n    });\n    // order transactions in a way such that receives are always ordered before sends, per block\n    historyItems.sort((a, b) => (a.blockHeight <= 0 || b.blockHeight <= 0\n        ? a.blockHeight - b.blockHeight\n        : b.blockHeight - a.blockHeight) || a.valueChange - b.valueChange);\n    // backfill the balances\n    let prevBalance = await provider.getBalance(address);\n    let prevValueChange = 0;\n    historyItems.forEach((tx) => {\n        tx.balance = prevBalance - prevValueChange;\n        prevBalance = tx.balance;\n        prevValueChange = tx.valueChange;\n    });\n    // convert units if needed\n    if (!unit.includes(\"sat\")) {\n        for (const tx of historyItems) {\n            for (const input of tx.inputs) {\n                input.value = await convert(input.value, \"sat\", unit);\n            }\n            for (const output of tx.outputs) {\n                output.value = await convert(output.value, \"sat\", unit);\n            }\n            tx.valueChange = await convert(tx.valueChange, \"sat\", unit);\n            tx.balance = await convert(tx.balance, \"sat\", unit);\n        }\n    }\n    return historyItems;\n};\n//# sourceMappingURL=electrumTransformer.js.map","import { bchParam } from \"../chain.js\";\nimport { networkTickerMap } from \"./constant.js\";\nexport async function getRelayFeeCache(provider) {\n    let relayFeePerKbInCoins;\n    if (networkTickerMap[provider.network] + \"_RELAY_FEE\" in globalThis) {\n        // Stores the fee in BCH_RELAY_FEE, tBCH_RELAY_FEE, etc\n        relayFeePerKbInCoins =\n            globalThis[networkTickerMap[provider.network] + \"_RELAY_FEE\"];\n    }\n    if (typeof relayFeePerKbInCoins !== \"number\") {\n        relayFeePerKbInCoins = await provider.getRelayFee();\n        globalThis[networkTickerMap[provider.network] + \"_RELAY_FEE\"] =\n            relayFeePerKbInCoins;\n    }\n    if (typeof relayFeePerKbInCoins === \"number\") {\n        return Math.round(relayFeePerKbInCoins * bchParam.subUnits) / 1000;\n    }\n    else {\n        console.warn(\"Couldn't get min relay fee, using default instead\");\n        return Math.round(0.00001 * bchParam.subUnits) / 1000;\n    }\n}\n//# sourceMappingURL=getRelayFeeCache.js.map","export var WalletTypeEnum;\n(function (WalletTypeEnum) {\n    WalletTypeEnum[\"Wif\"] = \"wif\";\n    WalletTypeEnum[\"Seed\"] = \"seed\";\n    WalletTypeEnum[\"Hd\"] = \"hd\";\n    WalletTypeEnum[\"Watch\"] = \"watch\";\n    WalletTypeEnum[\"PrivateKey\"] = \"privkey\";\n})(WalletTypeEnum || (WalletTypeEnum = {}));\nexport var FeePaidByEnum;\n(function (FeePaidByEnum) {\n    FeePaidByEnum[\"change\"] = \"change\";\n    FeePaidByEnum[\"first\"] = \"firstOutput\";\n    FeePaidByEnum[\"any\"] = \"anyOutputs\";\n    FeePaidByEnum[\"last\"] = \"lastOutput\";\n    FeePaidByEnum[\"changeThenFirst\"] = \"changeThenFirst\";\n    FeePaidByEnum[\"changeThenAny\"] = \"changeThenAny\";\n    FeePaidByEnum[\"changeThenLast\"] = \"changeThenLast\";\n})(FeePaidByEnum || (FeePaidByEnum = {}));\n//# sourceMappingURL=enum.js.map","import { OpReturnData, TokenSendRequest, } from \"../wallet/model.js\";\nimport { FeePaidByEnum } from \"../wallet/enum.js\";\nimport { DUST_UTXO_THRESHOLD } from \"../constant.js\";\nexport function checkFeeForDust(value) {\n    if (value < DUST_UTXO_THRESHOLD) {\n        throw Error(\"Fee strategy would result in dust output\");\n    }\n}\nexport function checkSatsAvailable(sendRequestArray, fee) {\n    let amountAvailable = sendRequestArray.reduce(function (sum, r) {\n        return sum + (r.value - DUST_UTXO_THRESHOLD);\n    }, 0);\n    if (amountAvailable < fee) {\n        throw Error(\"Insufficient funds for transaction given fee\");\n    }\n}\nexport function checkForNonStandardSendRequest(output) {\n    if (output instanceof TokenSendRequest) {\n        throw Error(\"Cannot specify fee to be paid by TokenSendRequest\");\n    }\n    if (output instanceof OpReturnData) {\n        throw Error(\"Cannot specify fee to be paid by OpReturnData\");\n    }\n    return output;\n}\nexport function sortSendRequests(sendRequestArray) {\n    return sendRequestArray.sort((a, b) => a.value - b.value);\n}\nfunction distributeFees(requests, fee) {\n    checkSatsAvailable(requests, fee);\n    fee = Number(fee);\n    for (let r = 0; r < requests.length; r++) {\n        if (fee > 0) {\n            checkForNonStandardSendRequest(requests[r]);\n            let perRequestFee = Math.floor(fee / (requests.length - r));\n            perRequestFee += fee % (requests.length - r);\n            if (requests[r].value - perRequestFee < DUST_UTXO_THRESHOLD) {\n                fee -= requests[r].value;\n                requests[r].value = 0;\n            }\n            else {\n                fee -= perRequestFee;\n                requests[r].value -= perRequestFee;\n            }\n        }\n    }\n    return requests.filter((r) => r.value >= DUST_UTXO_THRESHOLD);\n}\nfunction firstPays(requests, fee) {\n    let payer = requests.shift();\n    payer = checkForNonStandardSendRequest(payer);\n    payer.value = payer.value - fee;\n    checkFeeForDust(payer.value);\n    requests.unshift(payer);\n    return requests;\n}\nfunction lastPays(requests, fee) {\n    let payer = requests.pop();\n    payer = checkForNonStandardSendRequest(payer);\n    payer.value = payer.value - fee;\n    checkFeeForDust(payer.value);\n    requests.push(payer);\n    return requests;\n}\nfunction anyPays(requests, fee) {\n    for (let r of requests) {\n        checkForNonStandardSendRequest(r);\n    }\n    requests = sortSendRequests(requests);\n    requests = distributeFees(requests, fee);\n    return requests;\n}\nfunction changeThenFallback(requests, fee, change, fallbackFn) {\n    if (BigInt(fee) > change) {\n        let outstandingFee = BigInt(fee) - change;\n        requests = fallbackFn(requests, outstandingFee);\n    }\n    return requests;\n}\nexport function allocateFee(requests, fee, feePaidBy, change) {\n    if (requests.length > 0) {\n        switch (feePaidBy) {\n            case FeePaidByEnum.change:\n                // handled by default\n                break;\n            case FeePaidByEnum.changeThenFirst:\n                requests = changeThenFallback(requests, fee, change, firstPays);\n                break;\n            case FeePaidByEnum.changeThenLast:\n                requests = changeThenFallback(requests, fee, change, lastPays);\n                break;\n            case FeePaidByEnum.changeThenAny:\n                requests = changeThenFallback(requests, fee, change, anyPays);\n                break;\n            case FeePaidByEnum.first:\n                requests = firstPays(requests, fee);\n                break;\n            case FeePaidByEnum.last:\n                requests = lastPays(requests, fee);\n                break;\n            case FeePaidByEnum.any:\n                requests = anyPays(requests, fee);\n                break;\n            default:\n                throw Error(\"FeePaidBy option not recognized\");\n        }\n        return requests;\n    }\n    else {\n        throw Error(\"Attempted to specify feePaidBy on zero length SendRequest\");\n    }\n}\n//# sourceMappingURL=allocateFee.js.map","import { SendRequest, TokenSendRequest, } from \"../wallet/model.js\";\nimport { amountInSatoshi } from \"./amountInSatoshi.js\";\n// This function sums a list of send request objects\nexport async function sumSendRequestAmounts(requests) {\n    if (requests) {\n        const balanceArray = await Promise.all(requests.map(async (r) => {\n            if (r instanceof SendRequest) {\n                return BigInt(await amountInSatoshi(r.value, r.unit));\n            }\n            else if (r instanceof TokenSendRequest) {\n                return BigInt(r.value || 1000);\n            }\n            else\n                return BigInt(0);\n        }));\n        const balance = balanceArray.reduce(sumBalance, BigInt(0));\n        return balance;\n    }\n    else {\n        return BigInt(0);\n    }\n}\nfunction sumBalance(a, b) {\n    // a is zero or a number\n    if (b instanceof Error) {\n        throw b;\n    }\n    return BigInt(a) + BigInt(b);\n}\n//# sourceMappingURL=sumSendRequestAmounts.js.map","import { walletTemplateP2pkhNonHd, walletTemplateToCompilerBCH, cashAddressToLockingBytecode, encodeTransaction, generateTransaction, importWalletTemplate, hexToBin, verifyTransactionTokens, decodeTransaction, } from \"@bitauth/libauth\";\nimport { NFTCapability } from \"../interface.js\";\nimport { allocateFee } from \"./allocateFee.js\";\nimport { DUST_UTXO_THRESHOLD } from \"../constant.js\";\nimport { OpReturnData, TokenSendRequest, } from \"../wallet/model.js\";\nimport { amountInSatoshi } from \"../util/amountInSatoshi.js\";\nimport { sumSendRequestAmounts } from \"../util/sumSendRequestAmounts.js\";\nimport { sumUtxoValue } from \"../util/sumUtxoValue.js\";\nimport { FeePaidByEnum } from \"../wallet/enum.js\";\n// Build a transaction for a p2pkh transaction for a non HD wallet\nexport async function buildP2pkhNonHdTransaction({ inputs, outputs, signingKey, sourceAddress, fee = 0, discardChange = false, feePaidBy = FeePaidByEnum.change, changeAddress = \"\", }) {\n    if (!signingKey) {\n        throw new Error(\"Missing signing key when building transaction\");\n    }\n    const template = importWalletTemplate(walletTemplateP2pkhNonHd);\n    if (typeof template === \"string\") {\n        throw new Error(\"Transaction template error\");\n    }\n    const compiler = await walletTemplateToCompilerBCH(template);\n    const inputAmount = await sumUtxoValue(inputs);\n    const sendAmount = await sumSendRequestAmounts(outputs);\n    const changeAmount = BigInt(inputAmount) - BigInt(sendAmount) - BigInt(fee);\n    outputs = allocateFee(outputs, fee, feePaidBy, changeAmount);\n    const lockedOutputs = await prepareOutputs(outputs);\n    if (!changeAddress) {\n        changeAddress = sourceAddress;\n    }\n    if (discardChange !== true) {\n        if (changeAmount > DUST_UTXO_THRESHOLD) {\n            const changeLockingBytecode = cashAddressToLockingBytecode(changeAddress);\n            if (typeof changeLockingBytecode === \"string\") {\n                throw Error(changeLockingBytecode);\n            }\n            lockedOutputs.push({\n                lockingBytecode: changeLockingBytecode.bytecode,\n                valueSatoshis: BigInt(changeAmount),\n            });\n        }\n    }\n    const { preparedInputs, sourceOutputs } = prepareInputs({\n        inputs,\n        compiler,\n        signingKey,\n        sourceAddress,\n    });\n    const result = generateTransaction({\n        inputs: preparedInputs,\n        locktime: 0,\n        outputs: lockedOutputs,\n        version: 2,\n    });\n    if (!result.success) {\n        throw Error(\"Error building transaction with fee\");\n    }\n    const tokenValidationResult = verifyTransactionTokens(result.transaction, sourceOutputs, { maximumTokenCommitmentLength: 40 });\n    if (tokenValidationResult !== true && fee > 0) {\n        throw tokenValidationResult;\n    }\n    return { transaction: result.transaction, sourceOutputs: sourceOutputs };\n}\nexport function prepareInputs({ inputs, compiler, signingKey, sourceAddress, }) {\n    const preparedInputs = [];\n    const sourceOutputs = [];\n    for (const i of inputs) {\n        const utxoTxnValue = i.satoshis;\n        const utxoIndex = i.vout;\n        // slice will create a clone of the array\n        const utxoOutpointTransactionHash = new Uint8Array(i.txid.match(/.{1,2}/g).map((byte) => parseInt(byte, 16)));\n        // reverse the cloned copy\n        // utxoOutpointTransactionHash.reverse();\n        if (!utxoOutpointTransactionHash || utxoIndex === undefined) {\n            throw new Error(\"Missing unspent outpoint when building transaction\");\n        }\n        const libAuthToken = i.token && {\n            amount: BigInt(i.token.amount),\n            category: hexToBin(i.token.tokenId),\n            nft: i.token.capability !== undefined || i.token.commitment !== undefined\n                ? {\n                    capability: i.token.capability,\n                    commitment: i.token.commitment !== undefined &&\n                        hexToBin(i.token.commitment),\n                }\n                : undefined,\n        };\n        const key = signingKey?.length ? signingKey : Uint8Array.from(Array(32));\n        const newInput = {\n            outpointIndex: utxoIndex,\n            outpointTransactionHash: utxoOutpointTransactionHash,\n            sequenceNumber: 0,\n            unlockingBytecode: {\n                compiler,\n                data: {\n                    keys: { privateKeys: { key: key } },\n                },\n                valueSatoshis: BigInt(utxoTxnValue),\n                script: \"unlock\",\n                token: libAuthToken,\n            },\n        };\n        preparedInputs.push(newInput);\n        const lockingBytecode = cashAddressToLockingBytecode(sourceAddress);\n        if (typeof lockingBytecode === \"string\") {\n            throw lockingBytecode;\n        }\n        sourceOutputs.push({\n            outpointIndex: utxoIndex,\n            outpointTransactionHash: utxoOutpointTransactionHash,\n            sequenceNumber: 0,\n            unlockingBytecode: Uint8Array.from([]),\n            // additional info for sourceOutputs\n            lockingBytecode: lockingBytecode.bytecode,\n            valueSatoshis: BigInt(utxoTxnValue),\n            token: libAuthToken,\n        });\n    }\n    return { preparedInputs, sourceOutputs };\n}\n/**\n * prepareOutputs - create outputs for a transaction from a list of send requests\n *\n * a wrapper function\n *\n * @returns A promise to a list of unspent outputs\n */\nexport async function prepareOutputs(outputs) {\n    const lockedOutputs = [];\n    for (const output of outputs) {\n        if (output instanceof TokenSendRequest) {\n            lockedOutputs.push(prepareTokenOutputs(output));\n            continue;\n        }\n        if (output instanceof OpReturnData) {\n            lockedOutputs.push(prepareOpReturnOutput(output));\n            continue;\n        }\n        const outputLockingBytecode = cashAddressToLockingBytecode(output.cashaddr);\n        if (typeof outputLockingBytecode === \"string\")\n            throw new Error(outputLockingBytecode);\n        const sendAmount = await amountInSatoshi(output.value, output.unit);\n        if (sendAmount % 1 !== 0) {\n            throw Error(`Cannot send ${sendAmount} satoshis, (fractional sats do not exist, yet), please use an integer number.`);\n        }\n        const lockedOutput = {\n            lockingBytecode: outputLockingBytecode.bytecode,\n            valueSatoshis: BigInt(sendAmount),\n        };\n        lockedOutputs.push(lockedOutput);\n    }\n    return lockedOutputs;\n}\n/**\n * prepareOpReturnOutput - create an output for OP_RETURN data\n *\n * @returns A promise to a list of unspent outputs\n */\nexport function prepareOpReturnOutput(request) {\n    return {\n        lockingBytecode: request.buffer,\n        valueSatoshis: BigInt(0),\n    };\n}\n/**\n * prepareOpReturnOutput - create an output for token data\n *\n * @returns A libauth Output\n */\nexport function prepareTokenOutputs(request) {\n    const token = request;\n    const outputLockingBytecode = cashAddressToLockingBytecode(request.cashaddr);\n    if (typeof outputLockingBytecode === \"string\")\n        throw new Error(outputLockingBytecode);\n    const libAuthToken = {\n        amount: BigInt(token.amount),\n        category: hexToBin(token.tokenId),\n        nft: token.capability !== undefined || token.commitment !== undefined\n            ? {\n                capability: token.capability,\n                commitment: token.commitment !== undefined && hexToBin(token.commitment),\n            }\n            : undefined,\n    };\n    return {\n        lockingBytecode: outputLockingBytecode.bytecode,\n        valueSatoshis: BigInt(request.value || 1000),\n        token: libAuthToken,\n    };\n}\n/**\n * getSuitableUtxos - Filter a list of unspent transaction outputs to the minimum needed to complete a transaction\n *\n * a intermediate function\n *\n * @param unspentOutputs  An unfiltered list of available unspent transaction outputs\n *\n * @returns A promise to a list of unspent outputs\n */\nexport async function getSuitableUtxos(inputs, amountRequired, bestHeight, feePaidBy, requests, ensureUtxos = [], tokenOperation = \"send\") {\n    const suitableUtxos = [...ensureUtxos];\n    let amountAvailable = BigInt(0);\n    const tokenRequests = requests.filter((val) => val instanceof TokenSendRequest);\n    const availableInputs = inputs.slice();\n    const selectedInputs = [];\n    // find matching utxos for token transfers\n    if (tokenOperation === \"send\") {\n        for (const request of tokenRequests) {\n            const tokenInputs = availableInputs.filter((val) => val.token?.tokenId === request.tokenId);\n            const sameCommitmentTokens = [...suitableUtxos, ...tokenInputs]\n                .filter((val) => val.token?.capability === request.capability &&\n                val.token?.commitment === request.commitment)\n                .filter((val) => selectedInputs.find((selected) => val.txid === selected.txid && val.vout === selected.vout) === undefined);\n            if (sameCommitmentTokens.length) {\n                const input = sameCommitmentTokens[0];\n                const index = availableInputs.indexOf(input);\n                if (index !== -1) {\n                    suitableUtxos.push(input);\n                    selectedInputs.push(input);\n                    availableInputs.splice(index, 1);\n                    amountAvailable += BigInt(input.satoshis);\n                }\n                continue;\n            }\n            if (request.capability === NFTCapability.minting ||\n                request.capability === NFTCapability.mutable) {\n                const changeCommitmentTokens = [\n                    ...suitableUtxos,\n                    ...tokenInputs,\n                ].filter((val) => val.token?.capability === request.capability);\n                if (changeCommitmentTokens.length) {\n                    const input = changeCommitmentTokens[0];\n                    const index = availableInputs.indexOf(input);\n                    if (index !== -1) {\n                        suitableUtxos.push(input);\n                        availableInputs.splice(index, 1);\n                        amountAvailable += BigInt(input.satoshis);\n                    }\n                    continue;\n                }\n            }\n            // handle splitting the hybrid (FT+NFT) token into its parts\n            if (request.capability === undefined &&\n                request.commitment === undefined &&\n                [...suitableUtxos, ...tokenInputs]\n                    .map((val) => val.token?.tokenId)\n                    .includes(request.tokenId)) {\n                continue;\n            }\n            throw Error(`No suitable token utxos available to send token with id \"${request.tokenId}\", capability \"${request.capability}\", commitment \"${request.commitment}\"`);\n        }\n    }\n    // find plain bch outputs\n    for (const u of availableInputs) {\n        if (u.token) {\n            continue;\n        }\n        if (u.coinbase && u.height && bestHeight) {\n            const age = bestHeight - u.height;\n            if (age > 100) {\n                suitableUtxos.push(u);\n                amountAvailable += BigInt(u.satoshis);\n            }\n        }\n        else {\n            suitableUtxos.push(u);\n            amountAvailable += BigInt(u.satoshis);\n        }\n        // if amountRequired is not given, assume it is a max spend request, skip this condition\n        if (amountRequired && amountAvailable > amountRequired) {\n            break;\n        }\n    }\n    const addEnsured = (suitableUtxos) => {\n        return [...ensureUtxos, ...suitableUtxos].filter((val, index, array) => array.findIndex((other) => other.txid === val.txid && other.vout === val.vout) === index);\n    };\n    // if the fee is split with a feePaidBy option, skip checking change.\n    if (feePaidBy && feePaidBy != FeePaidByEnum.change) {\n        return addEnsured(suitableUtxos);\n    }\n    // If the amount needed is met, or no amount is given, return\n    if (typeof amountRequired === \"undefined\") {\n        return addEnsured(suitableUtxos);\n    }\n    else if (amountAvailable < amountRequired) {\n        const e = Error(`Amount required was not met, ${amountRequired} satoshis needed, ${amountAvailable} satoshis available`);\n        e[\"data\"] = {\n            required: amountRequired,\n            available: amountAvailable,\n        };\n        throw e;\n    }\n    else {\n        return addEnsured(suitableUtxos);\n    }\n}\n// model-based imprecise and fast fee estimation\nexport async function getFeeAmountSimple({ utxos, sendRequests, relayFeePerByteInSatoshi, discardChange, }) {\n    const inputSizeP2pkh = 148;\n    const outputSizeP2pkh = 34;\n    const inputTotalSize = utxos.reduce((prev, curr) => prev +\n        (curr.token\n            ? inputSizeP2pkh +\n                1 +\n                34 +\n                Math.round(1 + (curr.token.commitment?.length ?? 0) / 2) +\n                (curr.token.amount ? 9 : 0)\n            : inputSizeP2pkh), 0);\n    const outputSize = (sendRequest) => {\n        if (sendRequest.hasOwnProperty(\"unit\")) {\n            return outputSizeP2pkh;\n        }\n        else if (sendRequest.hasOwnProperty(\"tokenId\")) {\n            const tokenRequest = sendRequest;\n            return (outputSizeP2pkh +\n                1 +\n                34 +\n                Math.round(1 + (tokenRequest.commitment?.length ?? 0) / 2) +\n                (tokenRequest.amount ? 9 : 0));\n        }\n        else if (sendRequest.hasOwnProperty(\"buffer\")) {\n            return 9 + sendRequest.buffer.length;\n        }\n        return 0;\n    };\n    const outputTotalSize = sendRequests.reduce((prev, curr) => prev + outputSize(curr), 0) +\n        (discardChange ? 0 : outputSizeP2pkh);\n    return Math.ceil((inputTotalSize + outputTotalSize + 16) * relayFeePerByteInSatoshi);\n}\n// precise fee estimation\nexport async function getFeeAmount({ utxos, sendRequests, privateKey, sourceAddress, relayFeePerByteInSatoshi, feePaidBy, discardChange, }) {\n    // build transaction\n    if (utxos) {\n        // Build the transaction to get the approximate size\n        const { encodedTransaction: draftTransaction } = await buildEncodedTransaction({\n            inputs: utxos,\n            outputs: sendRequests,\n            signingKey: privateKey,\n            sourceAddress,\n            fee: 0, //DUST_UTXO_THRESHOLD\n            discardChange: discardChange ?? false,\n            feePaidBy,\n            changeAddress: \"\",\n        });\n        return Math.ceil(draftTransaction.length * relayFeePerByteInSatoshi + 1);\n    }\n    else {\n        throw Error(\"The available inputs in the wallet cannot satisfy this send request\");\n    }\n}\n// Build encoded transaction\nexport async function buildEncodedTransaction({ inputs, outputs, signingKey, sourceAddress, fee = 0, discardChange = false, feePaidBy = FeePaidByEnum.change, changeAddress = \"\", buildUnsigned = false, }) {\n    const { transaction, sourceOutputs } = await buildP2pkhNonHdTransaction({\n        inputs,\n        outputs,\n        signingKey,\n        sourceAddress,\n        fee,\n        discardChange,\n        feePaidBy,\n        changeAddress,\n    });\n    if (buildUnsigned === true) {\n        transaction.inputs.forEach((input) => (input.unlockingBytecode = Uint8Array.from([])));\n    }\n    return { encodedTransaction: encodeTransaction(transaction), sourceOutputs };\n}\nexport async function signUnsignedTransaction(transaction, sourceOutputs, signingKey) {\n    if (typeof transaction === \"string\") {\n        transaction = hexToBin(transaction);\n    }\n    const decoded = decodeTransaction(transaction);\n    if (typeof decoded === \"string\") {\n        throw decoded;\n    }\n    const template = importWalletTemplate(walletTemplateP2pkhNonHd);\n    if (typeof template === \"string\") {\n        throw new Error(\"Transaction template error\");\n    }\n    const compiler = walletTemplateToCompilerBCH(template);\n    const transactionTemplate = { ...decoded };\n    for (const [index, input] of decoded.inputs.entries()) {\n        const sourceOutput = sourceOutputs[index];\n        transactionTemplate.inputs[index] = {\n            ...input,\n            unlockingBytecode: {\n                compiler,\n                data: {\n                    keys: { privateKeys: { key: signingKey } },\n                },\n                valueSatoshis: sourceOutput.valueSatoshis,\n                script: \"unlock\",\n                token: sourceOutput.token,\n            },\n        };\n    }\n    const result = generateTransaction(transactionTemplate);\n    if (!result.success) {\n        throw result.errors;\n    }\n    return encodeTransaction(result.transaction);\n}\n//# sourceMappingURL=Wif.js.map","export async function checkUtxos(utxos, wallet) {\n    if (utxos.some((val) => val.satoshis === 0)) {\n        const addressUtxos = await wallet.getAddressUtxos(wallet.cashaddr);\n        const absent = utxos.filter((val) => !addressUtxos.find((utxo) => val.txid === utxo.txid && val.vout === utxo.vout));\n        if (absent.length) {\n            const absentString = absent\n                .map((val) => `${val.txid}:${val.vout}`)\n                .join(\", \");\n            throw Error(`Utxos [${absentString}] not found in wallet`);\n        }\n        utxos = utxos.map((val) => addressUtxos.find((utxo) => val.txid === utxo.txid && val.vout === utxo.vout));\n    }\n    return utxos;\n}\n//# sourceMappingURL=checkUtxos.js.map","import { assertSuccess, binToHex, decodeTransaction as decodeTransactionLibAuth, hexToBin, isPayToPublicKey, lockingBytecodeToAddressContents, lockingBytecodeToCashAddress, publicKeyToP2pkhCashAddress, } from \"@bitauth/libauth\";\nimport { bchParam } from \"../chain.js\";\nimport { NetworkType, prefixFromNetworkMap } from \"../enum.js\";\nimport { getNetworkProvider } from \"../network/default.js\";\nimport { getTransactionHash } from \"../util/transaction.js\";\n/**\n * Class with various wallet utilities.\n */\nexport class Util {\n    /**\n     * Initializes a wallet Util class.\n     *\n     * @param network     The network type to use. Defaults to mainnet.\n     */\n    constructor(network = NetworkType.Mainnet) {\n        this.network = network;\n        this.provider = getNetworkProvider(network);\n    }\n    async getTransactionHash(rawTransactionHex) {\n        return getTransactionHash(rawTransactionHex);\n    }\n    static async getTransactionHash(rawTransactionHex) {\n        return getTransactionHash(rawTransactionHex);\n    }\n    async decodeTransaction(transactionHashOrHex, loadInputValues = false) {\n        let transactionHex;\n        let transactionBin;\n        let txHash;\n        // raw transaction\n        if (transactionHashOrHex.length > 64) {\n            txHash = await this.getTransactionHash(transactionHashOrHex);\n            transactionBin = hexToBin(transactionHashOrHex);\n            transactionHex = transactionHashOrHex;\n        }\n        else {\n            // tx hash, look up the raw transaction\n            txHash = transactionHashOrHex;\n            transactionHex = await this.provider.getRawTransaction(txHash);\n            transactionBin = hexToBin(transactionHex);\n        }\n        const result = decodeTransactionLibAuth(transactionBin);\n        if (typeof result === \"string\") {\n            throw Error(result);\n        }\n        const transaction = this.mapToElectrumRawTransaction(result, txHash, transactionHex);\n        if (loadInputValues) {\n            // get unique transaction hashes\n            const hashes = [...new Set(transaction.vin.map((val) => val.txid))];\n            const transactions = await Promise.all(hashes.map((hash) => this.decodeTransaction(hash, false)));\n            const transactionMap = new Map();\n            transactions.forEach((val) => transactionMap.set(val.hash, val));\n            transaction.vin.forEach((input) => {\n                const output = transactionMap\n                    .get(input.txid)\n                    .vout.find((val) => val.n === input.vout);\n                input.address = output.scriptPubKey.addresses[0];\n                input.value = output.value;\n                input.tokenData = output.tokenData;\n            });\n        }\n        return transaction;\n    }\n    mapToElectrumRawTransaction(transaction, txHash, txHex) {\n        let result = {};\n        result.vin = transaction.inputs.map((input) => {\n            return {\n                scriptSig: {\n                    hex: binToHex(input.unlockingBytecode),\n                },\n                sequence: input.sequenceNumber,\n                txid: binToHex(input.outpointTransactionHash),\n                vout: input.outpointIndex,\n            };\n        });\n        result.vout = transaction.outputs.map((output, index) => {\n            return {\n                n: index,\n                scriptPubKey: {\n                    addresses: [\n                        isPayToPublicKey(output.lockingBytecode)\n                            ? publicKeyToP2pkhCashAddress({\n                                publicKey: lockingBytecodeToAddressContents(output.lockingBytecode).payload,\n                                prefix: prefixFromNetworkMap[this.network],\n                            })\n                            : assertSuccess(lockingBytecodeToCashAddress({\n                                bytecode: output.lockingBytecode,\n                                prefix: prefixFromNetworkMap[this.network],\n                            })).address,\n                    ],\n                    hex: binToHex(output.lockingBytecode),\n                },\n                value: Number(output.valueSatoshis) / bchParam.subUnits,\n            };\n        });\n        result.locktime = transaction.locktime;\n        result.version = transaction.version;\n        result.hash = txHash;\n        result.hex = txHex;\n        result.txid = txHash;\n        result.size = txHex.length / 2;\n        return result;\n    }\n    static async decodeTransaction(transactionHashOrHex, loadInputValues = false, network) {\n        return new this(network).decodeTransaction(transactionHashOrHex, loadInputValues);\n    }\n}\n//# sourceMappingURL=Util.js.map","import { binToHex, CashAddressNetworkPrefix, CashAddressType, decodeCashAddress, encodeCashAddress, } from \"@bitauth/libauth\";\nimport { DUST_UTXO_THRESHOLD } from \"../constant.js\";\nimport { networkPrefixMap, NetworkType, prefixFromNetworkMap, UnitEnum, } from \"../enum.js\";\nimport { getAddressHistory } from \"../history/electrumTransformer.js\";\nimport { NFTCapability } from \"../interface.js\";\nimport { SignedMessage } from \"../message/signed.js\";\nimport { getNetworkProvider } from \"../network/default.js\";\nimport { getRelayFeeCache } from \"../network/getRelayFeeCache.js\";\nimport { buildEncodedTransaction, getFeeAmount, getFeeAmountSimple, getSuitableUtxos, } from \"../transaction/Wif.js\";\nimport { balanceFromSatoshi, balanceResponseFromSatoshi, } from \"../util/balanceObjectFromSatoshi.js\";\nimport { checkUtxos } from \"../util/checkUtxos.js\";\nimport { derivePrefix } from \"../util/derivePublicKeyHash.js\";\nimport { amountInSatoshi, asSendRequestObject, deriveTokenaddr, getRuntimePlatform, hexToBin, sumTokenAmounts, sumUtxoValue, toTokenaddr, } from \"../util/index.js\";\nimport { sanitizeUnit } from \"../util/sanitizeUnit.js\";\nimport { sumSendRequestAmounts } from \"../util/sumSendRequestAmounts.js\";\nimport { BCMR } from \"./Bcmr.js\";\nimport { FeePaidByEnum, WalletTypeEnum } from \"./enum.js\";\nimport { fromUtxoId, OpReturnData, SendRequest, SendResponse, TokenSendRequest, } from \"./model.js\";\nimport { Util } from \"./Util.js\";\nconst placeholderPrivateKey = \"0000000000000000000000000000000000000000000000000000000000000001\";\n/**\n * A class to hold features used by all wallets\n * @class  BaseWallet\n */\nexport class BaseWallet {\n    get networkPrefix() {\n        return prefixFromNetworkMap[this.network];\n    }\n    // interface to util functions. see Util.ts\n    get util() {\n        if (!this._util) {\n            this._util = new Util(this.network);\n        }\n        return this._util;\n    }\n    // interface to util util. see Util.Util\n    static get util() {\n        return new this().util;\n    }\n    // Return wallet info\n    getInfo() {\n        return {\n            cashaddr: this.cashaddr,\n            tokenaddr: this.tokenaddr,\n            isTestnet: this.isTestnet,\n            name: this.name,\n            network: this.network,\n            publicKeyHash: binToHex(this.publicKeyHash),\n            walletId: this.toString(),\n            walletDbEntry: this.toDbString(),\n        };\n    }\n    slpSemiAware(value = true) {\n        this._slpSemiAware = value;\n        return this;\n    }\n    //#region Accessors\n    getNetworkProvider(\n    // @ts-ignore\n    network = NetworkType.Mainnet) {\n        return getNetworkProvider(network);\n    }\n    /**\n     * getDepositAddress - get a wallet deposit address\n     *\n     * a high-level function,\n     *\n     * @see {@link https://rest-unstable.mainnet.cash/api-docs/#/wallet/depositAddress|/wallet/deposit_address} for REST endpoint\n     *\n     * @returns The deposit address as a string\n     */\n    getDepositAddress() {\n        return this.cashaddr;\n    }\n    /**\n     * getTokenDepositAddress - get a cashtoken aware wallet deposit address\n     *\n     * @returns The cashtoken aware deposit address as a string\n     */\n    getTokenDepositAddress() {\n        return this.tokenaddr;\n    }\n    //#endregion Accessors\n    //#region Constructors and Statics\n    /**\n     * constructor for a new wallet\n     * @param network              network for wallet\n     *\n     * @throws {Error} if called on BaseWallet\n     */\n    constructor(network = NetworkType.Mainnet) {\n        this._slpSemiAware = false; // a flag which requires an utxo to have more than 546 sats to be spendable and counted in the balance\n        this.name = \"\";\n        this.network = network;\n        this.walletType = WalletTypeEnum.Watch;\n        this.provider = this.getNetworkProvider(this.network);\n        this.isTestnet = this.network === NetworkType.Mainnet ? false : true;\n    }\n    /**\n     * watchOnly - create a watch-only wallet\n     *\n     * such kind of wallet does not have a private key and is unable to spend any funds\n     * however it still allows to use many utility functions such as getting and watching balance, etc.\n     *\n     * @param address   cashaddress, token aware cashaddress of a wallet\n     *\n     * @returns instantiated wallet\n     */\n    static async watchOnly(address) {\n        return new this().watchOnly(address);\n    }\n    //#endregion Constructors\n    /**\n     * named (internal) get a named wallet from the database or create a new one.\n     * Note: this function should behave identically if\n     *\n     * @param {string} name              name of the wallet\n     * @param {string} dbName            database name the wallet is stored in\n     * @param {boolean} forceNew         attempt to overwrite an existing wallet\n     *\n     * @throws {Error} if forceNew is true and the wallet already exists\n     * @returns a promise to a named wallet\n     */\n    async named(name, dbName, forceNew = false) {\n        if (name.length === 0) {\n            throw Error(\"Named wallets must have a non-empty name\");\n        }\n        _checkContextSafety(this);\n        this.name = name;\n        dbName = dbName ? dbName : prefixFromNetworkMap[this.network];\n        const db = getStorageProvider(dbName);\n        // If there is a database, force saving or error\n        if (db) {\n            await db.init();\n            const savedWalletRecord = await db.getWallet(name);\n            if (savedWalletRecord) {\n                await db.close();\n                if (forceNew) {\n                    throw Error(`A wallet with the name ${name} already exists in ${dbName}`);\n                }\n                const recoveredWallet = await this.fromId(savedWalletRecord.wallet);\n                recoveredWallet.name = savedWalletRecord.name;\n                return recoveredWallet;\n            }\n            else {\n                const wallet = await this.generate();\n                await db.addWallet(wallet.name, wallet.toDbString());\n                await db.close();\n                return wallet;\n            }\n        }\n        else {\n            throw Error(\"No database was available or configured to store the named wallet.\");\n        }\n    }\n    /**\n     * replaceNamed - Replace (recover) named wallet with a new walletId\n     *\n     * If wallet with a provided name does not exist yet, it will be created with a `walletId` supplied\n     * If wallet exists it will be overwritten without exception\n     *\n     * @param name   user friendly wallet alias\n     * @param walletId walletId options to steer the creation process\n     * @param dbName name under which the wallet will be stored in the database\n     *\n     * @returns instantiated wallet\n     */\n    async replaceNamed(name, walletId, dbName) {\n        if (name.length === 0) {\n            throw Error(\"Named wallets must have a non-empty name\");\n        }\n        _checkContextSafety(this);\n        this.name = name;\n        dbName = dbName ? dbName : prefixFromNetworkMap[this.network];\n        let db = getStorageProvider(dbName);\n        if (db) {\n            await db.init();\n            let savedWalletRecord = await db.getWallet(name);\n            await this.fromId(walletId);\n            if (savedWalletRecord) {\n                await db.updateWallet(name, walletId);\n            }\n            else {\n                await db.addWallet(name, walletId);\n            }\n            await db.close();\n            return this;\n        }\n        else {\n            throw Error(\"No database was available or configured to store the named wallet.\");\n        }\n    }\n    /**\n     * namedExists - check if a named wallet already exists\n     *\n     * @param name   user friendly wallet alias\n     * @param dbName name under which the wallet will be stored in the database\n     *\n     * @returns boolean\n     */\n    async namedExists(name, dbName) {\n        if (name.length === 0) {\n            throw Error(\"Named wallets must have a non-empty name\");\n        }\n        _checkContextSafety(this);\n        dbName = dbName ? dbName : prefixFromNetworkMap[this.network];\n        let db = getStorageProvider(dbName);\n        if (db) {\n            await db.init();\n            let savedWalletRecord = await db.getWallet(name);\n            await db.close();\n            return savedWalletRecord !== undefined;\n        }\n        else {\n            throw Error(\"No database was available or configured to store the named wallet.\");\n        }\n    }\n    async generate() {\n        return this;\n    }\n    //#region Serialization\n    /**\n     * toDbString - store the serialized version of the wallet in the database, not just the name\n     *\n     * @throws {Error} if called on BaseWallet\n     */\n    toDbString() {\n        return `${this.walletType}:${this.network}:${this.getDepositAddress()}`;\n    }\n    // Returns the serialized wallet as a string\n    // If storing in a database, set asNamed to false to store secrets\n    // In all other cases, the a named wallet is deserialized from the database\n    //  by the name key\n    toString() {\n        return `${this.walletType}:${this.network}:${this.getDepositAddress()}`;\n    }\n    //#endregion Serialization\n    /**\n     *  explorerUrl   Web url to a transaction on a block explorer\n     *\n     * @param txId   transaction Id\n     * @returns   Url string\n     */\n    explorerUrl(txId) {\n        const explorerUrlMap = {\n            mainnet: \"https://blockchair.com/bitcoin-cash/transaction/\",\n            testnet: \"https://www.blockchain.com/bch-testnet/tx/\",\n            regtest: \"\",\n        };\n        return explorerUrlMap[this.network] + txId;\n    }\n    // returns the public key hash for an address\n    getPublicKeyHash(hex = false) {\n        if (this.publicKeyHash) {\n            return hex ? binToHex(this.publicKeyHash) : this.publicKeyHash;\n        }\n        else {\n            throw Error(\"The public key hash for this wallet is not known. If this wallet was created from the constructor directly, calling the deriveInfo() function may help. \");\n        }\n    }\n    /**\n     * fromCashaddr - create a watch-only wallet in the network derived from the address\n     *\n     * such kind of wallet does not have a private key and is unable to spend any funds\n     * however it still allows to use many utility functions such as getting and watching balance, etc.\n     *\n     * @param address   cashaddress of a wallet\n     *\n     * @returns instantiated wallet\n     */\n    static async fromCashaddr(address) {\n        const prefix = derivePrefix(address);\n        const networkType = networkPrefixMap[prefix];\n        return new this(networkType).watchOnly(address);\n    }\n    /**\n     * fromTokenaddr - create a watch-only wallet in the network derived from the address\n     *\n     * such kind of wallet does not have a private key and is unable to spend any funds\n     * however it still allows to use many utility functions such as getting and watching balance, etc.\n     *\n     * @param address   token aware cashaddress of a wallet\n     *\n     * @returns instantiated wallet\n     */\n    static async fromTokenaddr(address) {\n        const prefix = derivePrefix(address);\n        const networkType = networkPrefixMap[prefix];\n        return new this(networkType).watchOnly(address);\n    }\n    /**\n     * named - create a named wallet\n     *\n     * @param name   user friendly wallet alias\n     * @param dbName name under which the wallet will be stored in the database\n     * @param force  force recreate wallet in the database if a record already exist\n     *\n     * @returns instantiated wallet\n     */\n    static async named(name, dbName, force) {\n        return new this().named(name, dbName, force);\n    }\n    /**\n     * replaceNamed - replace (recover) named wallet with a new walletId\n     *\n     * If wallet with a provided name does not exist yet, it will be created with a `walletId` supplied\n     * If wallet exists it will be overwritten without exception\n     *\n     * @param name   user friendly wallet alias\n     * @param walletId walletId options to steer the creation process\n     * @param dbName name under which the wallet will be stored in the database\n     *\n     * @returns instantiated wallet\n     */\n    static async replaceNamed(name, walletId, dbName) {\n        return new this().replaceNamed(name, walletId, dbName);\n    }\n    /**\n     * namedExists - check if a named wallet already exists\n     *\n     * @param name   user friendly wallet alias\n     * @param dbName name under which the wallet will be stored in the database\n     *\n     * @returns boolean\n     */\n    static async namedExists(name, dbName) {\n        return new this().namedExists(name, dbName);\n    }\n    fromId(walletId) {\n        const [walletType, networkGiven, arg1, arg2] = walletId.split(\":\");\n        if (walletType !== WalletTypeEnum.Watch) {\n            throw Error(`fromId called on a ${walletType} wallet, expected a ${WalletTypeEnum.Watch} wallet`);\n        }\n        if (this.network != networkGiven) {\n            throw Error(`Network prefix ${networkGiven} to a ${this.network} wallet`);\n        }\n        if (arg2) {\n            return this.watchOnly(`${arg1}:${arg2}`);\n        }\n        return this.watchOnly(arg1);\n    }\n    // Initialize a watch only wallet from a cash addr\n    async watchOnly(address) {\n        this.walletType = WalletTypeEnum.Watch;\n        const addressComponents = address.split(\":\");\n        let addressPrefix;\n        let addressBase;\n        if (addressComponents.length === 1) {\n            addressBase = addressComponents.shift();\n            addressPrefix = derivePrefix(addressBase);\n        }\n        else {\n            addressPrefix = addressComponents.shift();\n            addressBase = addressComponents.shift();\n            if (addressPrefix in networkPrefixMap) {\n                if (networkPrefixMap[addressPrefix] !== this.network) {\n                    throw Error(`a ${addressPrefix} address cannot be watched from a ${this.network} Wallet`);\n                }\n            }\n        }\n        const prefixedAddress = `${addressPrefix}:${addressBase}`;\n        // check if a token aware address was provided\n        const addressData = decodeCashAddress(prefixedAddress);\n        if (typeof addressData === \"string\")\n            throw addressData;\n        this.publicKeyHash = addressData.payload;\n        let nonTokenAwareType = addressData.type;\n        if (nonTokenAwareType == CashAddressType.p2pkhWithTokens)\n            nonTokenAwareType = CashAddressType.p2pkh;\n        if (nonTokenAwareType == CashAddressType.p2shWithTokens)\n            nonTokenAwareType = CashAddressType.p2sh;\n        if (nonTokenAwareType == CashAddressType.p2pkh)\n            this.publicKeyHash = addressData.payload;\n        this.cashaddr = encodeCashAddress({\n            prefix: addressData.prefix,\n            type: nonTokenAwareType,\n            payload: addressData.payload,\n        }).address;\n        this.tokenaddr = deriveTokenaddr(addressData.payload, this.networkPrefix);\n        return this;\n    }\n    //#region Funds\n    /**\n     * utxos Get unspent outputs for the wallet\n     *\n     */\n    async getUtxos() {\n        if (!this.cashaddr) {\n            throw Error(\"Attempted to get utxos without an address\");\n        }\n        return await this.getAddressUtxos(this.cashaddr);\n    }\n    // gets wallet balance in sats, bch and currency\n    async getBalance(rawUnit, priceCache = true) {\n        if (rawUnit) {\n            const unit = sanitizeUnit(rawUnit);\n            return await balanceFromSatoshi(await this.getBalanceFromProvider(), unit, priceCache);\n        }\n        else {\n            return await balanceResponseFromSatoshi(await this.getBalanceFromProvider(), priceCache);\n        }\n    }\n    // Gets balance by summing value in all utxos in stats\n    async getBalanceFromUtxos() {\n        const utxos = (await this.getAddressUtxos(this.cashaddr)).filter((val) => val.token === undefined);\n        return sumUtxoValue(utxos);\n    }\n    // Gets balance from fulcrum\n    async getBalanceFromProvider() {\n        // Fulcrum reports balance of all utxos, including tokens, which is undesirable\n        // // TODO not sure why getting the balance from a provider doesn't work\n        // if (this._slpAware || this._slpSemiAware) {\n        //   return await this.getBalanceFromUtxos();\n        // } else {\n        //   return await this.provider.getBalance(this.cashaddr);\n        // }\n        // FIXME\n        return this.getBalanceFromUtxos();\n    }\n    async getAddressUtxos(address) {\n        if (!address) {\n            address = this.cashaddr;\n        }\n        if (this._slpSemiAware) {\n            const bchUtxos = await this.provider.getUtxos(address);\n            return bchUtxos.filter((bchutxo) => bchutxo.satoshis > DUST_UTXO_THRESHOLD);\n        }\n        else {\n            return await this.provider.getUtxos(address);\n        }\n    }\n    // watching for any transaction hash of this wallet\n    async watchAddress(callback) {\n        return this.provider.watchAddress(this.getDepositAddress(), callback);\n    }\n    // watching for any transaction of this wallet\n    async watchAddressTransactions(callback) {\n        return this.provider.watchAddressTransactions(this.getDepositAddress(), callback);\n    }\n    // watching for cashtoken transaction of this wallet\n    async watchAddressTokenTransactions(callback) {\n        return this.provider.watchAddressTokenTransactions(this.getDepositAddress(), callback);\n    }\n    // sets up a callback to be called upon wallet's balance change\n    // can be cancelled by calling the function returned from this one\n    async watchBalance(callback) {\n        return this.provider.watchAddressStatus(this.getDepositAddress(), async (_status) => {\n            const balance = (await this.getBalance());\n            callback(balance);\n        });\n    }\n    // sets up a callback to be called upon wallet's BCH or USD balance change\n    // if BCH balance does not change, the callback will be triggered every\n    // @param `usdPriceRefreshInterval` milliseconds by polling for new BCH USD price\n    // Since we want to be most sensitive to usd value change, we do not use the cached exchange rates\n    // can be cancelled by calling the function returned from this one\n    async watchBalanceUsd(callback, usdPriceRefreshInterval = 30000) {\n        let usdPrice = -1;\n        const _callback = async () => {\n            const balance = (await this.getBalance(undefined, false));\n            if (usdPrice !== balance.usd) {\n                usdPrice = balance.usd;\n                callback(balance);\n            }\n        };\n        const watchCancel = await this.provider.watchAddressStatus(this.getDepositAddress(), _callback);\n        const interval = setInterval(_callback, usdPriceRefreshInterval);\n        return async () => {\n            await watchCancel?.();\n            clearInterval(interval);\n        };\n    }\n    // waits for address balance to be greater than or equal to the target value\n    // this call halts the execution\n    async waitForBalance(value, rawUnit = UnitEnum.BCH) {\n        return new Promise(async (resolve) => {\n            let watchCancel;\n            watchCancel = await this.watchBalance(async (balance) => {\n                const satoshiBalance = await amountInSatoshi(value, rawUnit);\n                if (balance.sat >= satoshiBalance) {\n                    await watchCancel?.();\n                    resolve(balance);\n                }\n            });\n        });\n    }\n    // sets up a callback to be called upon wallet's token balance change\n    // can be cancelled by calling the function returned from this one\n    async watchTokenBalance(tokenId, callback) {\n        let previous = undefined;\n        return await this.provider.watchAddressStatus(this.getDepositAddress(), async (_status) => {\n            const balance = await this.getTokenBalance(tokenId);\n            if (previous != balance) {\n                callback(balance);\n            }\n            previous = balance;\n        });\n    }\n    // waits for address token balance to be greater than or equal to the target amount\n    // this call halts the execution\n    async waitForTokenBalance(tokenId, amount) {\n        return new Promise(async (resolve) => {\n            let watchCancel;\n            watchCancel = await this.watchTokenBalance(tokenId, async (balance) => {\n                if (balance >= amount) {\n                    await watchCancel?.();\n                    resolve(balance);\n                }\n            });\n        });\n    }\n    async getTokenInfo(tokenId) {\n        return BCMR.getTokenInfo(tokenId);\n    }\n    async _getMaxAmountToSend(params = {\n        outputCount: 1,\n        options: {},\n    }) {\n        if (!params.privateKey && params.options?.buildUnsigned !== true) {\n            throw Error(\"Couldn't get network or private key for wallet.\");\n        }\n        if (!this.cashaddr) {\n            throw Error(\"attempted to send without a cashaddr\");\n        }\n        if (params.options && params.options.slpSemiAware) {\n            this._slpSemiAware = true;\n        }\n        let feePaidBy;\n        if (params.options && params.options.feePaidBy) {\n            feePaidBy = params.options.feePaidBy;\n        }\n        else {\n            feePaidBy = FeePaidByEnum.change;\n        }\n        // get inputs\n        let utxos;\n        if (params.options && params.options.utxoIds) {\n            utxos = await checkUtxos(params.options.utxoIds.map((utxoId) => typeof utxoId === \"string\" ? fromUtxoId(utxoId) : utxoId), this);\n        }\n        else {\n            utxos = (await this.getAddressUtxos(this.cashaddr)).filter((utxo) => !utxo.token);\n        }\n        // Get current height to assure recently mined coins are not spent.\n        const bestHeight = await this.provider.getBlockHeight();\n        // simulate outputs using the sender's address\n        const sendRequest = new SendRequest({\n            cashaddr: this.cashaddr,\n            value: 100,\n            unit: \"sat\",\n        });\n        const sendRequests = Array(params.outputCount)\n            .fill(0)\n            .map(() => sendRequest);\n        const fundingUtxos = await getSuitableUtxos(utxos, undefined, bestHeight, feePaidBy, sendRequests);\n        const relayFeePerByteInSatoshi = await getRelayFeeCache(this.provider);\n        const fee = await getFeeAmountSimple({\n            utxos: fundingUtxos,\n            sendRequests: sendRequests,\n            privateKey: params.privateKey ?? hexToBin(placeholderPrivateKey),\n            sourceAddress: this.cashaddr,\n            relayFeePerByteInSatoshi: relayFeePerByteInSatoshi,\n            feePaidBy: feePaidBy,\n        });\n        const spendableAmount = sumUtxoValue(fundingUtxos);\n        let result = spendableAmount - fee;\n        if (result < 0) {\n            result = 0;\n        }\n        return { value: result, utxos: fundingUtxos };\n    }\n    async getMaxAmountToSend(params = {\n        outputCount: 1,\n        options: {},\n    }) {\n        const { value: result } = await this._getMaxAmountToSend(params);\n        return await balanceResponseFromSatoshi(result);\n    }\n    /**\n     * send Send some amount to an address\n     * this function processes the send requests, encodes the transaction, sends it to the network\n     * @returns (depending on the options parameter) the transaction id, new address balance and a link to the transaction on the blockchain explorer\n     *\n     * This is a first class function with REST analog, maintainers should strive to keep backward-compatibility\n     *\n     */\n    async send(requests, options) {\n        const { encodedTransaction, tokenIds, sourceOutputs } = await this.encodeTransaction(requests, undefined, options);\n        const resp = new SendResponse({});\n        resp.tokenIds = tokenIds;\n        if (options?.buildUnsigned !== true) {\n            const txId = await this.submitTransaction(encodedTransaction, options?.awaitTransactionPropagation === undefined ||\n                options?.awaitTransactionPropagation === true);\n            resp.txId = txId;\n            resp.explorerUrl = this.explorerUrl(resp.txId);\n            if (options?.queryBalance === undefined ||\n                options?.queryBalance === true) {\n                resp.balance = (await this.getBalance());\n            }\n        }\n        else {\n            resp.unsignedTransaction = binToHex(encodedTransaction);\n            resp.sourceOutputs = sourceOutputs;\n        }\n        return resp;\n    }\n    /**\n     * sendMax Send all available funds to a destination cash address\n     *\n     * @param  {string} cashaddr destination cash address\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     *\n     * @returns (depending on the options parameter) the transaction id, new address balance and a link to the transaction on the blockchain explorer\n     */\n    async sendMax(cashaddr, options) {\n        return await this.sendMaxRaw(cashaddr, options);\n    }\n    /**\n     * sendMaxRaw (internal) Send all available funds to a destination cash address\n     *\n     * @param  {string} cashaddr destination cash address\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     *\n     * @returns the transaction id sent to the network\n     */\n    async sendMaxRaw(cashaddr, options, privateKey) {\n        const { value: maxSpendableAmount, utxos } = await this._getMaxAmountToSend({\n            outputCount: 1,\n            options: options,\n            privateKey: privateKey,\n        });\n        if (!options) {\n            options = {};\n        }\n        options.utxoIds = utxos;\n        const sendRequest = new SendRequest({\n            cashaddr: cashaddr,\n            value: maxSpendableAmount,\n            unit: \"sat\",\n        });\n        const { encodedTransaction, tokenIds, sourceOutputs } = await this.encodeTransaction([sendRequest], true, options, privateKey);\n        const resp = new SendResponse({});\n        resp.tokenIds = tokenIds;\n        if (options?.buildUnsigned !== true) {\n            const txId = await this.submitTransaction(encodedTransaction, options?.awaitTransactionPropagation === undefined ||\n                options?.awaitTransactionPropagation === true);\n            resp.txId = txId;\n            resp.explorerUrl = this.explorerUrl(resp.txId);\n            if (options?.queryBalance === undefined ||\n                options?.queryBalance === true) {\n                resp.balance = (await this.getBalance());\n            }\n        }\n        else {\n            resp.unsignedTransaction = binToHex(encodedTransaction);\n            resp.sourceOutputs = sourceOutputs;\n        }\n        return resp;\n    }\n    /**\n     * encodeTransaction Encode and sign a transaction given a list of sendRequests, options and estimate fees.\n     * @param  {SendRequest[]} sendRequests SendRequests\n     * @param  {boolean} discardChange=false\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     */\n    async encodeTransaction(requests, discardChange = false, options, privateKey) {\n        let sendRequests = asSendRequestObject(requests);\n        if (!privateKey && options?.buildUnsigned !== true) {\n            throw new Error(`Missing private key`);\n        }\n        if (options && options.slpSemiAware) {\n            this._slpSemiAware = true;\n        }\n        let feePaidBy;\n        if (options && options.feePaidBy) {\n            feePaidBy = options.feePaidBy;\n        }\n        else {\n            feePaidBy = FeePaidByEnum.change;\n        }\n        let changeAddress;\n        if (options && options.changeAddress) {\n            changeAddress = options.changeAddress;\n        }\n        else {\n            changeAddress = this.cashaddr;\n        }\n        let checkTokenQuantities = true;\n        if (options && options.checkTokenQuantities === false) {\n            checkTokenQuantities = false;\n        }\n        // get inputs from options or query all inputs\n        let utxos;\n        if (options && options.utxoIds) {\n            utxos = await checkUtxos(options.utxoIds.map((utxoId) => typeof utxoId === \"string\" ? fromUtxoId(utxoId) : utxoId), this);\n        }\n        else {\n            utxos = await this.getAddressUtxos(this.cashaddr);\n        }\n        // filter out token utxos if there are no token requests\n        if (checkTokenQuantities &&\n            !sendRequests.some((val) => val instanceof TokenSendRequest)) {\n            utxos = utxos.filter((val) => !val.token);\n        }\n        const addTokenChangeOutputs = (inputs, outputs) => {\n            // Allow for implicit token burn if the total amount sent is less than user had\n            // allow for token genesis, creating more tokens than we had before (0)\n            if (!checkTokenQuantities) {\n                return;\n            }\n            const allTokenInputs = inputs.filter((val) => val.token);\n            const allTokenOutputs = outputs.filter((val) => val instanceof TokenSendRequest);\n            const tokenIds = allTokenOutputs\n                .map((val) => val.tokenId)\n                .filter((val, idx, arr) => arr.indexOf(val) === idx);\n            for (let tokenId of tokenIds) {\n                const tokenInputs = allTokenInputs.filter((val) => val.token?.tokenId === tokenId);\n                const inputAmountSum = tokenInputs.reduce((prev, cur) => prev + cur.token.amount, 0n);\n                const tokenOutputs = allTokenOutputs.filter((val) => val.tokenId === tokenId);\n                const outputAmountSum = tokenOutputs.reduce((prev, cur) => prev + cur.amount, 0n);\n                const diff = inputAmountSum - outputAmountSum;\n                if (diff < 0) {\n                    throw new Error(\"Not enough token amount to send\");\n                }\n                if (diff >= 0) {\n                    let available = 0n;\n                    let change = 0n;\n                    const ensureUtxos = [];\n                    for (const token of tokenInputs.filter((val) => val.token?.amount)) {\n                        ensureUtxos.push(token);\n                        available += token.token.amount;\n                        if (available >= outputAmountSum) {\n                            change = available - outputAmountSum;\n                            //break;\n                        }\n                    }\n                    if (ensureUtxos.length) {\n                        if (!options) {\n                            options = {};\n                        }\n                        options.ensureUtxos = [\n                            ...(options.ensureUtxos ?? []),\n                            ...ensureUtxos,\n                        ].filter((val, index, array) => array.findIndex((other) => other.txid === val.txid && other.vout === val.vout) === index);\n                    }\n                    if (change > 0) {\n                        outputs.push(new TokenSendRequest({\n                            cashaddr: toTokenaddr(changeAddress) || this.tokenaddr,\n                            amount: change,\n                            tokenId: tokenId,\n                            commitment: tokenOutputs[0].commitment,\n                            capability: tokenOutputs[0].capability,\n                            value: tokenOutputs[0].value,\n                        }));\n                    }\n                }\n            }\n        };\n        addTokenChangeOutputs(utxos, sendRequests);\n        const bestHeight = await this.provider.getBlockHeight();\n        const spendAmount = await sumSendRequestAmounts(sendRequests);\n        if (utxos.length === 0) {\n            throw Error(\"There were no Unspent Outputs\");\n        }\n        if (typeof spendAmount !== \"bigint\") {\n            throw Error(\"Couldn't get spend amount when building transaction\");\n        }\n        const relayFeePerByteInSatoshi = await getRelayFeeCache(this.provider);\n        const feeEstimate = await getFeeAmountSimple({\n            utxos: utxos,\n            sendRequests: sendRequests,\n            privateKey: privateKey ?? hexToBin(placeholderPrivateKey),\n            sourceAddress: this.cashaddr,\n            relayFeePerByteInSatoshi: relayFeePerByteInSatoshi,\n            feePaidBy: feePaidBy,\n        });\n        const fundingUtxos = await getSuitableUtxos(utxos, BigInt(spendAmount) + BigInt(Math.ceil(feeEstimate)), bestHeight, feePaidBy, sendRequests, options?.ensureUtxos || [], options?.tokenOperation);\n        if (fundingUtxos.length === 0) {\n            throw Error(\"The available inputs couldn't satisfy the request with fees\");\n        }\n        const fee = await getFeeAmount({\n            utxos: fundingUtxos,\n            sendRequests: sendRequests,\n            privateKey: privateKey ?? hexToBin(placeholderPrivateKey),\n            sourceAddress: this.cashaddr,\n            relayFeePerByteInSatoshi: relayFeePerByteInSatoshi,\n            feePaidBy: feePaidBy,\n        });\n        const { encodedTransaction, sourceOutputs } = await buildEncodedTransaction({\n            inputs: fundingUtxos,\n            outputs: sendRequests,\n            signingKey: privateKey ?? hexToBin(placeholderPrivateKey),\n            sourceAddress: this.cashaddr,\n            fee,\n            discardChange,\n            feePaidBy,\n            changeAddress,\n            buildUnsigned: options?.buildUnsigned === true,\n        });\n        const tokenIds = [\n            ...fundingUtxos\n                .filter((val) => val.token?.tokenId)\n                .map((val) => val.token.tokenId),\n            ...sendRequests\n                .filter((val) => val instanceof TokenSendRequest)\n                .map((val) => val.tokenId),\n        ].filter((value, index, array) => array.indexOf(value) === index);\n        return { encodedTransaction, tokenIds, sourceOutputs };\n    }\n    // Submit a raw transaction\n    async submitTransaction(transaction, awaitPropagation = true) {\n        if (!this.provider) {\n            throw Error(\"Wallet network provider was not initialized\");\n        }\n        let rawTransaction = binToHex(transaction);\n        return await this.provider.sendRawTransaction(rawTransaction, awaitPropagation);\n    }\n    // gets transaction history of this wallet\n    async getRawHistory(fromHeight = 0, toHeight = -1) {\n        return await this.provider.getHistory(this.cashaddr, fromHeight, toHeight);\n    }\n    /**\n     * getHistory gets transaction history of this wallet with most data decoded and ready to present to user\n     * @note balance calculations are valid only if querying to the blockchain tip (`toHeight` === -1, `count` === -1)\n     * @note this method is heavy on network calls, if invoked in browser use of cache is advised, @see `Config.UseLocalStorageCache`\n     * @note this method tries to recreate the history tab view of Electron Cash wallet, however, it may not be 100% accurate if the tnransaction value changes are the same in the same block (ordering)\n     *\n     * @param unit optional, BCH or currency unit to present balance and balance changes. If unit is currency like USD or EUR, balances will be subject to possible rounding errors. Default 0\n     * @param fromHeight optional, if set, history will be limited. Default 0\n     * @param toHeight optional, if set, history will be limited. Default -1, meaning that all history items will be returned, including mempool\n     * @param start optional, if set, the result set will be paginated with offset `start`\n     * @param count optional, if set, the result set will be paginated with `count`. Default -1, meaning that all history items will be returned\n     *\n     * @returns an array of transaction history items, with input values and addresses encoded in cashaddress format. @see `TransactionHistoryItem` type\n     */\n    async getHistory({ unit = \"sat\", fromHeight = 0, toHeight = -1, start = 0, count = -1, }) {\n        return getAddressHistory({\n            address: this.cashaddr,\n            provider: this.provider,\n            unit,\n            fromHeight,\n            toHeight,\n            start,\n            count,\n        });\n    }\n    // gets last transaction of this wallet\n    async getLastTransaction(confirmedOnly = false) {\n        let history = await this.getRawHistory();\n        if (confirmedOnly) {\n            history = history.filter((val) => val.height > 0);\n        }\n        if (!history.length) {\n            return null;\n        }\n        const [lastTx] = history.slice(-1);\n        return this.provider.getRawTransactionObject(lastTx.tx_hash);\n    }\n    // waits for next transaction, program execution is halted\n    async waitForTransaction(options = {\n        getTransactionInfo: true,\n        getBalance: false,\n        txHash: undefined,\n    }) {\n        if (options.getTransactionInfo === undefined) {\n            options.getTransactionInfo = true;\n        }\n        return new Promise(async (resolve) => {\n            let txHashSeen = false;\n            const makeResponse = async (txHash) => {\n                const response = {};\n                const promises = [undefined, undefined];\n                if (options.getBalance === true) {\n                    promises[0] = this.getBalance();\n                }\n                if (options.getTransactionInfo === true) {\n                    if (!txHash) {\n                        promises[1] = this.getLastTransaction();\n                    }\n                    else {\n                        promises[1] = this.provider.getRawTransactionObject(txHash);\n                    }\n                }\n                const result = await Promise.all(promises);\n                response.balance = result[0];\n                response.transactionInfo = result[1];\n                return response;\n            };\n            // waiting for a specific transaction to propagate\n            if (options.txHash) {\n                let cancel;\n                const waitForTransactionCallback = async (data) => {\n                    if (data && data[0] === options.txHash && data[1] !== null) {\n                        txHashSeen = true;\n                        await cancel?.();\n                        resolve(makeResponse(options.txHash));\n                    }\n                };\n                cancel = await this.provider.subscribeToTransaction(options.txHash, waitForTransactionCallback);\n                return;\n            }\n            // waiting for any address transaction\n            let watchCancel;\n            let initialResponseSeen = false;\n            watchCancel = await this.provider.watchAddressStatus(this.getDepositAddress(), async (_status) => {\n                if (initialResponseSeen) {\n                    await watchCancel?.();\n                    resolve(makeResponse());\n                    return;\n                }\n                initialResponseSeen = true;\n            });\n        });\n    }\n    /**\n     * watchBlocks Watch network blocks\n     *\n     * @param callback callback with a block header object\n     * @param skipCurrentHeight if set, the notification about current block will not arrive\n     *\n     * @returns a function which will cancel watching upon evaluation\n     */\n    async watchBlocks(callback, skipCurrentHeight = true) {\n        return this.provider.watchBlocks(callback, skipCurrentHeight);\n    }\n    /**\n     * waitForBlock Wait for a network block\n     *\n     * @param height if specified waits for this exact blockchain height, otherwise resolves with the next block\n     *\n     */\n    async waitForBlock(height) {\n        return this.provider.waitForBlock(height);\n    }\n    //#endregion Funds\n    // Convenience wrapper to verify interface\n    async verify(message, sig, publicKey) {\n        return await new SignedMessage().verify(message, sig, this.cashaddr, publicKey);\n    }\n    //#region Cashtokens\n    /**\n     * Create new cashtoken, both funglible and/or non-fungible (NFT)\n     * Refer to spec https://github.com/bitjson/cashtokens\n     * @param  {number} genesisRequest.amount amount of *fungible* tokens to create\n     * @param  {NFTCapability?} genesisRequest.capability capability of new NFT\n     * @param  {string?} genesisRequest.commitment NFT commitment message\n     * @param  {string?} genesisRequest.cashaddr cash address to send the created token UTXO to; if undefined will default to your address\n     * @param  {number?} genesisRequest.value satoshi value to send alongside with tokens; if undefined will default to 1000 satoshi\n     * @param  {SendRequestType | SendRequestType[]} sendRequests single or an array of extra send requests (OP_RETURN, value transfer, etc.) to include in genesis transaction\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     */\n    async tokenGenesis(genesisRequest, sendRequests = [], options) {\n        if (!Array.isArray(sendRequests)) {\n            sendRequests = [sendRequests];\n        }\n        let utxos;\n        if (options && options.utxoIds) {\n            utxos = await checkUtxos(options.utxoIds.map((utxoId) => typeof utxoId === \"string\" ? fromUtxoId(utxoId) : utxoId), this);\n        }\n        else {\n            utxos = await this.getAddressUtxos(this.cashaddr);\n        }\n        const genesisInputs = utxos.filter((val) => val.vout === 0 && !val.token);\n        if (genesisInputs.length === 0) {\n            throw new Error(\"No suitable inputs with vout=0 available for new token genesis\");\n        }\n        const genesisSendRequest = new TokenSendRequest({\n            cashaddr: genesisRequest.cashaddr || this.tokenaddr,\n            amount: genesisRequest.amount,\n            value: genesisRequest.value || 1000,\n            capability: genesisRequest.capability,\n            commitment: genesisRequest.commitment,\n            tokenId: genesisInputs[0].txid,\n        });\n        return this.send([genesisSendRequest, ...sendRequests], {\n            ...options,\n            utxoIds: utxos,\n            ensureUtxos: [genesisInputs[0]],\n            checkTokenQuantities: false,\n            queryBalance: false,\n            tokenOperation: \"genesis\",\n        });\n    }\n    /**\n     * Mint new NFT cashtokens using an existing minting token\n     * Refer to spec https://github.com/bitjson/cashtokens\n     * @param  {string} tokenId tokenId of an NFT to mint\n     * @param  {TokenMintRequest | TokenMintRequest[]} mintRequests mint requests with new token properties and recipients\n     * @param  {NFTCapability?} mintRequest.capability capability of new NFT\n     * @param  {string?} mintRequest.commitment NFT commitment message\n     * @param  {string?} mintRequest.cashaddr cash address to send the created token UTXO to; if undefined will default to your address\n     * @param  {number?} mintRequest.value satoshi value to send alongside with tokens; if undefined will default to 1000 satoshi\n     * @param  {boolean?} deductTokenAmount if minting token contains fungible amount, deduct from it by amount of minted tokens\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     */\n    async tokenMint(tokenId, mintRequests, deductTokenAmount = false, options) {\n        if (tokenId?.length !== 64) {\n            throw Error(`Invalid tokenId supplied: ${tokenId}`);\n        }\n        if (!Array.isArray(mintRequests)) {\n            mintRequests = [mintRequests];\n        }\n        const utxos = await this.getAddressUtxos(this.cashaddr);\n        const nftUtxos = utxos.filter((val) => val.token?.tokenId === tokenId &&\n            val.token?.capability === NFTCapability.minting);\n        if (!nftUtxos.length) {\n            throw new Error(\"You do not have any token UTXOs with minting capability for specified tokenId\");\n        }\n        const newAmount = deductTokenAmount && nftUtxos[0].token.amount > 0\n            ? nftUtxos[0].token.amount - BigInt(mintRequests.length)\n            : nftUtxos[0].token.amount;\n        const safeNewAmount = newAmount < 0n ? 0n : newAmount;\n        const mintingInput = new TokenSendRequest({\n            cashaddr: this.tokenaddr,\n            tokenId: tokenId,\n            capability: nftUtxos[0].token.capability,\n            commitment: nftUtxos[0].token.commitment,\n            amount: safeNewAmount,\n            value: nftUtxos[0].satoshis,\n        });\n        return this.send([\n            mintingInput,\n            ...mintRequests.map((val) => new TokenSendRequest({\n                cashaddr: val.cashaddr || this.tokenaddr,\n                amount: 0,\n                tokenId: tokenId,\n                value: val.value,\n                capability: val.capability,\n                commitment: val.commitment,\n            })),\n        ], {\n            ...options,\n            ensureUtxos: [nftUtxos[0]],\n            checkTokenQuantities: false,\n            queryBalance: false,\n            tokenOperation: \"mint\",\n        });\n    }\n    /**\n     * Perform an explicit token burning by spending a token utxo to an OP_RETURN\n     *\n     * Behaves differently for fungible and non-fungible tokens:\n     *  * NFTs are always \"destroyed\"\n     *  * FTs' amount is reduced by the amount specified, if 0 FT amount is left and no NFT present, the token is \"destroyed\"\n     *\n     * Refer to spec https://github.com/bitjson/cashtokens\n     * @param  {string} burnRequest.tokenId tokenId of a token to burn\n     * @param  {NFTCapability} burnRequest.capability capability of the NFT token to select, optional\n     * @param  {string?} burnRequest.commitment commitment of the NFT token to select, optional\n     * @param  {number?} burnRequest.amount amount of fungible tokens to burn, optional\n     * @param  {string?} burnRequest.cashaddr address to return token and satoshi change to\n     * @param  {string?} message optional message to include in OP_RETURN\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     */\n    async tokenBurn(burnRequest, message, options) {\n        if (burnRequest.tokenId?.length !== 64) {\n            throw Error(`Invalid tokenId supplied: ${burnRequest.tokenId}`);\n        }\n        const utxos = await this.getAddressUtxos(this.cashaddr);\n        const tokenUtxos = utxos.filter((val) => val.token?.tokenId === burnRequest.tokenId &&\n            val.token?.capability === burnRequest.capability &&\n            val.token?.commitment === burnRequest.commitment);\n        if (!tokenUtxos.length) {\n            throw new Error(\"You do not have suitable token UTXOs to perform burn\");\n        }\n        const totalFungibleAmount = tokenUtxos.reduce((prev, cur) => prev + (cur.token?.amount || 0n), 0n);\n        let fungibleBurnAmount = burnRequest.amount && burnRequest.amount > 0 ? burnRequest.amount : 0n;\n        fungibleBurnAmount = BigInt(fungibleBurnAmount);\n        const hasNFT = burnRequest.capability || burnRequest.commitment;\n        let utxoIds = [];\n        let changeSendRequests;\n        if (hasNFT) {\n            // does not have FT tokens, let us destroy the token completely\n            if (totalFungibleAmount === 0n) {\n                changeSendRequests = [];\n                utxoIds.push(tokenUtxos[0]);\n            }\n            else {\n                // add utxos to spend from\n                let available = 0n;\n                for (const token of tokenUtxos.filter((val) => val.token?.amount)) {\n                    utxoIds.push(token);\n                    available += token.token.amount;\n                    if (available >= fungibleBurnAmount) {\n                        break;\n                    }\n                }\n                // if there are FT, reduce their amount\n                const newAmount = totalFungibleAmount - fungibleBurnAmount;\n                const safeNewAmount = newAmount < 0n ? 0n : newAmount;\n                changeSendRequests = [\n                    new TokenSendRequest({\n                        cashaddr: burnRequest.cashaddr || this.tokenaddr,\n                        tokenId: burnRequest.tokenId,\n                        capability: burnRequest.capability,\n                        commitment: burnRequest.commitment,\n                        amount: safeNewAmount,\n                        value: tokenUtxos[0].satoshis,\n                    }),\n                ];\n            }\n        }\n        else {\n            // if we are burning last fungible tokens, let us destroy the token completely\n            if (totalFungibleAmount === fungibleBurnAmount) {\n                changeSendRequests = [];\n                utxoIds.push(...tokenUtxos);\n            }\n            else {\n                // add utxos to spend from\n                let available = 0n;\n                for (const token of tokenUtxos.filter((val) => val.token?.amount)) {\n                    utxoIds.push(token);\n                    available += token.token.amount;\n                    if (available >= fungibleBurnAmount) {\n                        break;\n                    }\n                }\n                // reduce the FT amount\n                const newAmount = available - fungibleBurnAmount;\n                const safeNewAmount = newAmount < 0n ? 0n : newAmount;\n                changeSendRequests = [\n                    new TokenSendRequest({\n                        cashaddr: burnRequest.cashaddr || this.tokenaddr,\n                        tokenId: burnRequest.tokenId,\n                        amount: safeNewAmount,\n                        value: tokenUtxos.reduce((a, c) => a + c.satoshis, 0),\n                    }),\n                ];\n            }\n        }\n        const opReturn = OpReturnData.fromString(message || \"\");\n        return this.send([opReturn, ...changeSendRequests], {\n            ...options,\n            checkTokenQuantities: false,\n            queryBalance: false,\n            ensureUtxos: utxoIds.length > 0 ? utxoIds : undefined,\n            tokenOperation: \"burn\",\n        });\n    }\n    /**\n     * getTokenUtxos Get unspent token outputs for the wallet\n     * will return utxos only for the specified token if `tokenId` provided\n     * @param  {string?} tokenId tokenId (category) to filter utxos by, if not set will return utxos from all tokens\n     * @returns  {UtxoI[]} token utxos\n     */\n    async getTokenUtxos(tokenId) {\n        const utxos = await this.getAddressUtxos(this.cashaddr);\n        return utxos.filter((val) => tokenId ? val.token?.tokenId === tokenId : val.token);\n    }\n    /**\n     * getTokenBalance Gets fungible token balance\n     * for NFT token balance see @ref getNftTokenBalance\n     * @param  {string} tokenId tokenId to get balance for\n     * @returns  {bigint} fungible token balance\n     */\n    async getTokenBalance(tokenId) {\n        const utxos = (await this.getTokenUtxos(tokenId)).filter((val) => val.token?.amount);\n        return sumTokenAmounts(utxos, tokenId);\n    }\n    /**\n     * getNftTokenBalance Gets non-fungible token (NFT) balance for a particular tokenId\n     * disregards fungible token balances\n     * for fungible token balance see @ref getTokenBalance\n     * @param  {string} tokenId tokenId to get balance for\n     * @returns  {number} non-fungible token balance\n     */\n    async getNftTokenBalance(tokenId) {\n        const utxos = (await this.getTokenUtxos(tokenId)).filter((val) => val.token?.commitment !== undefined);\n        return utxos.length;\n    }\n    /**\n     * getAllTokenBalances Gets all fungible token balances in this wallet\n     * @returns  {Object} a map [tokenId => balance] for all tokens in this wallet\n     */\n    async getAllTokenBalances() {\n        const result = {};\n        const utxos = (await this.getTokenUtxos()).filter((val) => val.token?.amount);\n        for (const utxo of utxos) {\n            if (!result[utxo.token.tokenId]) {\n                result[utxo.token.tokenId] = 0n;\n            }\n            result[utxo.token.tokenId] += utxo.token.amount;\n        }\n        return result;\n    }\n    /**\n     * getAllNftTokenBalances Gets all non-fungible token (NFT) balances in this wallet\n     * @returns  {Object} a map [tokenId => balance] for all NFTs in this wallet\n     */\n    async getAllNftTokenBalances() {\n        const result = {};\n        const utxos = (await this.getTokenUtxos()).filter((val) => val.token?.commitment !== undefined);\n        for (const utxo of utxos) {\n            if (!result[utxo.token.tokenId]) {\n                result[utxo.token.tokenId] = 0;\n            }\n            result[utxo.token.tokenId] += 1;\n        }\n        return result;\n    }\n}\n/**\n * Class to manage a mainnet watch wallet.\n */\nexport class WatchWallet extends BaseWallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.mainnet; }\n    static { this.walletType = WalletTypeEnum.Watch; }\n    constructor() {\n        super(NetworkType.Mainnet);\n    }\n}\n/**\n * Class to manage a testnet watch wallet.\n */\nexport class TestNetWatchWallet extends BaseWallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.testnet; }\n    static { this.walletType = WalletTypeEnum.Watch; }\n    constructor() {\n        super(NetworkType.Testnet);\n    }\n}\n/**\n * Class to manage a regtest watch wallet.\n */\nexport class RegTestWatchWallet extends BaseWallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.regtest; }\n    static { this.walletType = WalletTypeEnum.Watch; }\n    constructor() {\n        super(NetworkType.Regtest);\n    }\n}\n/**\n * _checkContextSafety (internal) if running in nodejs, will disable saving\n * mainnet wallets on public servers if ALLOW_MAINNET_USER_WALLETS is set to false\n * @param {BaseWallet} wallet        a wallet\n */\nconst _checkContextSafety = function (wallet) {\n    if (getRuntimePlatform() === \"node\") {\n        if (process.env.ALLOW_MAINNET_USER_WALLETS === `false`) {\n            if (wallet.network === NetworkType.Mainnet) {\n                throw Error(`Refusing to save wallet in an open public database, remove ALLOW_MAINNET_USER_WALLETS=\"false\", if this service is secure and private`);\n            }\n        }\n    }\n};\n/**\n * getNamedWalletId - get the full wallet id from the database\n *\n * @param name   user friendly wallet alias\n * @param dbName name under which the wallet will be stored in the database\n *\n * @returns boolean\n */\nexport async function getNamedWalletId(name, dbName) {\n    if (name.length === 0) {\n        throw Error(\"Named wallets must have a non-empty name\");\n    }\n    dbName = dbName ? dbName : dbName;\n    let db = getStorageProvider(dbName);\n    if (db) {\n        await db.init();\n        let savedWalletRecord = await db.getWallet(name);\n        await db.close();\n        if (savedWalletRecord !== undefined) {\n            return savedWalletRecord.wallet;\n        }\n        else {\n            throw Error(`No record was found for ${name} in db: ${dbName}`);\n        }\n    }\n    else {\n        throw Error(\"No database was available or configured to store the named wallet.\");\n    }\n}\nfunction getStorageProvider(dbName) {\n    if (!BaseWallet.StorageProvider) {\n        return undefined;\n    }\n    return new BaseWallet.StorageProvider(dbName);\n}\n//# sourceMappingURL=Base.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n/** Checks if something is Uint8Array. Be careful: nodejs Buffer will return true. */\nexport function isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n/** Asserts something is positive integer. */\nexport function anumber(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error('positive integer expected, got ' + n);\n}\n/** Asserts something is Uint8Array. */\nexport function abytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\n/** Asserts something is hash */\nexport function ahash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.createHasher');\n    anumber(h.outputLen);\n    anumber(h.blockLen);\n}\n/** Asserts a hash instance has not been destroyed / finished */\nexport function aexists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\n/** Asserts output is properly-sized byte array */\nexport function aoutput(out, instance) {\n    abytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error('digestInto() expects output buffer of length at least ' + min);\n    }\n}\n/** Cast u8 / u16 / u32 to u8. */\nexport function u8(arr) {\n    return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** Cast u8 / u16 / u32 to u32. */\nexport function u32(arr) {\n    return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n/** Zeroize a byte array. Warning: JS provides no guarantees. */\nexport function clean(...arrays) {\n    for (let i = 0; i < arrays.length; i++) {\n        arrays[i].fill(0);\n    }\n}\n/** Create DataView of an array for easy byte-level manipulation. */\nexport function createView(arr) {\n    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** The rotate right (circular right shift) operation for uint32 */\nexport function rotr(word, shift) {\n    return (word << (32 - shift)) | (word >>> shift);\n}\n/** The rotate left (circular left shift) operation for uint32 */\nexport function rotl(word, shift) {\n    return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexport const isLE = /* @__PURE__ */ (() => new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n/** The byte swap operation for uint32 */\nexport function byteSwap(word) {\n    return (((word << 24) & 0xff000000) |\n        ((word << 8) & 0xff0000) |\n        ((word >>> 8) & 0xff00) |\n        ((word >>> 24) & 0xff));\n}\n/** Conditionally byte swap if on a big-endian platform */\nexport const swap8IfBE = isLE\n    ? (n) => n\n    : (n) => byteSwap(n);\n/** @deprecated */\nexport const byteSwapIfBE = swap8IfBE;\n/** In place byte swap for Uint32Array */\nexport function byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n    return arr;\n}\nexport const swap32IfBE = isLE\n    ? (u) => u\n    : byteSwap32;\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\nconst hasHexBuiltin = /* @__PURE__ */ (() => \n// @ts-ignore\ntypeof Uint8Array.from([]).toHex === 'function' && typeof Uint8Array.fromHex === 'function')();\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * Convert byte array to hex string. Uses built-in function, when available.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return bytes.toHex();\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * Convert hex string to byte array. Uses built-in function, when available.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // @ts-ignore\n    if (hasHexBuiltin)\n        return Uint8Array.fromHex(hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nexport const nextTick = async () => { };\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * Converts string to bytes using UTF8 encoding.\n * @example utf8ToBytes('abc') // Uint8Array.from([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error('string expected');\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Converts bytes to string using UTF8 encoding.\n * @example bytesToUtf8(Uint8Array.from([97, 98, 99])) // 'abc'\n */\nexport function bytesToUtf8(bytes) {\n    return new TextDecoder().decode(bytes);\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    abytes(data);\n    return data;\n}\n/**\n * Helper for KDFs: consumes uint8array or string.\n * When string is passed, does utf8 decoding, using TextDecoder.\n */\nexport function kdfInputToBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    abytes(data);\n    return data;\n}\n/** Copies several Uint8Arrays into one. */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n        throw new Error('options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\n/** For runtime check if class implements interface */\nexport class Hash {\n}\n/** Wraps hash function, creating an interface on top of it */\nexport function createHasher(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function createOptHasher(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function createXOFer(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport const wrapConstructor = createHasher;\nexport const wrapConstructorWithOpts = createOptHasher;\nexport const wrapXOFConstructorWithOpts = createXOFer;\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    // Legacy Node.js compatibility\n    if (crypto && typeof crypto.randomBytes === 'function') {\n        return Uint8Array.from(crypto.randomBytes(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","/**\n * HMAC: RFC2104 message authentication code.\n * @module\n */\nimport { abytes, aexists, ahash, clean, Hash, toBytes } from \"./utils.js\";\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        ahash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        clean(pad);\n    }\n    update(buf) {\n        aexists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        aexists(this);\n        abytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    clone() {\n        return this._cloneInto();\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n * @example\n * import { hmac } from '@noble/hashes/hmac';\n * import { sha256 } from '@noble/hashes/sha2';\n * const mac1 = hmac(sha256, 'key', 'message');\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/**\n * PBKDF (RFC 2898). Can be used to create a key from password and salt.\n * @module\n */\nimport { hmac } from \"./hmac.js\";\n// prettier-ignore\nimport { ahash, anumber, asyncLoop, checkOpts, clean, createView, Hash, kdfInputToBytes } from \"./utils.js\";\n// Common prologue and epilogue for sync/async functions\nfunction pbkdf2Init(hash, _password, _salt, _opts) {\n    ahash(hash);\n    const opts = checkOpts({ dkLen: 32, asyncTick: 10 }, _opts);\n    const { c, dkLen, asyncTick } = opts;\n    anumber(c);\n    anumber(dkLen);\n    anumber(asyncTick);\n    if (c < 1)\n        throw new Error('iterations (c) should be >= 1');\n    const password = kdfInputToBytes(_password);\n    const salt = kdfInputToBytes(_salt);\n    // DK = PBKDF2(PRF, Password, Salt, c, dkLen);\n    const DK = new Uint8Array(dkLen);\n    // U1 = PRF(Password, Salt + INT_32_BE(i))\n    const PRF = hmac.create(hash, password);\n    const PRFSalt = PRF._cloneInto().update(salt);\n    return { c, dkLen, asyncTick, DK, PRF, PRFSalt };\n}\nfunction pbkdf2Output(PRF, PRFSalt, DK, prfW, u) {\n    PRF.destroy();\n    PRFSalt.destroy();\n    if (prfW)\n        prfW.destroy();\n    clean(u);\n    return DK;\n}\n/**\n * PBKDF2-HMAC: RFC 2898 key derivation function\n * @param hash - hash function that would be used e.g. sha256\n * @param password - password from which a derived key is generated\n * @param salt - cryptographic salt\n * @param opts - {c, dkLen} where c is work factor and dkLen is output message size\n * @example\n * const key = pbkdf2(sha256, 'password', 'salt', { dkLen: 32, c: Math.pow(2, 18) });\n */\nexport function pbkdf2(hash, password, salt, opts) {\n    const { c, dkLen, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 + ⋯ + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^ ⋯ ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        for (let ui = 1; ui < c; ui++) {\n            // Uc = PRF(Password, Uc−1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        }\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\n/**\n * PBKDF2-HMAC: RFC 2898 key derivation function. Async version.\n * @example\n * await pbkdf2Async(sha256, 'password', 'salt', { dkLen: 32, c: 500_000 });\n */\nexport async function pbkdf2Async(hash, password, salt, opts) {\n    const { c, dkLen, asyncTick, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 + ⋯ + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^ ⋯ ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        await asyncLoop(c - 1, asyncTick, () => {\n            // Uc = PRF(Password, Uc−1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        });\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\n//# sourceMappingURL=pbkdf2.js.map","/**\n * Internal Merkle-Damgard hash utils.\n * @module\n */\nimport { Hash, abytes, aexists, aoutput, clean, createView, toBytes } from \"./utils.js\";\n/** Polyfill for Safari 14. https://caniuse.com/mdn-javascript_builtins_dataview_setbiguint64 */\nexport function setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n/** Choice: a ? b : c */\nexport function Chi(a, b, c) {\n    return (a & b) ^ (~a & c);\n}\n/** Majority function, true if any two inputs is true. */\nexport function Maj(a, b, c) {\n    return (a & b) ^ (a & c) ^ (b & c);\n}\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport class HashMD extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        aexists(this);\n        data = toBytes(data);\n        abytes(data);\n        const { view, buffer, blockLen } = this;\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        aexists(this);\n        aoutput(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        clean(this.buffer.subarray(pos));\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.destroyed = destroyed;\n        to.finished = finished;\n        to.length = length;\n        to.pos = pos;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n    clone() {\n        return this._cloneInto();\n    }\n}\n/**\n * Initial SHA-2 state: fractional parts of square roots of first 16 primes 2..53.\n * Check out `test/misc/sha2-gen-iv.js` for recomputation guide.\n */\n/** Initial SHA256 state. Bits 0..32 of frac part of sqrt of primes 2..19 */\nexport const SHA256_IV = /* @__PURE__ */ Uint32Array.from([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19,\n]);\n/** Initial SHA224 state. Bits 32..64 of frac part of sqrt of primes 23..53 */\nexport const SHA224_IV = /* @__PURE__ */ Uint32Array.from([\n    0xc1059ed8, 0x367cd507, 0x3070dd17, 0xf70e5939, 0xffc00b31, 0x68581511, 0x64f98fa7, 0xbefa4fa4,\n]);\n/** Initial SHA384 state. Bits 0..64 of frac part of sqrt of primes 23..53 */\nexport const SHA384_IV = /* @__PURE__ */ Uint32Array.from([\n    0xcbbb9d5d, 0xc1059ed8, 0x629a292a, 0x367cd507, 0x9159015a, 0x3070dd17, 0x152fecd8, 0xf70e5939,\n    0x67332667, 0xffc00b31, 0x8eb44a87, 0x68581511, 0xdb0c2e0d, 0x64f98fa7, 0x47b5481d, 0xbefa4fa4,\n]);\n/** Initial SHA512 state. Bits 0..64 of frac part of sqrt of primes 2..19 */\nexport const SHA512_IV = /* @__PURE__ */ Uint32Array.from([\n    0x6a09e667, 0xf3bcc908, 0xbb67ae85, 0x84caa73b, 0x3c6ef372, 0xfe94f82b, 0xa54ff53a, 0x5f1d36f1,\n    0x510e527f, 0xade682d1, 0x9b05688c, 0x2b3e6c1f, 0x1f83d9ab, 0xfb41bd6b, 0x5be0cd19, 0x137e2179,\n]);\n//# sourceMappingURL=_md.js.map","/**\n * Internal helpers for u64. BigUint64Array is too slow as per 2025, so we implement it using Uint32Array.\n * @todo re-check https://issues.chromium.org/issues/42212588\n * @module\n */\nconst U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    const len = lst.length;\n    let Ah = new Uint32Array(len);\n    let Al = new Uint32Array(len);\n    for (let i = 0; i < len; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { add, add3H, add3L, add4H, add4L, add5H, add5L, fromBig, rotlBH, rotlBL, rotlSH, rotlSL, rotr32H, rotr32L, rotrBH, rotrBL, rotrSH, rotrSL, shrSH, shrSL, split, toBig };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","/**\n * SHA2 hash function. A.k.a. sha256, sha384, sha512, sha512_224, sha512_256.\n * SHA256 is the fastest hash implementable in JS, even faster than Blake3.\n * Check out [RFC 4634](https://datatracker.ietf.org/doc/html/rfc4634) and\n * [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).\n * @module\n */\nimport { Chi, HashMD, Maj, SHA224_IV, SHA256_IV, SHA384_IV, SHA512_IV } from \"./_md.js\";\nimport * as u64 from \"./_u64.js\";\nimport { clean, createHasher, rotr } from \"./utils.js\";\n/**\n * Round constants:\n * First 32 bits of fractional parts of the cube roots of the first 64 primes 2..311)\n */\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ Uint32Array.from([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n/** Reusable temporary buffer. \"W\" comes straight from spec. */\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nexport class SHA256 extends HashMD {\n    constructor(outputLen = 32) {\n        super(64, outputLen, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = SHA256_IV[0] | 0;\n        this.B = SHA256_IV[1] | 0;\n        this.C = SHA256_IV[2] | 0;\n        this.D = SHA256_IV[3] | 0;\n        this.E = SHA256_IV[4] | 0;\n        this.F = SHA256_IV[5] | 0;\n        this.G = SHA256_IV[6] | 0;\n        this.H = SHA256_IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        clean(SHA256_W);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        clean(this.buffer);\n    }\n}\nexport class SHA224 extends SHA256 {\n    constructor() {\n        super(28);\n        this.A = SHA224_IV[0] | 0;\n        this.B = SHA224_IV[1] | 0;\n        this.C = SHA224_IV[2] | 0;\n        this.D = SHA224_IV[3] | 0;\n        this.E = SHA224_IV[4] | 0;\n        this.F = SHA224_IV[5] | 0;\n        this.G = SHA224_IV[6] | 0;\n        this.H = SHA224_IV[7] | 0;\n    }\n}\n// SHA2-512 is slower than sha256 in js because u64 operations are slow.\n// Round contants\n// First 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409\n// prettier-ignore\nconst K512 = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\nconst SHA512_Kh = /* @__PURE__ */ (() => K512[0])();\nconst SHA512_Kl = /* @__PURE__ */ (() => K512[1])();\n// Reusable temporary buffers\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nexport class SHA512 extends HashMD {\n    constructor(outputLen = 64) {\n        super(128, outputLen, 16, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = SHA512_IV[0] | 0;\n        this.Al = SHA512_IV[1] | 0;\n        this.Bh = SHA512_IV[2] | 0;\n        this.Bl = SHA512_IV[3] | 0;\n        this.Ch = SHA512_IV[4] | 0;\n        this.Cl = SHA512_IV[5] | 0;\n        this.Dh = SHA512_IV[6] | 0;\n        this.Dl = SHA512_IV[7] | 0;\n        this.Eh = SHA512_IV[8] | 0;\n        this.El = SHA512_IV[9] | 0;\n        this.Fh = SHA512_IV[10] | 0;\n        this.Fl = SHA512_IV[11] | 0;\n        this.Gh = SHA512_IV[12] | 0;\n        this.Gl = SHA512_IV[13] | 0;\n        this.Hh = SHA512_IV[14] | 0;\n        this.Hl = SHA512_IV[15] | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        clean(SHA512_W_H, SHA512_W_L);\n    }\n    destroy() {\n        clean(this.buffer);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nexport class SHA384 extends SHA512 {\n    constructor() {\n        super(48);\n        this.Ah = SHA384_IV[0] | 0;\n        this.Al = SHA384_IV[1] | 0;\n        this.Bh = SHA384_IV[2] | 0;\n        this.Bl = SHA384_IV[3] | 0;\n        this.Ch = SHA384_IV[4] | 0;\n        this.Cl = SHA384_IV[5] | 0;\n        this.Dh = SHA384_IV[6] | 0;\n        this.Dl = SHA384_IV[7] | 0;\n        this.Eh = SHA384_IV[8] | 0;\n        this.El = SHA384_IV[9] | 0;\n        this.Fh = SHA384_IV[10] | 0;\n        this.Fl = SHA384_IV[11] | 0;\n        this.Gh = SHA384_IV[12] | 0;\n        this.Gl = SHA384_IV[13] | 0;\n        this.Hh = SHA384_IV[14] | 0;\n        this.Hl = SHA384_IV[15] | 0;\n    }\n}\n/**\n * Truncated SHA512/256 and SHA512/224.\n * SHA512_IV is XORed with 0xa5a5a5a5a5a5a5a5, then used as \"intermediary\" IV of SHA512/t.\n * Then t hashes string to produce result IV.\n * See `test/misc/sha2-gen-iv.js`.\n */\n/** SHA512/224 IV */\nconst T224_IV = /* @__PURE__ */ Uint32Array.from([\n    0x8c3d37c8, 0x19544da2, 0x73e19966, 0x89dcd4d6, 0x1dfab7ae, 0x32ff9c82, 0x679dd514, 0x582f9fcf,\n    0x0f6d2b69, 0x7bd44da8, 0x77e36f73, 0x04c48942, 0x3f9d85a8, 0x6a1d36c8, 0x1112e6ad, 0x91d692a1,\n]);\n/** SHA512/256 IV */\nconst T256_IV = /* @__PURE__ */ Uint32Array.from([\n    0x22312194, 0xfc2bf72c, 0x9f555fa3, 0xc84c64c2, 0x2393b86b, 0x6f53b151, 0x96387719, 0x5940eabd,\n    0x96283ee2, 0xa88effe3, 0xbe5e1e25, 0x53863992, 0x2b0199fc, 0x2c85b8aa, 0x0eb72ddc, 0x81c52ca2,\n]);\nexport class SHA512_224 extends SHA512 {\n    constructor() {\n        super(28);\n        this.Ah = T224_IV[0] | 0;\n        this.Al = T224_IV[1] | 0;\n        this.Bh = T224_IV[2] | 0;\n        this.Bl = T224_IV[3] | 0;\n        this.Ch = T224_IV[4] | 0;\n        this.Cl = T224_IV[5] | 0;\n        this.Dh = T224_IV[6] | 0;\n        this.Dl = T224_IV[7] | 0;\n        this.Eh = T224_IV[8] | 0;\n        this.El = T224_IV[9] | 0;\n        this.Fh = T224_IV[10] | 0;\n        this.Fl = T224_IV[11] | 0;\n        this.Gh = T224_IV[12] | 0;\n        this.Gl = T224_IV[13] | 0;\n        this.Hh = T224_IV[14] | 0;\n        this.Hl = T224_IV[15] | 0;\n    }\n}\nexport class SHA512_256 extends SHA512 {\n    constructor() {\n        super(32);\n        this.Ah = T256_IV[0] | 0;\n        this.Al = T256_IV[1] | 0;\n        this.Bh = T256_IV[2] | 0;\n        this.Bl = T256_IV[3] | 0;\n        this.Ch = T256_IV[4] | 0;\n        this.Cl = T256_IV[5] | 0;\n        this.Dh = T256_IV[6] | 0;\n        this.Dl = T256_IV[7] | 0;\n        this.Eh = T256_IV[8] | 0;\n        this.El = T256_IV[9] | 0;\n        this.Fh = T256_IV[10] | 0;\n        this.Fl = T256_IV[11] | 0;\n        this.Gh = T256_IV[12] | 0;\n        this.Gl = T256_IV[13] | 0;\n        this.Hh = T256_IV[14] | 0;\n        this.Hl = T256_IV[15] | 0;\n    }\n}\n/**\n * SHA2-256 hash function from RFC 4634.\n *\n * It is the fastest JS hash, even faster than Blake3.\n * To break sha256 using birthday attack, attackers need to try 2^128 hashes.\n * BTC network is doing 2^70 hashes/sec (2^95 hashes/year) as per 2025.\n */\nexport const sha256 = /* @__PURE__ */ createHasher(() => new SHA256());\n/** SHA2-224 hash function from RFC 4634 */\nexport const sha224 = /* @__PURE__ */ createHasher(() => new SHA224());\n/** SHA2-512 hash function from RFC 4634. */\nexport const sha512 = /* @__PURE__ */ createHasher(() => new SHA512());\n/** SHA2-384 hash function from RFC 4634. */\nexport const sha384 = /* @__PURE__ */ createHasher(() => new SHA384());\n/**\n * SHA2-512/256 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_256 = /* @__PURE__ */ createHasher(() => new SHA512_256());\n/**\n * SHA2-512/224 \"truncated\" hash function, with improved resistance to length extension attacks.\n * See the paper on [truncated SHA512](https://eprint.iacr.org/2010/548.pdf).\n */\nexport const sha512_224 = /* @__PURE__ */ createHasher(() => new SHA512_224());\n//# sourceMappingURL=sha2.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nfunction isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n/** Asserts something is Uint8Array. */\nfunction abytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\nfunction isArrayOf(isString, arr) {\n    if (!Array.isArray(arr))\n        return false;\n    if (arr.length === 0)\n        return true;\n    if (isString) {\n        return arr.every((item) => typeof item === 'string');\n    }\n    else {\n        return arr.every((item) => Number.isSafeInteger(item));\n    }\n}\n// no abytes: seems to have 10% slowdown. Why?!\nfunction afn(input) {\n    if (typeof input !== 'function')\n        throw new Error('function expected');\n    return true;\n}\nfunction astr(label, input) {\n    if (typeof input !== 'string')\n        throw new Error(`${label}: string expected`);\n    return true;\n}\nfunction anumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`invalid integer: ${n}`);\n}\nfunction aArr(input) {\n    if (!Array.isArray(input))\n        throw new Error('array expected');\n}\nfunction astrArr(label, input) {\n    if (!isArrayOf(true, input))\n        throw new Error(`${label}: array of strings expected`);\n}\nfunction anumArr(label, input) {\n    if (!isArrayOf(false, input))\n        throw new Error(`${label}: array of numbers expected`);\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction chain(...args) {\n    const id = (a) => a;\n    // Wrap call in closure so JIT can inline calls\n    const wrap = (a, b) => (c) => a(b(c));\n    // Construct chain of args[-1].encode(args[-2].encode([...]))\n    const encode = args.map((x) => x.encode).reduceRight(wrap, id);\n    // Construct chain of args[0].decode(args[1].decode(...))\n    const decode = args.map((x) => x.decode).reduce(wrap, id);\n    return { encode, decode };\n}\n/**\n * Encodes integer radix representation to array of strings using alphabet and back.\n * Could also be array of strings.\n * @__NO_SIDE_EFFECTS__\n */\nfunction alphabet(letters) {\n    // mapping 1 to \"b\"\n    const lettersA = typeof letters === 'string' ? letters.split('') : letters;\n    const len = lettersA.length;\n    astrArr('alphabet', lettersA);\n    // mapping \"b\" to 1\n    const indexes = new Map(lettersA.map((l, i) => [l, i]));\n    return {\n        encode: (digits) => {\n            aArr(digits);\n            return digits.map((i) => {\n                if (!Number.isSafeInteger(i) || i < 0 || i >= len)\n                    throw new Error(`alphabet.encode: digit index outside alphabet \"${i}\". Allowed: ${letters}`);\n                return lettersA[i];\n            });\n        },\n        decode: (input) => {\n            aArr(input);\n            return input.map((letter) => {\n                astr('alphabet.decode', letter);\n                const i = indexes.get(letter);\n                if (i === undefined)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${letters}`);\n                return i;\n            });\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction join(separator = '') {\n    astr('join', separator);\n    return {\n        encode: (from) => {\n            astrArr('join.decode', from);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            astr('join.decode', to);\n            return to.split(separator);\n        },\n    };\n}\n/**\n * Pad strings array so it has integer number of bits\n * @__NO_SIDE_EFFECTS__\n */\nfunction padding(bits, chr = '=') {\n    anumber(bits);\n    astr('padding', chr);\n    return {\n        encode(data) {\n            astrArr('padding.encode', data);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            astrArr('padding.decode', input);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('padding: invalid, string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                const last = end - 1;\n                const byte = last * bits;\n                if (byte % 8 === 0)\n                    throw new Error('padding: invalid, string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction normalize(fn) {\n    afn(fn);\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\n/**\n * Slow: O(n^2) time complexity\n */\nfunction convertRadix(data, from, to) {\n    // base 1 is impossible\n    if (from < 2)\n        throw new Error(`convertRadix: invalid from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: invalid to=${to}, base cannot be less than 2`);\n    aArr(data);\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data, (d) => {\n        anumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`invalid integer: ${d}`);\n        return d;\n    });\n    const dlen = digits.length;\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < dlen; i++) {\n            const digit = digits[i];\n            const fromCarry = from * carry;\n            const digitBase = fromCarry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                fromCarry / from !== carry ||\n                digitBase - digit !== fromCarry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            const div = digitBase / to;\n            carry = digitBase % to;\n            const rounded = Math.floor(div);\n            digits[i] = rounded;\n            if (!Number.isSafeInteger(rounded) || rounded * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!rounded)\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (b === 0 ? a : gcd(b, a % b));\nconst radix2carry = /* @__NO_SIDE_EFFECTS__ */ (from, to) => from + (to - gcd(from, to));\nconst powers = /* @__PURE__ */ (() => {\n    let res = [];\n    for (let i = 0; i < 40; i++)\n        res.push(2 ** i);\n    return res;\n})();\n/**\n * Implemented with numbers, because BigInt is 5x slower\n */\nfunction convertRadix2(data, from, to, padding) {\n    aArr(data);\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0; // bitwise position in current element\n    const max = powers[from];\n    const mask = powers[to] - 1;\n    const res = [];\n    for (const n of data) {\n        anumber(n);\n        if (n >= max)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        const pow = powers[pos];\n        if (pow === undefined)\n            throw new Error('invalid carry');\n        carry &= pow - 1; // clean carry, otherwise it will cause overflow\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry > 0)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix(num) {\n    anumber(num);\n    const _256 = 2 ** 8;\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), _256, num);\n        },\n        decode: (digits) => {\n            anumArr('radix.decode', digits);\n            return Uint8Array.from(convertRadix(digits, num, _256));\n        },\n    };\n}\n/**\n * If both bases are power of same number (like `2**8 <-> 2**64`),\n * there is a linear algorithm. For now we have implementation for power-of-two bases only.\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix2(bits, revPadding = false) {\n    anumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            anumArr('radix2.decode', digits);\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    afn(fn);\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    anumber(len);\n    afn(fn);\n    return {\n        encode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const sum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(sum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const oldChecksum = data.slice(-len);\n            const newChecksum = fn(payload).slice(0, len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\n// prettier-ignore\nexport const utils = {\n    alphabet, chain, checksum, convertRadix, convertRadix2, radix, radix2, join, padding,\n};\n// RFC 4648 aka RFC 3548\n// ---------------------\n/**\n * base16 encoding from RFC 4648.\n * @example\n * ```js\n * base16.encode(Uint8Array.from([0x12, 0xab]));\n * // => '12AB'\n * ```\n */\nexport const base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\n/**\n * base32 encoding from RFC 4648. Has padding.\n * Use `base32nopad` for unpadded version.\n * Also check out `base32hex`, `base32hexnopad`, `base32crockford`.\n * @example\n * ```js\n * base32.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'CKVQ===='\n * base32.decode('CKVQ====');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\n/**\n * base32 encoding from RFC 4648. No padding.\n * Use `base32` for padded version.\n * Also check out `base32hex`, `base32hexnopad`, `base32crockford`.\n * @example\n * ```js\n * base32nopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'CKVQ'\n * base32nopad.decode('CKVQ');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32nopad = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), join(''));\n/**\n * base32 encoding from RFC 4648. Padded. Compared to ordinary `base32`, slightly different alphabet.\n * Use `base32hexnopad` for unpadded version.\n * @example\n * ```js\n * base32hex.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ALG===='\n * base32hex.decode('2ALG====');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\n/**\n * base32 encoding from RFC 4648. No padding. Compared to ordinary `base32`, slightly different alphabet.\n * Use `base32hex` for padded version.\n * @example\n * ```js\n * base32hexnopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ALG'\n * base32hexnopad.decode('2ALG');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32hexnopad = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), join(''));\n/**\n * base32 encoding from RFC 4648. Doug Crockford's version.\n * https://www.crockford.com/base32.html\n * @example\n * ```js\n * base32crockford.encode(Uint8Array.from([0x12, 0xab]));\n * // => '2ANG'\n * base32crockford.decode('2ANG');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\n// Built-in base64 conversion https://caniuse.com/mdn-javascript_builtins_uint8array_frombase64\n// prettier-ignore\nconst hasBase64Builtin = /* @__PURE__ */ (() => typeof Uint8Array.from([]).toBase64 === 'function' &&\n    typeof Uint8Array.fromBase64 === 'function')();\nconst decodeBase64Builtin = (s, isUrl) => {\n    astr('base64', s);\n    const re = isUrl ? /^[A-Za-z0-9=_-]+$/ : /^[A-Za-z0-9=+/]+$/;\n    const alphabet = isUrl ? 'base64url' : 'base64';\n    if (s.length > 0 && !re.test(s))\n        throw new Error('invalid base64');\n    return Uint8Array.fromBase64(s, { alphabet, lastChunkHandling: 'strict' });\n};\n/**\n * base64 from RFC 4648. Padded.\n * Use `base64nopad` for unpadded version.\n * Also check out `base64url`, `base64urlnopad`.\n * Falls back to built-in function, when available.\n * @example\n * ```js\n * base64.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs='\n * base64.decode('Eqs=');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\n// prettier-ignore\nexport const base64 = hasBase64Builtin ? {\n    encode(b) { abytes(b); return b.toBase64(); },\n    decode(s) { return decodeBase64Builtin(s, false); },\n} : chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\n/**\n * base64 from RFC 4648. No padding.\n * Use `base64` for padded version.\n * @example\n * ```js\n * base64nopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs'\n * base64nopad.decode('Eqs');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base64nopad = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), join(''));\n/**\n * base64 from RFC 4648, using URL-safe alphabet. Padded.\n * Use `base64urlnopad` for unpadded version.\n * Falls back to built-in function, when available.\n * @example\n * ```js\n * base64url.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs='\n * base64url.decode('Eqs=');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\n// prettier-ignore\nexport const base64url = hasBase64Builtin ? {\n    encode(b) { abytes(b); return b.toBase64({ alphabet: 'base64url' }); },\n    decode(s) { return decodeBase64Builtin(s, true); },\n} : chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\n/**\n * base64 from RFC 4648, using URL-safe alphabet. No padding.\n * Use `base64url` for padded version.\n * @example\n * ```js\n * base64urlnopad.encode(Uint8Array.from([0x12, 0xab]));\n * // => 'Eqs'\n * base64urlnopad.decode('Eqs');\n * // => Uint8Array.from([0x12, 0xab])\n * ```\n */\nexport const base64urlnopad = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), join(''));\n// base58 code\n// -----------\nconst genBase58 = /* @__NO_SIDE_EFFECTS__ */ (abc) => chain(radix(58), alphabet(abc), join(''));\n/**\n * base58: base64 without ambigous characters +, /, 0, O, I, l.\n * Quadratic (O(n^2)) - so, can't be used on large inputs.\n * @example\n * ```js\n * base58.decode('01abcdef');\n * // => '3UhJW'\n * ```\n */\nexport const base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\n/**\n * base58: flickr version. Check out `base58`.\n */\nexport const base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\n/**\n * base58: XRP version. Check out `base58`.\n */\nexport const base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\n// Data len (index) -> encoded block len\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\n/**\n * base58: XMR version. Check out `base58`.\n * Done in 8-byte blocks (which equals 11 chars in decoding). Last (non-full) block padded with '1' to size in XMR_BLOCK_LEN.\n * Block encoding significantly reduces quadratic complexity of base58.\n */\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\n/**\n * Method, which creates base58check encoder.\n * Requires function, calculating sha256.\n */\nexport const createBase58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\n/**\n * Use `createBase58check` instead.\n * @deprecated\n */\nexport const base58check = createBase58check;\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % powers[30]], 30, 5, false));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        astr('bech32.encode prefix', prefix);\n        if (isBytes(words))\n            words = Array.from(words);\n        anumArr('bech32.encode', words);\n        const plen = prefix.length;\n        if (plen === 0)\n            throw new TypeError(`Invalid prefix length ${plen}`);\n        const actualLength = plen + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        const lowered = prefix.toLowerCase();\n        const sum = bechChecksum(lowered, words, ENCODING_CONST);\n        return `${lowered}1${BECH_ALPHABET.encode(words)}${sum}`;\n    }\n    function decode(str, limit = 90) {\n        astr('bech32.decode input', str);\n        const slen = str.length;\n        if (slen < 8 || (limit !== false && slen > limit))\n            throw new TypeError(`invalid string length: ${slen} (${str}). Expected (8..${limit})`);\n        // don't allow mixed case\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        const sepIndex = lowered.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = lowered.slice(0, sepIndex);\n        const data = lowered.slice(sepIndex + 1);\n        if (data.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(data).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!data.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    function encodeFromBytes(prefix, bytes) {\n        return encode(prefix, toWords(bytes));\n    }\n    return {\n        encode,\n        decode,\n        encodeFromBytes,\n        decodeToBytes,\n        decodeUnsafe,\n        fromWords,\n        fromWordsUnsafe,\n        toWords,\n    };\n}\n/**\n * bech32 from BIP 173. Operates on words.\n * For high-level, check out scure-btc-signer:\n * https://github.com/paulmillr/scure-btc-signer.\n */\nexport const bech32 = genBech32('bech32');\n/**\n * bech32m from BIP 350. Operates on words.\n * It was to mitigate `bech32` weaknesses.\n * For high-level, check out scure-btc-signer:\n * https://github.com/paulmillr/scure-btc-signer.\n */\nexport const bech32m = genBech32('bech32m');\n/**\n * UTF-8-to-byte decoder. Uses built-in TextDecoder / TextEncoder.\n * @example\n * ```js\n * const b = utf8.decode(\"hey\"); // => new Uint8Array([ 104, 101, 121 ])\n * const str = utf8.encode(b); // \"hey\"\n * ```\n */\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\n// Built-in hex conversion https://caniuse.com/mdn-javascript_builtins_uint8array_fromhex\n// prettier-ignore\nconst hasHexBuiltin = /* @__PURE__ */ (() => typeof Uint8Array.from([]).toHex === 'function' &&\n    typeof Uint8Array.fromHex === 'function')();\n// prettier-ignore\nconst hexBuiltin = {\n    encode(data) { abytes(data); return data.toHex(); },\n    decode(s) { astr('hex', s); return Uint8Array.fromHex(s); },\n};\n/**\n * hex string decoder. Uses built-in function, when available.\n * @example\n * ```js\n * const b = hex.decode(\"0102ff\"); // => new Uint8Array([ 1, 2, 255 ])\n * const str = hex.encode(b); // \"0102ff\"\n * ```\n */\nexport const hex = hasHexBuiltin\n    ? hexBuiltin\n    : chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n        if (typeof s !== 'string' || s.length % 2 !== 0)\n            throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n        return s.toLowerCase();\n    }));\n// prettier-ignore\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = 'Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr';\n/** @deprecated */\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!isBytes(bytes))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\n/** @deprecated */\nexport const str = bytesToString; // as in python, but for bytes only\n/** @deprecated */\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\n/** @deprecated */\nexport const bytes = stringToBytes;\n//# sourceMappingURL=index.js.map","/**\n * Audited & minimal JS implementation of\n * [BIP39 mnemonic phrases](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki).\n * @module\n * @example\n```js\nimport * as bip39 from '@scure/bip39';\nimport { wordlist } from '@scure/bip39/wordlists/english';\nconst mn = bip39.generateMnemonic(wordlist);\nconsole.log(mn);\nconst ent = bip39.mnemonicToEntropy(mn, wordlist)\nbip39.entropyToMnemonic(ent, wordlist);\nbip39.validateMnemonic(mn, wordlist);\nawait bip39.mnemonicToSeed(mn, 'password');\nbip39.mnemonicToSeedSync(mn, 'password');\n\n// Wordlists\nimport { wordlist as czech } from '@scure/bip39/wordlists/czech';\nimport { wordlist as english } from '@scure/bip39/wordlists/english';\nimport { wordlist as french } from '@scure/bip39/wordlists/french';\nimport { wordlist as italian } from '@scure/bip39/wordlists/italian';\nimport { wordlist as japanese } from '@scure/bip39/wordlists/japanese';\nimport { wordlist as korean } from '@scure/bip39/wordlists/korean';\nimport { wordlist as portuguese } from '@scure/bip39/wordlists/portuguese';\nimport { wordlist as simplifiedChinese } from '@scure/bip39/wordlists/simplified-chinese';\nimport { wordlist as spanish } from '@scure/bip39/wordlists/spanish';\nimport { wordlist as traditionalChinese } from '@scure/bip39/wordlists/traditional-chinese';\n```\n */\n/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */\nimport { pbkdf2, pbkdf2Async } from '@noble/hashes/pbkdf2';\nimport { sha256, sha512 } from '@noble/hashes/sha2';\nimport { abytes, anumber, randomBytes } from '@noble/hashes/utils';\nimport { utils as baseUtils } from '@scure/base';\n// Japanese wordlist\nconst isJapanese = (wordlist) => wordlist[0] === '\\u3042\\u3044\\u3053\\u304f\\u3057\\u3093';\n// Normalization replaces equivalent sequences of characters\n// so that any two texts that are equivalent will be reduced\n// to the same sequence of code points, called the normal form of the original text.\n// https://tonsky.me/blog/unicode/#why-is-a----\nfunction nfkd(str) {\n    if (typeof str !== 'string')\n        throw new TypeError('invalid mnemonic type: ' + typeof str);\n    return str.normalize('NFKD');\n}\nfunction normalize(str) {\n    const norm = nfkd(str);\n    const words = norm.split(' ');\n    if (![12, 15, 18, 21, 24].includes(words.length))\n        throw new Error('Invalid mnemonic');\n    return { nfkd: norm, words };\n}\nfunction aentropy(ent) {\n    abytes(ent, 16, 20, 24, 28, 32);\n}\n/**\n * Generate x random words. Uses Cryptographically-Secure Random Number Generator.\n * @param wordlist imported wordlist for specific language\n * @param strength mnemonic strength 128-256 bits\n * @example\n * generateMnemonic(wordlist, 128)\n * // 'legal winner thank year wave sausage worth useful legal winner thank yellow'\n */\nexport function generateMnemonic(wordlist, strength = 128) {\n    anumber(strength);\n    if (strength % 32 !== 0 || strength > 256)\n        throw new TypeError('Invalid entropy');\n    return entropyToMnemonic(randomBytes(strength / 8), wordlist);\n}\nconst calcChecksum = (entropy) => {\n    // Checksum is ent.length/4 bits long\n    const bitsLeft = 8 - entropy.length / 4;\n    // Zero rightmost \"bitsLeft\" bits in byte\n    // For example: bitsLeft=4 val=10111101 -> 10110000\n    return new Uint8Array([(sha256(entropy)[0] >> bitsLeft) << bitsLeft]);\n};\nfunction getCoder(wordlist) {\n    if (!Array.isArray(wordlist) || wordlist.length !== 2048 || typeof wordlist[0] !== 'string')\n        throw new Error('Wordlist: expected array of 2048 strings');\n    wordlist.forEach((i) => {\n        if (typeof i !== 'string')\n            throw new Error('wordlist: non-string element: ' + i);\n    });\n    return baseUtils.chain(baseUtils.checksum(1, calcChecksum), baseUtils.radix2(11, true), baseUtils.alphabet(wordlist));\n}\n/**\n * Reversible: Converts mnemonic string to raw entropy in form of byte array.\n * @param mnemonic 12-24 words\n * @param wordlist imported wordlist for specific language\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * mnemonicToEntropy(mnem, wordlist)\n * // Produces\n * new Uint8Array([\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f,\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f\n * ])\n */\nexport function mnemonicToEntropy(mnemonic, wordlist) {\n    const { words } = normalize(mnemonic);\n    const entropy = getCoder(wordlist).decode(words);\n    aentropy(entropy);\n    return entropy;\n}\n/**\n * Reversible: Converts raw entropy in form of byte array to mnemonic string.\n * @param entropy byte array\n * @param wordlist imported wordlist for specific language\n * @returns 12-24 words\n * @example\n * const ent = new Uint8Array([\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f,\n *   0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f\n * ]);\n * entropyToMnemonic(ent, wordlist);\n * // 'legal winner thank year wave sausage worth useful legal winner thank yellow'\n */\nexport function entropyToMnemonic(entropy, wordlist) {\n    aentropy(entropy);\n    const words = getCoder(wordlist).encode(entropy);\n    return words.join(isJapanese(wordlist) ? '\\u3000' : ' ');\n}\n/**\n * Validates mnemonic for being 12-24 words contained in `wordlist`.\n */\nexport function validateMnemonic(mnemonic, wordlist) {\n    try {\n        mnemonicToEntropy(mnemonic, wordlist);\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\nconst psalt = (passphrase) => nfkd('mnemonic' + passphrase);\n/**\n * Irreversible: Uses KDF to derive 64 bytes of key data from mnemonic + optional password.\n * @param mnemonic 12-24 words\n * @param passphrase string that will additionally protect the key\n * @returns 64 bytes of key data\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * await mnemonicToSeed(mnem, 'password');\n * // new Uint8Array([...64 bytes])\n */\nexport function mnemonicToSeed(mnemonic, passphrase = '') {\n    return pbkdf2Async(sha512, normalize(mnemonic).nfkd, psalt(passphrase), { c: 2048, dkLen: 64 });\n}\n/**\n * Irreversible: Uses KDF to derive 64 bytes of key data from mnemonic + optional password.\n * @param mnemonic 12-24 words\n * @param passphrase string that will additionally protect the key\n * @returns 64 bytes of key data\n * @example\n * const mnem = 'legal winner thank year wave sausage worth useful legal winner thank yellow';\n * mnemonicToSeedSync(mnem, 'password');\n * // new Uint8Array([...64 bytes])\n */\nexport function mnemonicToSeedSync(mnemonic, passphrase = '') {\n    return pbkdf2(sha512, normalize(mnemonic).nfkd, psalt(passphrase), { c: 2048, dkLen: 64 });\n}\n","import { binToHex } from \"@bitauth/libauth\";\nexport function checkForEmptySeed(seed) {\n    let blankSeed = \"4ed8d4b17698ddeaa1f1559f152f87b5d472f725ca86d341bd0276f1b61197e21dd5a391f9f5ed7340ff4d4513aab9cce44f9497a5e7ed85fd818876b6eb402e\";\n    let seedBin = new Uint8Array(seed);\n    if (blankSeed == binToHex(seedBin))\n        throw Error(\"Seed was generated using empty mnemonic\");\n}\n//# sourceMappingURL=checkForEmptySeed.js.map","import { NetworkType } from \"../enum.js\";\nexport function checkWifNetwork(walletImportFormatString, networkType) {\n    if (!(walletImportFormatString[0] === \"L\" || walletImportFormatString[0] === \"K\") &&\n        networkType === NetworkType.Mainnet) {\n        throw Error(`Mainnet type wif ${walletImportFormatString} passed, should start with L or K`);\n    }\n    else if (walletImportFormatString[0] !== \"c\" &&\n        networkType === NetworkType.Testnet) {\n        throw Error(`Testnet type wif ${walletImportFormatString} passed, should start with c`);\n    }\n}\n//# sourceMappingURL=checkWifNetwork.js.map","import { getRuntimePlatform } from \"./getRuntimePlatform.js\";\nimport crypto from \"crypto\";\nexport function generateRandomBytes(len = 32) {\n    // nodejs\n    if (getRuntimePlatform() === \"node\") {\n        return crypto.randomBytes(len);\n    }\n    // window, webworkers, service workers\n    else {\n        return window.crypto.getRandomValues(new Uint8Array(len));\n    }\n}\n//# sourceMappingURL=randomBytes.js.map","//#region Imports\nimport { encodeHdPublicKey, secp256k1 } from \"@bitauth/libauth\";\nimport { binToHex, CashAddressNetworkPrefix, decodePrivateKeyWif, deriveHdPath, deriveHdPrivateNodeFromSeed, deriveHdPublicNode, encodePrivateKeyWif, generatePrivateKey, } from \"@bitauth/libauth\";\nimport { generateMnemonic, mnemonicToSeedSync } from \"@scure/bip39\";\nimport { NetworkType } from \"../enum.js\";\nimport { WalletTypeEnum } from \"./enum.js\";\nimport { XPubKey, } from \"./model.js\";\nimport { signUnsignedTransaction } from \"../transaction/Wif.js\";\nimport { DERIVATION_PATHS } from \"../constant.js\";\nimport { SignedMessage } from \"../message/index.js\";\nimport { checkForEmptySeed } from \"../util/checkForEmptySeed.js\";\nimport { checkWifNetwork } from \"../util/checkWifNetwork.js\";\nimport { deriveCashaddr, deriveTokenaddr } from \"../util/deriveCashaddr.js\";\nimport { derivePublicKeyHash } from \"../util/derivePublicKeyHash.js\";\nimport { getXPubKey } from \"../util/getXPubKey.js\";\nimport { generateRandomBytes } from \"../util/randomBytes.js\";\nimport { Config } from \"../config.js\";\nimport { balanceResponseFromSatoshi, } from \"../util/balanceObjectFromSatoshi.js\";\nimport { BaseWallet } from \"./Base.js\";\n//#endregion Imports\n/**\n * Class to manage a bitcoin cash wallet.\n */\nexport class Wallet extends BaseWallet {\n    static { this.signedMessage = new SignedMessage(); }\n    //#region Accessors\n    // Get mnemonic and derivation path for wallet\n    getSeed() {\n        if (!this.mnemonic) {\n            throw Error(\"Wallet mnemonic seed phrase not set\");\n        }\n        if (!this.derivationPath) {\n            throw Error(\"Wallet derivation path not set\");\n        }\n        return {\n            seed: this.mnemonic,\n            derivationPath: this.derivationPath,\n            parentDerivationPath: this.parentDerivationPath,\n        };\n    }\n    // Return wallet info\n    getInfo() {\n        return {\n            cashaddr: this.cashaddr,\n            tokenaddr: this.tokenaddr,\n            isTestnet: this.isTestnet,\n            name: this.name,\n            network: this.network,\n            seed: this.mnemonic ? this.getSeed().seed : undefined,\n            derivationPath: this.mnemonic ? this.getSeed().derivationPath : undefined,\n            parentDerivationPath: this.mnemonic\n                ? this.getSeed().parentDerivationPath\n                : undefined,\n            parentXPubKey: this.parentXPubKey ? this.parentXPubKey : undefined,\n            publicKey: this.publicKey ? binToHex(this.publicKey) : undefined,\n            publicKeyHash: binToHex(this.publicKeyHash),\n            privateKey: this.privateKey ? binToHex(this.privateKey) : undefined,\n            privateKeyWif: this.privateKeyWif,\n            walletId: this.toString(),\n            walletDbEntry: this.toDbString(),\n        };\n    }\n    // returns the public key hash for an address\n    getPublicKey(hex = false) {\n        if (this.publicKey) {\n            return hex ? binToHex(this.publicKey) : this.publicKey;\n        }\n        else {\n            throw Error(\"The public key for this wallet is not known, perhaps the wallet was created to watch the *hash* of a public key? i.e. a cashaddress.\");\n        }\n    }\n    // returns the public key hash for an address\n    getPublicKeyCompressed(hex = false) {\n        if (this.publicKeyCompressed) {\n            return hex\n                ? binToHex(this.publicKeyCompressed)\n                : this.publicKeyCompressed;\n        }\n        else {\n            throw Error(\"The compressed public key for this wallet is not known, perhaps the wallet was created to watch the *hash* of a public key? i.e. a cashaddress.\");\n        }\n    }\n    //#endregion\n    //#region Constructors and Statics\n    constructor(name = \"\", network = NetworkType.Mainnet, walletType = WalletTypeEnum.Seed) {\n        super(network);\n        this.derivationPath = Config.DefaultParentDerivationPath + \"/0/0\";\n        this.parentDerivationPath = Config.DefaultParentDerivationPath;\n        this.fromId = async (walletId) => {\n            const [walletType, networkGiven, arg1, arg2] = walletId.split(\":\");\n            if (this.network !== networkGiven) {\n                throw Error(`Network prefix ${networkGiven} to a ${this.network} wallet`);\n            }\n            // \"wif:regtest:cNfsPtqN2bMRS7vH5qd8tR8GMvgXyL5BjnGAKgZ8DYEiCrCCQcP6\"\n            switch (walletType) {\n                case \"wif\":\n                    return this.fromWIF(arg1);\n                case \"watch\":\n                    if (arg2) {\n                        // watch:testnet:bchtest:qq1234567\n                        return this.watchOnly(`${arg1}:${arg2}`);\n                    }\n                    // watch:testnet:qq1234567\n                    return this.watchOnly(`${arg1}`);\n                case \"named\":\n                    if (arg2) {\n                        // named:testnet:wallet_1:my_database\n                        return this.named(arg1, arg2);\n                    }\n                    else {\n                        // named:testnet:wallet_1\n                        return this.named(arg1);\n                    }\n                case \"seed\":\n                    if (arg2) {\n                        // seed:testnet:table later ... stove kitten pluck:m/44'/0'/0'/0/0\n                        return this.fromSeed(arg1, arg2);\n                    }\n                    // seed:testnet:table later ... stove kitten pluck\n                    return this.fromSeed(arg1);\n                default:\n                    throw Error(`Unknown wallet type '${walletType}'`);\n            }\n        };\n        this.name = name;\n        this.walletType = walletType;\n    }\n    //#region Statics\n    /**\n     * fromId - create a wallet from encoded walletId string\n     *\n     * @param walletId   walletId options to steer the creation process\n     *\n     * @returns wallet instantiated accordingly to the walletId rules\n     */\n    static async fromId(walletId) {\n        return new this().fromId(walletId);\n    }\n    /**\n     * fromWIF - create a wallet using the private key supplied in `Wallet Import Format`\n     *\n     * @param wif   WIF encoded private key string\n     *\n     * @returns instantiated wallet\n     */\n    static async fromWIF(wif) {\n        return new this().fromWIF(wif);\n    }\n    /**\n     * fromSeed - create a wallet using the seed phrase and derivation path\n     *\n     * unless specified the derivation path m/44'/245'/0'/0/0 will be userd\n     * this derivation path is standard for Electron Cash SLP and other SLP enabled wallets\n     *\n     * @param seed   BIP39 12 word seed phrase\n     * @param derivationPath BIP44 HD wallet derivation path to get a single the private key from hierarchy\n     *\n     * @returns instantiated wallet\n     */\n    static async fromSeed(seed, derivationPath) {\n        return new this().fromSeed(seed, derivationPath);\n    }\n    /**\n     * newRandom - create a random wallet\n     *\n     * if `name` parameter is specified, the wallet will also be persisted to DB\n     *\n     * @param name   user friendly wallet alias\n     * @param dbName name under which the wallet will be stored in the database\n     *\n     * @returns instantiated wallet\n     */\n    static async newRandom(name = \"\", dbName) {\n        return new this().newRandom(name, dbName);\n    }\n    //#endregion Constructors\n    //#region Protected implementations\n    async generate() {\n        if (this.walletType === WalletTypeEnum.Wif) {\n            return await this._generateWif();\n        }\n        else if (this.walletType === WalletTypeEnum.Watch) {\n            return this;\n        }\n        else if (this.walletType === WalletTypeEnum.Hd) {\n            throw Error(\"Not implemented\");\n        }\n        else if (this.walletType === WalletTypeEnum.Seed) {\n            return await this._generateMnemonic();\n        }\n        else {\n            console.log(this.walletType);\n            throw Error(`Could not determine walletType: ${this.walletType}`);\n        }\n    }\n    async _generateWif() {\n        if (!this.privateKey) {\n            this.privateKey = generatePrivateKey(() => generateRandomBytes(32));\n        }\n        return this.deriveInfo();\n    }\n    async _generateMnemonic() {\n        this.mnemonic = generateMnemonic(Config.getWordlist());\n        if (this.mnemonic.length == 0)\n            throw Error(\"refusing to create wallet from empty mnemonic\");\n        const seed = mnemonicToSeedSync(this.mnemonic);\n        checkForEmptySeed(seed);\n        const network = this.isTestnet ? \"testnet\" : \"mainnet\";\n        this.parentXPubKey = getXPubKey(seed, this.parentDerivationPath, network);\n        const hdNode = deriveHdPrivateNodeFromSeed(seed, {\n            assumeValidity: true, // TODO: we should switch to libauth's BIP39 implementation and set this to false\n            throwErrors: true,\n        });\n        const zerothChild = deriveHdPath(hdNode, this.derivationPath);\n        if (typeof zerothChild === \"string\") {\n            throw Error(zerothChild);\n        }\n        this.privateKey = zerothChild.privateKey;\n        this.walletType = WalletTypeEnum.Seed;\n        return await this.deriveInfo();\n    }\n    async getXPubKeys(paths) {\n        if (this.mnemonic) {\n            if (paths) {\n                let xPubKeys = await this.deriveHdPaths(paths);\n                return [xPubKeys];\n            }\n            else {\n                return await this.deriveHdPaths(DERIVATION_PATHS);\n            }\n        }\n        else {\n            throw Error(\"xpubkeys can only be derived from seed type wallets.\");\n        }\n    }\n    // Initialize wallet from a mnemonic phrase\n    async fromSeed(mnemonic, derivationPath) {\n        this.mnemonic = mnemonic.trim().toLowerCase();\n        if (this.mnemonic.length == 0)\n            throw Error(\"refusing to create wallet from empty mnemonic\");\n        const seed = mnemonicToSeedSync(this.mnemonic);\n        checkForEmptySeed(seed);\n        const hdNode = deriveHdPrivateNodeFromSeed(seed, {\n            assumeValidity: true, // TODO: we should switch to libauth's BIP39 implementation and set this to false\n            throwErrors: true,\n        });\n        if (derivationPath) {\n            this.derivationPath = derivationPath;\n            // If the derivation path is for the first account child, set the parent derivation path\n            const path = derivationPath.split(\"/\");\n            if (path.slice(-2).join(\"/\") == \"0/0\") {\n                this.parentDerivationPath = path.slice(0, -2).join(\"/\");\n            }\n        }\n        const zerothChild = deriveHdPath(hdNode, this.derivationPath);\n        if (typeof zerothChild === \"string\") {\n            throw Error(zerothChild);\n        }\n        this.privateKey = zerothChild.privateKey;\n        const network = this.isTestnet ? \"testnet\" : \"mainnet\";\n        this.parentXPubKey = await getXPubKey(seed, this.parentDerivationPath, network);\n        this.walletType = WalletTypeEnum.Seed;\n        await this.deriveInfo();\n        return this;\n    }\n    // Get common xpub paths from zerothChild privateKey\n    async deriveHdPaths(hdPaths) {\n        if (!this.mnemonic)\n            throw Error(\"refusing to create wallet from empty mnemonic\");\n        const seed = mnemonicToSeedSync(this.mnemonic);\n        checkForEmptySeed(seed);\n        const hdNode = deriveHdPrivateNodeFromSeed(seed, {\n            assumeValidity: true, // TODO: we should switch to libauth's BIP39 implementation and set this to false\n            throwErrors: true,\n        });\n        const result = [];\n        for (const path of hdPaths) {\n            if (path === \"m\") {\n                throw Error(\"Storing or sharing of parent public key may lead to loss of funds. Storing or sharing *root* parent public keys is strongly discouraged, although all parent keys have risk. See: https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki#implications\");\n            }\n            const childNode = deriveHdPath(hdNode, path);\n            if (typeof childNode === \"string\") {\n                throw Error(childNode);\n            }\n            const node = deriveHdPublicNode(childNode);\n            if (typeof node === \"string\") {\n                throw Error(node);\n            }\n            const xPubKey = encodeHdPublicKey({\n                network: this.network,\n                node: node,\n            }, {\n                throwErrors: true,\n            }).hdPublicKey;\n            const key = new XPubKey({\n                path: path,\n                xPubKey: xPubKey,\n            });\n            result.push(await key.ready());\n        }\n        return await Promise.all(result).then((result) => {\n            return result;\n        });\n    }\n    // Initialize wallet from Wallet Import Format\n    async fromWIF(secret) {\n        checkWifNetwork(secret, this.network);\n        let wifResult = decodePrivateKeyWif(secret);\n        if (typeof wifResult === \"string\") {\n            throw Error(wifResult);\n        }\n        let resultData = wifResult;\n        this.privateKey = resultData.privateKey;\n        this.privateKeyWif = secret;\n        this.walletType = WalletTypeEnum.Wif;\n        await this.deriveInfo();\n        return this;\n    }\n    /**\n     * newRandom (internal) if the wallet is named, get or create it; otherwise create a random\n     * unnamed wallet\n     * @param {string} name              name of the wallet\n     * @param {string} dbName            database name the wallet is stored in\n     */\n    async newRandom(name, dbName) {\n        dbName = dbName ? dbName : this.networkPrefix;\n        if (name.length > 0) {\n            return this.named(name, dbName);\n        }\n        else {\n            return this.generate();\n        }\n    }\n    //#endregion Protected Implementations\n    //#region Serialization\n    // Returns the serialized wallet as a string\n    // If storing in a database, set asNamed to false to store secrets\n    // In all other cases, the a named wallet is deserialized from the database\n    // by the name key\n    toString() {\n        if (this.name) {\n            return `named:${this.network}:${this.name}`;\n        }\n        else if (this.walletType == WalletTypeEnum.Seed) {\n            return `${this.walletType}:${this.network}:${this.mnemonic}:${this.derivationPath}`;\n        }\n        else if (this.walletType === WalletTypeEnum.Wif) {\n            return `${this.walletType}:${this.network}:${this.privateKeyWif}`;\n        }\n        else if (this.walletType == WalletTypeEnum.Watch) {\n            return super.toString();\n        }\n        throw Error(\"toString unsupported wallet type\");\n    }\n    /**\n     * toDbString - store the serialized version of the wallet in the database, not just the name\n     *\n     * @throws {Error} if called on BaseWallet\n     */\n    toDbString() {\n        if (this.walletType == WalletTypeEnum.Seed) {\n            return `${this.walletType}:${this.network}:${this.mnemonic}:${this.derivationPath}`;\n        }\n        else if (this.walletType === WalletTypeEnum.Wif) {\n            return `${this.walletType}:${this.network}:${this.privateKeyWif}`;\n        }\n        else if (this.walletType == WalletTypeEnum.Watch) {\n            return super.toDbString();\n        }\n        throw Error(\"toDbString unsupported wallet type\");\n    }\n    //#endregion Serialization\n    //#region Funds\n    async getMaxAmountToSend(params = {\n        outputCount: 1,\n        options: {},\n    }) {\n        const { value: result } = await this._getMaxAmountToSend({\n            options: params.options,\n            outputCount: params.outputCount,\n            privateKey: this.privateKey,\n        });\n        return await balanceResponseFromSatoshi(result);\n    }\n    /**\n     * sendMax Send all available funds to a destination cash address\n     *\n     * @param  {string} cashaddr destination cash address\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     *\n     * @returns (depending on the options parameter) the transaction id, new address balance and a link to the transaction on the blockchain explorer\n     */\n    async sendMax(cashaddr, options) {\n        return this.sendMaxRaw(cashaddr, options, this.privateKey);\n    }\n    /**\n     * encodeTransaction Encode and sign a transaction given a list of sendRequests, options and estimate fees.\n     * @param  {SendRequest[]} sendRequests SendRequests\n     * @param  {boolean} discardChange=false\n     * @param  {SendRequestOptionsI} options Options of the send requests\n     */\n    async encodeTransaction(requests, discardChange = false, options, privateKey) {\n        return super.encodeTransaction(requests, discardChange, options, this.privateKey);\n    }\n    async signUnsignedTransaction(transaction, sourceOutputs) {\n        if (!this.privateKey) {\n            throw Error(\"Can not sign a transaction with watch-only wallet.\");\n        }\n        return signUnsignedTransaction(transaction, sourceOutputs, this.privateKey);\n    }\n    //#endregion Funds\n    //#region Private implementation details\n    async deriveInfo() {\n        const publicKey = secp256k1.derivePublicKeyUncompressed(this.privateKey);\n        if (typeof publicKey === \"string\") {\n            throw new Error(publicKey);\n        }\n        this.publicKey = publicKey;\n        const publicKeyCompressed = secp256k1.derivePublicKeyCompressed(this.privateKey);\n        if (typeof publicKeyCompressed === \"string\") {\n            throw new Error(publicKeyCompressed);\n        }\n        this.publicKeyCompressed = publicKeyCompressed;\n        const networkType = this.network === NetworkType.Regtest ? NetworkType.Testnet : this.network;\n        this.privateKeyWif = encodePrivateKeyWif(this.privateKey, networkType);\n        checkWifNetwork(this.privateKeyWif, this.network);\n        this.cashaddr = deriveCashaddr(this.privateKey, this.networkPrefix);\n        this.tokenaddr = deriveTokenaddr(this.privateKey, this.networkPrefix);\n        this.publicKeyHash = derivePublicKeyHash(this.cashaddr);\n        return this;\n    }\n    //#endregion Private implementation details\n    //#region Signing\n    // Convenience wrapper to sign interface\n    async sign(message) {\n        return await Wallet.signedMessage.sign(message, this.privateKey);\n    }\n}\n/**\n * Class to manage a testnet wallet.\n */\nexport class TestNetWallet extends Wallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.testnet; }\n    static { this.faucetServer = \"https://rest-unstable.mainnet.cash\"; }\n    constructor(name = \"\") {\n        super(name, NetworkType.Testnet);\n    }\n}\n/**\n * Class to manage a regtest wallet.\n */\nexport class RegTestWallet extends Wallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.regtest; }\n    constructor(name = \"\") {\n        super(name, NetworkType.Regtest);\n    }\n}\n/**\n * Class to manage a bitcoin cash wif wallet.\n */\nexport class WifWallet extends Wallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.mainnet; }\n    static { this.walletType = WalletTypeEnum.Wif; }\n    constructor(name = \"\") {\n        super(name, NetworkType.Mainnet, WalletTypeEnum.Wif);\n    }\n}\n/**\n * Class to manage a testnet wif wallet.\n */\nexport class TestNetWifWallet extends Wallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.testnet; }\n    static { this.walletType = WalletTypeEnum.Wif; }\n    constructor(name = \"\") {\n        super(name, NetworkType.Testnet, WalletTypeEnum.Wif);\n    }\n}\n/**\n * Class to manage a regtest wif wallet.\n */\nexport class RegTestWifWallet extends Wallet {\n    static { this.networkPrefix = CashAddressNetworkPrefix.regtest; }\n    static { this.walletType = WalletTypeEnum.Wif; }\n    constructor(name = \"\") {\n        super(name, NetworkType.Regtest, WalletTypeEnum.Wif);\n    }\n}\n//# sourceMappingURL=Wif.js.map"],"names":["Base58AddressFormatVersion","encodeBase58AddressFormat","version","payload","sha256","internalSha256","content","checksum","hash256","bin","flattenBinArray","binToBase58","Base58AddressError","decodeBase58AddressFormat","address","base58ToBin","formatError","expectedChecksum","value","i","EntropyGenerationError","generateRandomBytesUnchecked","length","cryptoInstance","generateRandomBytes","generate","firstRun","secondRun","binsAreEqual","generateRandomSeed","generatePrivateKey","secureRandom","maybeKey","validateSecp256k1PrivateKey","WalletImportFormatError","encodePrivateKeyWif","privateKey","type","mainnet","decodePrivateKeyWif","wifKey","decoded","compressed","IndexedDBProvider","dbName","storeName","resolve","reject","request","event","db","name","walletId","store","getReq","addReq","req","putReq","RuntimePlatform","getRuntimePlatform","crypto$2","literal","l","Network","NFTCapability","$parcel$export","e","n","v","$24139611f53a54b8$export$5d955335434540c6","method","parameters","requestId","$e83d2e7688025acd$exports","$e83d2e7688025acd$export$e1f38ab2b4ebdde6","$e83d2e7688025acd$export$9598f0c76aa41d73","object","$abcb763a48577a1e$export$d73a2e87a509880","message","$abcb763a48577a1e$export$280de919a0cf6928","$db7c797e63383364$exports","$db7c797e63383364$export$7516420eb880ab68","ConnectionStatus","$ff134c9a9e1f7361$export$de0f57fc22079b5e","$dvphU$EventEmitter","application","socketOrHostname","options","$dvphU$ElectrumWebSocket","data","timer","statementParts","currentStatementList","statementList","$dvphU$parse","$dvphU$parseNumberAndBigInt","currentStatement","software","protocol","$dvphU$electrumcashdebuglogs","connectionResolver","rejector","error","versionNegotiator","versionMessage","versionValidator","errorMessage","force","intentional","disconnectResolver","currentTime","verificationTimer","sentTimestamp","$d801b1f9b7fc3074$var$MILLI_SECONDS_PER_SECOND","$d801b1f9b7fc3074$export$5ba3a4134d0d751d","$558b46d3f899ced5$var$ElectrumClient","$dvphU$Mutex","networkOptions","unlock","retainSubscriptions","id","requestResolver","requestData","notification","subscriptionParameters","resubscriptionPromises","parameterJSON","resolverId","versionStatement","eventName","$558b46d3f899ced5$export$2e2bcd8739ae039","delay","ms","getTransactionHash","rawTransactionHex","transactionBin","hexToBin","binToHex","wordlist","DELIMITER","DUST_UTXO_THRESHOLD","EXCHANGE_RATE_TTL","DERIVATION_PATHS","WORDLIST_CHECKSUMS","Config","english","ipfsGateway","utf8ToBin","decodeHeader","hexHeader","result","header","assertSuccess","readUint32LE","IndexedDbCache","objectStoreName","target","database","key","objectStore","WebStorageCache","MemoryCache","ElectrumNetworkProvider","electrum","network","manualConnectionManagement","_timeout","timeoutHandle","cashaddr","utxo","height","verbose","cached","txHash","loadInputValues","transaction","hashes","val","transactions","hash","transactionMap","input","output","txHex","awaitPropagation","cancel","waitForTransactionCallback","fromHeight","toHeight","callback","watchAddressStatusCallback","status","historyMap","history","txHashes","a","b","tx","skipCurrentHeight","acknowledged","waitForBlockCallback","_header","cancelWatch","requestTimeout","_resolve","methodName","handler","timeout","bchParam","NetworkType","NetworkEnum","networkPrefixMap","prefixFromNetworkMap","CashAddressNetworkPrefix","UnitEnum","ExchangeRateProvider","symbol","valueString","rate","ttl","ExchangeRate","useCache","getRateFromExchange","cache","cacheRate","freshRate","getTtl","rateObject","cachedRate","rates","acc","sanitizeUnit","rawUnit","amountInSatoshi","Currency_over_BCH","SAT_over_BCH","hash160","ripemd160","deriveCashaddr","networkPrefix","publicKey","secp256k1","pkh","encodeCashAddress","CashAddressType","deriveTokenaddr","publicKeyHash","publicKeyCompressed","decodeAddress","decodeCashAddress","toTokenaddr","isTokenaddr","checkTokenaddr","enforce","SendRequest","unit","TokenSendRequest","amount","tokenId","capability","commitment","OpReturnData","buffer","string","uint8Array","array","element","elementData","lengthData","opReturn","chunks","position","binToNumberUint16LE","opReturnHex","binToUtf8","SendResponse","txId","balance","explorerUrl","XPubKey","path","xPubKey","fromUtxoId","utxoId","txid","vout","satoshis","asSendRequestObject","requests","resp","r","base64ToBin","convertToClass","satoshiToAmount","currencyValue","convert","from","to","satoshi","derivePublicKeyHash","decodeCashAddressFormat","decodeCashAddressFormatWithoutPrefix","derivePrefix","getXPubKey","seed","derivationPath","hdNode","deriveHdPrivateNodeFromSeed","node","deriveHdPath","parentPublicNode","deriveHdPublicNode","encodeHdPublicKey","sumUtxoValue","utxos","o","sumTokenAmounts","floor","precision","multiplier","balanceResponseFromSatoshi","priceCache","response","balanceFromSatoshi","ELECTRUM_CASH_PROTOCOL_VERSION","networkTickerMap","mainnetServers","testnetServers","regtestServers","DefaultProvider","getDefaultServers","env","define_process_env_default","primary.mainnetServers","primary.testnetServers","primary.regtestServers","getUserAgent","ua","parseElectrumUrl","givenUrl","url","port","scheme","getElectrumScheme","transport","setGlobalProvider","provider","accessor","getGlobalProvider","getNetworkProvider","servers","globalContext","globalProvider","client","getClient","server","getElectrumClient","params","webSocket","ElectrumWebSocket","ElectrumClient","initProvider","Connection","BCMR","uri","contentHash","registry","rawTx","opReturns","spends0thOutput","electrumTransaction","libauthTransaction","ipfsCid","uris","uriString","parts","getAuthChainChild","thisTx","filteredHistory","historyTx","historyRawTx","historyCache","child","chainBase","decodeTransaction","stop","maxElements","vin","pastElement","chainHead","responseData","migrations","migration","authChain","latestIdentityIndex","message_magic","str","hash_message","h","instantiateSha256","SignedMessage","instantiateSecp256k1","messageHash","rs","sigDer","sigSchnorr","electronEncoding","binToBase64","signature","sig","signatureValid","keyMatch","pkhMatch","signatureType","rawSig","recoveryId","recoveredPk","prefix","getAddressHistory","start","count","heights","index","timestampMap","timestamp","historicTransactions","transactionCommon","prevoutTransactionHashes","prevoutTransactionMap","addressCache","historyItems","inputTotalValue","outputTotalValue","prevoutTx","prevoutOutput","lockingBytecodeToCashAddress","Opcodes","satoshiBalance","ftTokenBalances","nftTokenBalances","nftAmount","tokenChange","prevBalance","prevValueChange","getRelayFeeCache","relayFeePerKbInCoins","WalletTypeEnum","FeePaidByEnum","checkFeeForDust","checkSatsAvailable","sendRequestArray","fee","sum","checkForNonStandardSendRequest","sortSendRequests","distributeFees","perRequestFee","firstPays","payer","lastPays","anyPays","changeThenFallback","change","fallbackFn","outstandingFee","allocateFee","feePaidBy","sumSendRequestAmounts","sumBalance","buildP2pkhNonHdTransaction","inputs","outputs","signingKey","sourceAddress","discardChange","changeAddress","template","importWalletTemplate","walletTemplateP2pkhNonHd","compiler","walletTemplateToCompilerBCH","inputAmount","sendAmount","changeAmount","lockedOutputs","prepareOutputs","changeLockingBytecode","cashAddressToLockingBytecode","preparedInputs","sourceOutputs","prepareInputs","generateTransaction","tokenValidationResult","verifyTransactionTokens","utxoTxnValue","utxoIndex","utxoOutpointTransactionHash","byte","libAuthToken","newInput","lockingBytecode","prepareTokenOutputs","prepareOpReturnOutput","outputLockingBytecode","lockedOutput","token","getSuitableUtxos","amountRequired","bestHeight","ensureUtxos","tokenOperation","suitableUtxos","amountAvailable","tokenRequests","availableInputs","selectedInputs","tokenInputs","sameCommitmentTokens","selected","changeCommitmentTokens","u","addEnsured","other","getFeeAmountSimple","sendRequests","relayFeePerByteInSatoshi","inputTotalSize","prev","curr","outputSize","sendRequest","tokenRequest","outputTotalSize","getFeeAmount","draftTransaction","buildEncodedTransaction","buildUnsigned","encodeTransaction","signUnsignedTransaction","transactionTemplate","sourceOutput","checkUtxos","wallet","addressUtxos","absent","absentString","Util","transactionHashOrHex","transactionHex","decodeTransactionLibAuth","isPayToPublicKey","publicKeyToP2pkhCashAddress","lockingBytecodeToAddressContents","placeholderPrivateKey","BaseWallet","forceNew","_checkContextSafety","getStorageProvider","savedWalletRecord","recoveredWallet","hex","networkType","walletType","networkGiven","arg1","arg2","addressComponents","addressPrefix","addressBase","prefixedAddress","addressData","nonTokenAwareType","bchutxo","_status","usdPriceRefreshInterval","usdPrice","_callback","watchCancel","interval","previous","fundingUtxos","encodedTransaction","tokenIds","maxSpendableAmount","checkTokenQuantities","allTokenInputs","allTokenOutputs","idx","arr","inputAmountSum","cur","tokenOutputs","outputAmountSum","diff","available","spendAmount","feeEstimate","rawTransaction","confirmedOnly","lastTx","makeResponse","promises","initialResponseSeen","genesisRequest","genesisInputs","genesisSendRequest","mintRequests","deductTokenAmount","nftUtxos","newAmount","safeNewAmount","mintingInput","burnRequest","tokenUtxos","totalFungibleAmount","fungibleBurnAmount","hasNFT","utxoIds","changeSendRequests","c","WatchWallet","TestNetWatchWallet","RegTestWatchWallet","crypto","isBytes","anumber","abytes","lengths","ahash","aexists","instance","checkFinished","aoutput","out","min","clean","arrays","createView","rotr","word","shift","utf8ToBytes","toBytes","kdfInputToBytes","checkOpts","defaults","opts","Hash","createHasher","hashCons","hashC","msg","tmp","randomBytes","bytesLength","HMAC","_key","blockLen","pad","buf","oHash","iHash","finished","destroyed","outputLen","hmac","pbkdf2Init","_password","_salt","_opts","dkLen","asyncTick","password","salt","DK","PRF","PRFSalt","pbkdf2Output","prfW","pbkdf2","view","ti","pos","Ti","ui","setBigUint64","byteOffset","isLE","_32n","_u32_max","wh","wl","Chi","Maj","HashMD","padOffset","len","take","dataView","oview","outLen","state","res","SHA256_IV","SHA512_IV","U32_MASK64","fromBig","le","split","lst","Ah","Al","shrSH","_l","s","shrSL","rotrSH","rotrSL","rotrBH","rotrBL","add","Bh","Bl","add3L","Cl","add3H","low","Ch","add4L","Dl","add4H","Dh","add5L","El","add5H","Eh","SHA256_K","SHA256_W","SHA256","A","B","C","D","E","F","G","H","offset","W15","W2","s0","s1","sigma1","T1","T2","K512","u64.split","SHA512_Kh","SHA512_Kl","SHA512_W_H","SHA512_W_L","SHA512","Fh","Fl","Gh","Gl","Hh","Hl","W15h","W15l","s0h","u64.rotrSH","u64.shrSH","s0l","u64.rotrSL","u64.shrSL","W2h","W2l","s1h","u64.rotrBH","s1l","u64.rotrBL","SUMl","u64.add4L","SUMh","u64.add4H","sigma1h","sigma1l","CHIh","CHIl","T1ll","u64.add5L","T1h","u64.add5H","T1l","sigma0h","sigma0l","MAJh","MAJl","u64.add","All","u64.add3L","u64.add3H","sha512","isArrayOf","isString","item","afn","astr","label","aArr","astrArr","anumArr","chain","args","wrap","encode","x","decode","alphabet","letters","lettersA","indexes","digits","letter","join","separator","padding","bits","chr","end","convertRadix","d","dlen","carry","done","digit","fromCarry","digitBase","div","rounded","gcd","radix2carry","powers","convertRadix2","max","mask","pow","radix","num","_256","bytes","radix2","revPadding","fn","oldChecksum","newChecksum","utils","isJapanese","nfkd","normalize","norm","words","aentropy","ent","generateMnemonic","strength","entropyToMnemonic","calcChecksum","entropy","bitsLeft","getCoder","baseUtils","psalt","passphrase","mnemonicToSeedSync","mnemonic","checkForEmptySeed","blankSeed","seedBin","checkWifNetwork","walletImportFormatString","Wallet","wif","zerothChild","paths","hdPaths","childNode","secret","wifResult","resultData","TestNetWallet","RegTestWallet","WifWallet","TestNetWifWallet","RegTestWifWallet"],"mappings":"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AA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA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","x_google_ignoreList":[0,1,2,3,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63]}