{"version":3,"file":"11.vP9ks22Y.js","sources":["../../../../../../src/routes/future/v/+page.ts","../../../../../../src/lib/ExplorerLinks.svelte","../../../../../../src/routes/future/v/+page.svelte"],"sourcesContent":["import type { PageLoad } from './$types';\n\nexport const prerender = true;\n\nexport const load: PageLoad = ({ params,url }) => {\n    return {\n        time: url.searchParams.get('time')\n    };\n};","<script>\n\tlet { address, isMainnet = true } = $props();\n</script>\n\n<div>\n\t{#if address}\n\t\t{#if isMainnet}\n\t\t\t<a target=\"_blank\" href=\"https://explorer.salemkode.com/address/{address}\">salemkode</a>\n\t\t\t<a target=\"_blank\" href=\"https://explorer.bch.ninja/address/{address}\">bch.ninja</a>\n\t\t{:else}\n\t\t\t<a target=\"_blank\" href=\"https://chipnet.bch.ninja/address/{address}\">bch.ninja</a>\n\t\t\t<a target=\"_blank\" href=\"https://chipnet.chaingraph.cash/address/{address}\">chaingraph.cash</a>\n\t\t\t<a target=\"_blank\" href=\"https://chipnet.imaginary.cash/address/{address}\">imaginary.cash</a>\n\t\t{/if}\n\t{/if}\n</div>\n\n<style>\n\tdiv {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t}\n\tdiv a {\n\t\tdisplay: inline-block;\n\t\tborder-radius: 5px;\n\t\tbackground-color: #52254873;\n\t\tcolor: #eee;\n\t\tmargin: 2px;\n\t\tpadding: 2px;\n\t\tfont-weight: 400;\n\t\tfont-size: small;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport { page } from '$app/state';\n\timport type { PageProps } from './$types';\n\n\timport { IndexedDBProvider } from '@mainnet-cash/indexeddb-storage';\n\timport { BaseWallet, Wallet, TestNetWallet } from 'mainnet-js';\n\timport { ElectrumClient, ConnectionStatus } from '@electrum-cash/network';\n\n\timport BCH from '$lib/images/BCH.svg';\n\timport tBCH from '$lib/images/tBCH.svg';\n\timport { CashAddressNetworkPrefix } from '@bitauth/libauth';\n\n\timport ExplorerLinks from '$lib/ExplorerLinks.svelte';\n\n\timport FutureCoupon from '$lib/FutureCoupon.svelte';\n\timport FbchIcon from '$lib/FbchIcon.svelte';\n\timport Loading from '$lib/Loading.svelte';\n\n\timport { Vault, getFutureBlockDate, type CouponItemI } from '@fbch/lib';\n\timport { COUPON_SERIES, USER_AGENT } from '@fbch/lib';\n\timport { TIMELOCK_MAP, TIMELOCK_MAP_CHIPNET } from '@fbch/lib';\n\n\timport { binToHex, cashAddressToLockingBytecode, encodeTransactionBch } from '@bitauth/libauth';\n\n\timport {\n\t\tgetScriptHash,\n\t\tgetHdPrivateKey,\n\t\tsumUtxoValue,\n\t\tsumTokenAmounts,\n\t\ttype UtxoI,\n\t\tsleep\n\t} from '@unspent/tau';\n\n\tlet { data }: PageProps = $props();\n\tlet time = $state(Number(data.time));\n\n\tlet now: number = $state(0);\n\n\tlet key = $state('');\n\tlet coupons: any[] | undefined = $state();\n\tlet electrumClient: any;\n\tlet walletScriptHash = $state('');\n\tlet scripthash = Vault.getScriptHash(time);\n\tlet amount = $state(0n);\n\tlet connectionStatus = $state('');\n\tlet contractState = $state('');\n\tlet timer: any;\n\tlet couponGrouped: Map<string, CouponItemI[]> | undefined = $state();\n\n\tconst isMainnet = page.url.hostname == 'vox.cash';\n\tconst prefix = isMainnet ? 'bitcoincash' : ('bchtest' as CashAddressNetworkPrefix);\n\tconst baseTicker = isMainnet ? 'BCH' : 'tBCH';\n\tconst baseSeries = isMainnet ? 'FBCH' : 'tFBCH';\n\tconst server = isMainnet ? 'bch.imaginary.cash' : 'chipnet.bch.ninja';\n\tconst bchIcon = isMainnet ? BCH : tBCH;\n\tconst explorer = isMainnet ? 'explorer.bch.ninja' : 'chipnet.bch.ninja';\n\tconst SERIES_MAP = isMainnet ? TIMELOCK_MAP : TIMELOCK_MAP_CHIPNET;\n\n\tlet threads: UtxoI[] = $state([]);\n\tlet walletUnspent: any[] = $state.raw([]);\n\tlet broadcastQueue: string[] = $state([]);\n\tlet vaultCache: Map<number, UtxoI[]> = new Map([]);\n\n\tlet openCouponInterest: number = $state(0);\n\tlet couponTotal: number = $state(0);\n\n\tlet wallet: any;\n\tlet walletBalance: number = $state(0);\n\tlet sumVault: number = $state(0);\n\tlet sumVaultTokens: bigint  = $state(0n);\n\tlet vaultAddress = Vault.getAddress(time, prefix as CashAddressNetworkPrefix);\n\n\tconst updateVault = async function () {\n\t\tlet response = await electrumClient.request(\n\t\t\t'blockchain.scripthash.listunspent',\n\t\t\tscripthash,\n\t\t\t'include_tokens'\n\t\t);\n\t\tif (response instanceof Error) throw response;\n\n\t\tthreads = response.filter((u: UtxoI) => u.token_data?.category == SERIES_MAP.get(time));\n\t\tsumVault = sumUtxoValue(threads, true);\n\t\tsumVaultTokens = sumTokenAmounts(threads, SERIES_MAP.get(time)!);\n\t};\n\n\tasync function updateCoupons() {\n\t\tif (electrumClient && now > 1000) {\n\t\t\tcoupons = await Vault.getAllCouponUtxos(electrumClient, now, [time]);\n\t\t}\n\t\tif (coupons) {\n\t\t\tcouponGrouped = Map.groupBy(\n\t\t\t\tcoupons,\n\t\t\t\t({ locktime, placement, value }) => `${locktime}-${placement}-${value}`\n\t\t\t);\n\n\t\t\tcoupons.sort((a: any, b: any) => parseFloat(b.spb) - parseFloat(a.spb));\n\t\t\topenCouponInterest = Number(coupons.reduce((acc, c) => acc + c.placement, 0) / 1e8);\n\t\t\tcouponTotal = Number(coupons.reduce((acc, c) => acc + c.value, 0));\n\t\t}\n\t}\n\n\tconst debounceUpdateWallet = () => {\n\t\tclearTimeout(timer);\n\t\ttimer = setTimeout(() => {\n\t\t\tupdateWallet();\n\t\t\tupdateCoupons();\n\t\t}, 1000);\n\t};\n\tconst debounceBroadcastQue = async () => {\n\t\tclearTimeout(timer);\n\t\ttimer = setTimeout(async () => {\n\t\t\twhile (broadcastQueue.length) {\n\t\t\t\tlet tx = broadcastQueue.shift()!;\n\t\t\t\ttry {\n\t\t\t\t\tawait broadcast(tx);\n\t\t\t\t\tawait sleep(100);\n\t\t\t\t\tconsole.log('broadcast');\n\t\t\t\t\tdebounceUpdateWallet();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// if one transaction failed, the whole chain is borked,\n\t\t\t\t\t// start over.\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tbroadcastQueue = [];\n\t\t\t\t\twalletUnspent = [];\n\t\t\t\t\tvaultCache = new Map([]);\n\t\t\t\t\tdebounceUpdateWallet();\n\t\t\t\t}\n\t\t\t}\n\t\t}, 500);\n\t};\n\n\tasync function handlePlacement(coupon: any) {\n\t\tif (!vaultCache.has(coupon.locktime)) {\n\t\t\tvaultCache.set(\n\t\t\t\tcoupon.locktime,\n\t\t\t\tawait electrumClient.request(\n\t\t\t\t\t'blockchain.scripthash.listunspent',\n\t\t\t\t\tVault.getScriptHash(coupon.locktime),\n\t\t\t\t\t'include_tokens'\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t// filter out junk Utxos in vault.\n\t\tlet vaultUtxos = vaultCache\n\t\t\t.get(coupon.locktime)!\n\t\t\t.filter((u) => u.token_data?.category == SERIES_MAP.get(coupon.locktime));\n\n\t\tlet swapTx = Vault.swap(\n\t\t\tcoupon.placement,\n\t\t\tvaultUtxos,\n\t\t\twalletUnspent,\n\t\t\tcoupon.locktime,\n\t\t\tkey,\n\t\t\tcoupon\n\t\t);\n\n\t\tlet transactionHex = binToHex(encodeTransactionBch(swapTx.transaction));\n\t\tbroadcastQueue.push(transactionHex);\n\t\tdebounceBroadcastQue();\n\n\t\tcoupons = coupons?.filter((c) => !(c.tx_hash == coupon.tx_hash && c.tx_pos == coupon.tx_pos));\n\t\tcouponGrouped = Map.groupBy(\n\t\t\tcoupons!,\n\t\t\t({ locktime, placement, value }) => `${locktime}-${placement}-${value}`\n\t\t);\n\t\twalletUnspent = swapTx.walletUtxos;\n\t\tvaultCache.set(coupon.locktime, swapTx.contractUtxos);\n\t}\n\n\tconst broadcast = async function (raw_tx: string) {\n\t\tlet response = await electrumClient.request('blockchain.transaction.broadcast', raw_tx);\n\t\tif (response instanceof Error) {\n\t\t\tconnectionStatus = ConnectionStatus[electrumClient.status];\n\t\t\tthrow response;\n\t\t}\n\t\tresponse as any[];\n\t};\n\n\t// async function doSwaps() {\n\t// \tconsole.log('processing que data');\n\t// \tconsole.log(requests);\n\t// \ttry {\n\t// \t\tawait Vault.swap();\n\t// \t\terrorMessage = '';\n\t// \t} catch (e: any) {\n\t// \t\terrorMessage = e;\n\t// \t\tconsole.log(e.message);\n\t// \t}\n\t// \trequests = [];\n\t// }\n\n\tconst updateWallet = async function () {\n\t\tlet response = await electrumClient.request(\n\t\t\t'blockchain.scripthash.listunspent',\n\t\t\twalletScriptHash,\n\t\t\t'include_tokens'\n\t\t);\n\t\tif (response instanceof Error) throw response;\n\n\t\twalletUnspent = response.filter((u: UtxoI) => !u.token_data?.nft);\n\t\twalletBalance = sumUtxoValue(walletUnspent, true);\n\t};\n\n\tconst handleNotifications = function (data: any) {\n\t\tconnectionStatus = ConnectionStatus[electrumClient.status];\n\t\tif (data.method === 'blockchain.headers.subscribe') {\n\t\t\tlet d = data.params[0];\n\t\t\tnow = d.height;\n\t\t\tdebounceUpdateWallet();\n\t\t} else if (data.method === 'blockchain.scripthash.subscribe') {\n\t\t\tif (data.params[1] !== contractState) {\n\t\t\t\tcontractState = data.params[1];\n\t\t\t\twalletBalance = 0;\n\t\t\t\tdebounceUpdateWallet();\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log(data);\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tBaseWallet.StorageProvider = IndexedDBProvider;\n\t\twallet = isMainnet ? await Wallet.named(`vox`) : await TestNetWallet.named(`vox`);\n\n\t\tkey = getHdPrivateKey(wallet.mnemonic!, wallet.derivationPath.slice(0, -2), wallet.isTestnet);\n\t\tlet lockingBytecodeResult = cashAddressToLockingBytecode(wallet.getDepositAddress());\n\t\tif (typeof lockingBytecodeResult == 'string') throw lockingBytecodeResult;\n\t\twalletScriptHash = getScriptHash(lockingBytecodeResult.bytecode);\n\n\t\t// Initialize an electrum client.\n\t\telectrumClient = new ElectrumClient(USER_AGENT, '1.4.1', server);\n\n\t\t// Wait for the client to connect.\n\t\tawait electrumClient.connect();\n\t\t// Set up a callback function to handle new blocks.\n\n\t\t// Listen for notifications.\n\t\telectrumClient.on('notification', handleNotifications);\n\n\t\t// Set up a subscription for new block headers.\n\t\tawait electrumClient.subscribe('blockchain.headers.subscribe');\n\t\tupdateVault();\n\t\tupdateCoupons();\n\t\tupdateWallet();\n\t});\n</script>\n\n<svelte:head>\n\t{#if time > 1000}\n\t\t<title>{baseSeries}-{time / 1000}</title>\n\t\t<meta name=\"description\" content=\"Future Vault Series\" />\n\t\t<link rel=\"icon\" type=\"image/svg\" href=\"/FBCH-{time}.svg\" />\n\t{:else}\n\t\t<title>{baseSeries}</title>\n\t\t<meta name=\"description\" content=\"Future Vault Series\" />\n\t\t<link rel=\"icon\" type=\"image/svg\" href=\"/FBCH.svg\" />\n\t{/if}\n</svelte:head>\n<section>\n\t<div class=\"text-column\">\n\t\t{#if time}\n\t\t\t<div style=\"display:flex; flex-direction:column; align-items:flex-end;\">\n\t\t\t\t<h1>Vault {time.toLocaleString()}<sub>■</sub></h1>\n\t\t\t\t{#if now}\n\t\t\t\t\t{#if time - now > 0}\n\t\t\t\t\t\t<h2>T&#8196; -{(time - now).toLocaleString()}<sub>■</sub></h2>\n\t\t\t\t\t{/if}\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t\t{#if now}\n\t\t\t\t<p>\n\t\t\t\t\t<b>\n\t\t\t\t\t\t{#if time - now >= 2000}\n\t\t\t\t\t\t\tUnlocking around\n\t\t\t\t\t\t\t{getFutureBlockDate(now, time).toLocaleDateString()}\n\t\t\t\t\t\t{:else if time - now >= 0}\n\t\t\t\t\t\t\tUnlocks around\n\t\t\t\t\t\t\t{getFutureBlockDate(now, time).toLocaleDateString()}\n\t\t\t\t\t\t\t{getFutureBlockDate(now, time).toLocaleTimeString()}\n\t\t\t\t\t\t{:else if time - now < 0}\n\t\t\t\t\t\t\tRedemptions are open\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t-\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</b>\n\t\t\t\t</p>\n\t\t\t{/if}\n\t\t\t<p>\n\t\t\t\tVault locking Bitcoin Cash ({baseTicker}) for CashTokens until opening redemptions after\n\t\t\t\tblock {time.toLocaleString()}―in\n\t\t\t\t{(time - now).toLocaleString()} blocks.\n\t\t\t</p>\n\t\t\t<div style=\"display:flex;\">\n\t\t\t\t<FbchIcon {time} size={75} />\n\t\t\t</div>\n\n\t\t\t<h4>Spot Coupons</h4>\n\n\t\t\t<p>\n\t\t\t\tCoupons discount placement of <i>P</i>\n\t\t\t\t{baseTicker} into the vault; limit one coupon per transaction.\n\t\t\t</p>\n\n\t\t\t{#if couponGrouped}\n\t\t\t\t{#if couponGrouped.size > 0}\n\t\t\t\t\t{#each couponGrouped.values() as subList}\n\t\t\t\t\t\t{#each subList as c, i}\n\t\t\t\t\t\t\t{#if i == 0}\n\t\t\t\t\t\t\t\t<FutureCoupon\n\t\t\t\t\t\t\t\t\t{handlePlacement}\n\t\t\t\t\t\t\t\t\t{...c}\n\t\t\t\t\t\t\t\t\t{isMainnet}\n\t\t\t\t\t\t\t\t\tcouponCount={subList.length}\n\t\t\t\t\t\t\t\t\tbalance={walletBalance}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t{/each}\n\t\t\t\t{:else}\n\t\t\t\t\t<p>no coupons available</p>\n\t\t\t\t{/if}\n\t\t\t{:else}\n\t\t\t\t<div style=\"text-align:center\">\n\t\t\t\t\t<h2>loading coupons</h2>\n\t\t\t\t\t<Loading />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t\t<h4>Coupon Contracts</h4>\n\n\t\t\t<ul class=\"couponList\">\n\t\t\t\t{#each COUPON_SERIES as c}\n\t\t\t\t\t<li>\n\t\t\t\t\t\tC<sub>{c}</sub>\n\t\t\t\t\t\t{Math.pow(10, c)} BCH\n\t\t\t\t\t\t<ExplorerLinks\n\t\t\t\t\t\t\taddress={Vault.getCouponAddress(\n\t\t\t\t\t\t\t\tMath.pow(10, c) * 1e8,\n\t\t\t\t\t\t\t\ttime,\n\t\t\t\t\t\t\t\tprefix as CashAddressNetworkPrefix\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{isMainnet}\n\t\t\t\t\t\t></ExplorerLinks><br />\n\t\t\t\t\t</li>\n\t\t\t\t{/each}\n\t\t\t</ul>\n\n\t\t\t<h4>Vault Threads</h4>\n\t\t\t<div style=\"display:flex\">\n\t\t\t\t<ExplorerLinks address={vaultAddress} {isMainnet}></ExplorerLinks>\n\t\t\t</div>\n\t\t\t<p>\n\t\t\t\tSeven (7) unspent transaction outputs control swapping of coins and tokens on a 1:1 basis\n\t\t\t\twith the vault unlocking script.\n\t\t\t</p>\n\t\t\t<p class=\"cashaddr\">\n\t\t\t\tCategory/pre-genesis: <a\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\thref={`https://${explorer}/tx/${SERIES_MAP.get(time)}`}\n\t\t\t\t>\n\t\t\t\t\t{SERIES_MAP.get(time)}</a\n\t\t\t\t>\n\t\t\t</p>\n\n\t\t\t{#if threads && threads.length}\n\t\t\t\t<table class=\"couponTable\">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr class=\"header\">\n\t\t\t\t\t\t\t<td>category </td>\n\t\t\t\t\t\t\t<td>{baseTicker} </td>\n\t\t\t\t\t\t\t<td>{baseSeries}-{String(time).padStart(7, '0')} </td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t{#each threads as c}\n\t\t\t\t\t\t\t{#if c.token_data}\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<td\n\t\t\t\t\t\t\t\t\t\t><i\n\t\t\t\t\t\t\t\t\t\t\t>{c.token_data.category.substring(0, 4) +\n\t\t\t\t\t\t\t\t\t\t\t\t'...' +\n\t\t\t\t\t\t\t\t\t\t\t\tc.token_data.category.slice(-2)}</i\n\t\t\t\t\t\t\t\t\t\t></td\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<td class=\"r\">\n\t\t\t\t\t\t\t\t\t\t{(Number(c.value) / 1e8).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\t\t\t\tminimumFractionDigits: 1\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t<img width=\"15\" src={bchIcon} alt=\"bchLogo\" />\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td class=\"r\"\n\t\t\t\t\t\t\t\t\t\t><i>\n\t\t\t\t\t\t\t\t\t\t\t{#if c.token_data}\n\t\t\t\t\t\t\t\t\t\t\t\t{(Number(c.token_data.amount) / 1e8).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\t\t\t\t\t\tminimumFractionDigits: 1\n\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t\t\t<FbchIcon {time} size={15} />\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</tbody>\n\t\t\t\t\t<tfoot>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td class=\"r\">\n\t\t\t\t\t\t\t\t{(Number(sumVault) / 100000000).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\t\tminimumFractionDigits: 1\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t<img width=\"15\" src={bchIcon} alt=\"bchLogo\" />\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class=\"r\"\n\t\t\t\t\t\t\t\t>{(Number(sumVaultTokens) / 100000000).toLocaleString(undefined, {\n\t\t\t\t\t\t\t\t\tminimumFractionDigits: 1\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t<FbchIcon {time} size={15} />\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</tfoot>\n\t\t\t\t</table>\n\t\t\t{:else}\n\t\t\t\t<p>loading threads</p>\n\t\t\t\t<Loading />\n\t\t\t{/if}\n\t\t\t<hr />\n\t\t\t<p style=\"font-size:small\">\n\t\t\t\t<i>sats (satoshis)</i>: one 100,000,000<sup>th</sup> of a whole coin.<br />\n\t\t\t\t<i>spb</i>: rate in sats per coin per block of time remaining to maturation.<br />\n\t\t\t\t<i>coupon rate per annum</i>: effective non-compounding rate of annual return.<br />\n\t\t\t\tNote: approximate rates assume 870 sats network transaction fees (550 swap, 320 redeem)―paid\n\t\t\t\tto miners.\n\t\t\t</p>\n\t\t{:else}\n\t\t\t<div style=\"text-align:center\">\n\t\t\t\t<h2>loading</h2>\n\t\t\t\t<Loading />\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</section>\n\n<style>\n\th1 {\n\t\tmargin: 2px;\n\t}\n\th2 {\n\t\tmargin: 2px;\n\t}\n\tp {\n\t\ttext-overflow: ellipsis;\n\t\tmargin: 2px;\n\t}\n\n\t.cashaddr {\n\t\tline-break: anywhere;\n\t}\n\t.couponTable {\n\t\twidth: 100%;\n\t\tborder-collapse: collapse;\n\t}\n\tthead tr td {\n\t\tborder: 2px ridge rgba(247, 202, 248, 0.6);\n\t\tbackground-color: #ffffff5b;\n\t}\n\n\tthead tr:nth-child(odd) {\n\t\ttext-align: center;\n\n\t\tfont-weight: 900;\n\t}\n\n\n\t.couponList {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tlist-style-type: none;\n\t}\n\n\t\n\ttbody tr:nth-child(odd) {\n\t\tbackground-color: #ff33cc1f;\n\t}\n\ttbody tr:nth-child(even) {\n\t\tbackground-color: #e495e41a;\n\t}\n\t.r {\n\t\ttext-align: right;\n\t}\n\n\ttbody tr td {\n\t\tborder: 2px ridge rgba(247, 202, 248, 0.6);\n\t}\n</style>\n"],"names":["prerender","load","params","url","isMainnet","$$render","consequent","alternate","time","$.proxy","$$props","now","key","coupons","$.state","electrumClient","walletScriptHash","scripthash","Vault","connectionStatus","contractState","timer","couponGrouped","page","prefix","baseTicker","baseSeries","server","bchIcon","BCH","tBCH","explorer","SERIES_MAP","TIMELOCK_MAP","TIMELOCK_MAP_CHIPNET","threads","walletUnspent","broadcastQueue","vaultCache","openCouponInterest","couponTotal","wallet","walletBalance","sumVault","sumVaultTokens","vaultAddress","updateVault","response","$.set","u","sumUtxoValue","$.get","sumTokenAmounts","updateCoupons","locktime","placement","value","a","b","acc","c","debounceUpdateWallet","updateWallet","debounceBroadcastQue","tx","broadcast","sleep","e","handlePlacement","coupon","vaultUtxos","swapTx","transactionHex","binToHex","encodeTransactionBch","raw_tx","ConnectionStatus","handleNotifications","data","d","onMount","BaseWallet","IndexedDBProvider","Wallet","TestNetWallet","getHdPrivateKey","lockingBytecodeResult","cashAddressToLockingBytecode","getScriptHash","ElectrumClient","USER_AGENT","consequent_1","consequent_2","getFutureBlockDate","consequent_5","alternate_3","consequent_4","alternate_2","consequent_3","alternate_1","consequent_6","$.index","$$anchor","subList","$.each","node_10","i","consequent_7","consequent_8","alternate_4","consequent_9","alternate_5","ul","COUPON_SERIES","expression","$.derived","tbody","consequent_10","consequent_11","$0","consequent_12","alternate_6","consequent_13","alternate_7"],"mappings":"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"}