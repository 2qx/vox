import{f as v,a as n,t as ue,c as bt}from"../chunks/DTc5U4eY.js";import{o as fe,a as he}from"../chunks/_R59KZhj.js";import{p as pt,f as h,c as r,r as o,s,a as xt,t as p,aB as O,ao as ft,ay as ge,ak as T,I as e,af as be,aA as ke}from"../chunks/CQU5mOuk.js";import{s as k,d as Ft,h as pe}from"../chunks/CF3aPdyL.js";import{a as xe}from"../chunks/Cm-IrJru.js";import{i as _}from"../chunks/CZ0rTjPC.js";import{e as dt,i as ye}from"../chunks/CbL2L94E.js";import{s as st,a as z}from"../chunks/-rOGAMhN.js";import{s as Rt}from"../chunks/BfYLLTK_.js";import{s as _t}from"../chunks/DBDCTY7c.js";import{p as we}from"../chunks/Bvryzxxf.js";import{h as je}from"../chunks/DM0FqWsN.js";import{B as Se,t as Te}from"../chunks/B-JAlK32.js";import{h as Ut,C as Ce,a as De,V as Pt}from"../chunks/Bt3MikUi.js";import{j as qe,d as Me,s as Ae,b as He,k as Oe}from"../chunks/BQUio51k.js";import{I as Ee,B as Ne,W as Be,T as Ie,g as We,a as Re}from"../chunks/BTBIn4-B.js";import{$ as Ue,a as Lt}from"../chunks/BDt1pbpk.js";import{C as Pe}from"../chunks/B7hCbxZp.js";import{D as Le}from"../chunks/DMvn4Q5j.js";import{B as Vt,t as zt}from"../chunks/B2Xzehbr.js";/* empty css                */import{T as Yt}from"../chunks/DxhSOfUG.js";import{T as Gt}from"../chunks/otdWaXgM.js";var Fe=v(' <img height="16px"/>',1),Ve=v('immutable <img height="16px"/>',1),ze=v("Vox: <i> </i>",1),Ye=v("CatDex: <i> </i>",1),Ge=v('<div class="capability svelte-1i3diei"><!></div> <div class="commitment svelte-1i3diei"><!></div>',1);function Kt(N,t){pt(t,!0);var A=Ge(),W=h(A),at=r(W);{var L=g=>{var x=Fe(),j=h(x),B=s(j);p(()=>{k(j,`${t.capability??""} `),st(B,"src",`./${t.capability}.svg`)}),n(g,x)},R=g=>{var x=Ve(),j=s(h(x));st(j,"src","./immutable.svg"),n(g,x)};_(at,g=>{t.capability?g(L):g(R,!1)})}o(W);var m=s(W,2),it=r(m);{var Y=g=>{var x=ze(),j=s(h(x)),B=r(j,!0);o(j),p(S=>k(B,S),[()=>Ut(t.commitment)]),n(g,x)},C=(g,x)=>{{var j=S=>{var E=Ye(),G=s(h(E)),F=r(G,!0);o(G),p(rt=>k(F,rt),[()=>Ut(t.commitment)]),n(S,E)},B=S=>{var E=ue();p(()=>k(E,t.commitment)),n(S,E)};_(g,S=>{t.commitment.startsWith("6a03553358")?S(j):S(B,!1)},x)}};_(it,g=>{t.commitment.startsWith("6a03553356")?g(Y):g(C,!1)})}o(m),n(N,A),xt()}var Ke=v("<div><!></div> <div><!></div>",1),Je=v('<img width="16px"/> <b>BCH</b> ',1),Qe=v('<div class="container svelte-51hfp3"><div class="post svelte-51hfp3"><div class="balance svelte-51hfp3"><div><!></div> <div class="fill svelte-51hfp3"><!></div> <div><!></div></div> <div class="header svelte-51hfp3"><div class="timestamp svelte-51hfp3"> </div> <div class="fill svelte-51hfp3"></div> <div class="timestamp svelte-51hfp3"> </div></div></div></div>');function kt(N,t){pt(t,!0);let A=t.isMainnet?Vt:zt;var W=Qe(),at=r(W),L=r(at),R=r(L),m=r(R);{var it=D=>{Gt(D,{get category(){return t.token_data.category},size:16,get isMainnet(){return t.isMainnet}})};_(m,D=>{t.token_data&&D(it)})}o(R);var Y=s(R,2),C=r(Y);{var g=D=>{var K=Ke(),f=h(K),I=r(f);Yt(I,{get amount(){return t.token_data.amount},get category(){return t.token_data.category},get isMainnet(){return t.isMainnet}}),o(f);var U=s(f,2),lt=r(U);{var nt=ct=>{Kt(ct,_t(()=>t.token_data.nft))};_(lt,ct=>{t.token_data.nft&&ct(nt)})}o(U),n(D,K)};_(C,D=>{t.token_data&&D(g)})}o(Y);var x=s(Y,2),j=r(x);{var B=D=>{var K=Je(),f=h(K),I=s(f,3);p(U=>{st(f,"src",A),k(I,` ${U??""}`)},[()=>Number(t.value/1e8).toLocaleString(void 0,{})]),n(D,K)};_(j,D=>{t.value>1000n&&D(B)})}o(x),o(L);var S=s(L,2),E=r(S),G=r(E);o(E);var F=s(E,4),rt=r(F,!0);o(F),o(S),o(at),o(W),p(()=>{k(G,`${t.tx_hash??""} : ${t.tx_pos??""}`),k(rt,t.height)}),n(N,W),xt()}const Xe=!0,or=Object.freeze(Object.defineProperty({__proto__:null,prerender:Xe},Symbol.toStringTag,{value:"Module"})),Ze=""+new URL("../assets/cashTokens.DElA22mH.svg",import.meta.url).href;var $e=v("<div><!></div> <div><!></div>",1),ta=v('<img width="16px"/> <b>BCH</b> ',1),ea=(N,t)=>{t.redeemFutures(t.tx_hash,t.tx_pos,t.locktime,t.token_data.amount)},aa=v('<button class="action svelte-ehjqay">redeem</button>'),ra=v('<div class="container svelte-ehjqay"><div class="post svelte-ehjqay"><div class="balance svelte-ehjqay"><div><!></div> <div class="fill svelte-ehjqay"><!></div> <div><!> <!></div></div> <div class="header svelte-ehjqay"><div class="timestamp svelte-ehjqay"> </div> <div class="fill svelte-ehjqay"></div> <div class="timestamp svelte-ehjqay"> </div></div></div></div>');function oa(N,t){pt(t,!0);let A=t.isMainnet?Vt:zt;var W=ra(),at=r(W),L=r(at),R=r(L),m=r(R);{var it=f=>{Gt(f,{get category(){return t.token_data.category},size:16,get isMainnet(){return t.isMainnet}})};_(m,f=>{t.token_data&&f(it)})}o(R);var Y=s(R,2),C=r(Y);{var g=f=>{var I=$e(),U=h(I),lt=r(U);Yt(lt,{get amount(){return t.token_data.amount},get category(){return t.token_data.category},get isMainnet(){return t.isMainnet}}),o(U);var nt=s(U,2),ct=r(nt);{var yt=ht=>{Kt(ht,_t(()=>t.token_data.nft))};_(ct,ht=>{t.token_data.nft&&ht(yt)})}o(nt),n(f,I)};_(C,f=>{t.token_data&&f(g)})}o(Y);var x=s(Y,2),j=r(x);{var B=f=>{var I=ta(),U=h(I),lt=s(U,3);p(nt=>{st(U,"src",A),k(lt,` ${nt??""}`)},[()=>Number(t.value/1e8).toLocaleString(void 0,{})]),n(f,I)};_(j,f=>{t.value>1000n&&f(B)})}var S=s(j,2);{var E=f=>{var I=aa();I.__click=[ea,t],n(f,I)};_(S,f=>{t.now>=t.locktime&&f(E)})}o(x),o(L);var G=s(L,2),F=r(G),rt=r(F);o(F);var D=s(F,4),K=r(D,!0);o(D),o(G),o(at),o(W),p(()=>{k(rt,`${t.tx_hash??""} : ${t.tx_pos??""}`),k(K,t.height)}),n(N,W),xt()}Ft(["click"]);const sa=(N,t)=>{T(t,!e(t))};var ia=v('<meta name="description" content="Vox Wallet."/>'),na=v("<img/>"),va=v('<img alt="Disconnected"/>'),la=(N,t)=>{T(t,!e(t))},ca=v('<button aria-label="toggle address" class="svelte-1odnjkb"><qr-code><img width="30px" slot="icon"/></qr-code></button> <p id="deposit" style="text-align: center;"> </p>',3),da=(N,t)=>{T(t,!e(t))},_a=v('<button aria-label="toggle address" class="svelte-1odnjkb"><qr-code><img width="30px" slot="icon"/></qr-code></button> <p id="deposit" style="text-align: center;"> </p>',3),ma=v("<b> </b>"),ua=v('<h3 class="svelte-1odnjkb">assets : cash</h3> <!>',1),fa=v('<h3 class="svelte-1odnjkb">assets : commodities</h3> <!>',1),ha=v('<h3 class="svelte-1odnjkb">assets : commodities : futures</h3> <!>',1),ga=v('<h3 class="svelte-1odnjkb">assets : authentication</h3> <!>',1),ba=v('<h3 class="svelte-1odnjkb">assets : other</h3> <!>',1),ka=(N,t)=>t(),pa=(N,t)=>t(),xa=v('<!> <!> <!> <!> <!> <div class="walletHead svelte-1odnjkb"><button class="svelte-1odnjkb">Consolidate Tokens</button> <button class="svelte-1odnjkb">Consolidate Sats</button></div>',1),ya=v("<p>loading wallet...</p>"),wa=v('<h3 class="svelte-1odnjkb">DO NOT SHARE WITH ANYONE!</h3> <p> </p> ',1),ja=(N,t)=>{T(t,!e(t))},Sa=v('<pre class="svelte-1odnjkb"> </pre>'),Ta=v('<pre class="svelte-1odnjkb"> </pre>'),Ca=v('<pre class="svelte-1odnjkb"> </pre>'),Da=v('<!> <pre class="svelte-1odnjkb"> </pre> <pre class="svelte-1odnjkb"> </pre> <pre class="svelte-1odnjkb"> </pre> <!> <pre class="svelte-1odnjkb">   &nbsp;</pre>',1),qa=v("<p>no history</p>"),Ma=v('<p style="color: red"> </p>'),Aa=v("<p>...getting history</p>"),Ha=v('<h3 class="svelte-1odnjkb">History</h3> <!>',1),Oa=v('<div class="showSeed svelte-1odnjkb"><button class="svelte-1odnjkb">Show/hide backup</button> <!></div> <div class="history"><button class="svelte-1odnjkb">Show/hide History</button> <!></div>',1),Ea=v('<section><div class="status svelte-1odnjkb"><!> <div class="scanable svelte-1odnjkb"><!> <!></div></div> <div><!> <!></div></section>');function sr(N,t){pt(t,!0);const A=we.url.hostname=="vox.cash";let W=A?"bch.imaginary.cash":"chipnet.bch.ninja";const at=A?Se:Te,L=A?Ce:De;let R=O(0),m=O(void 0),it=O(""),Y=O(0),C,g=O(""),x=O(""),j=O(!0),B=O(ft([])),S=O(ft([])),E=O(ft([])),G=O(ft([])),F=O(ft([])),rt=O(ft([])),D=O(!1),K=O(""),f=O(!1);const I=Object.entries(at.identities).map(a=>Object.values(Object.values(a[1]))).flat().reduce((a,i)=>(a.set(i.token.category,i),a),new Map),U=function(a){if(a.method==="blockchain.headers.subscribe"){T(g,Lt[C.status],!0);let i=a.params[0];T(R,i.height,!0)}else a.method==="blockchain.scripthash.subscribe"?At():console.log(a)};async function lt(a,i,b,Z){let J=e(B)?.filter(c=>c.tx_hash==a&&c.tx_pos==i).pop(),q=await C.request("blockchain.scripthash.listunspent",Pt.getScriptHash(b),"include_tokens");if(q=q.filter(c=>c.token_data?.category==J?.token_data?.category),console.log(q),J){let c=[...e(S),J],y=Pt.swap(-Z,q,c,b,e(it)),l=He(Oe(y.transaction));console.log(l),yt(l)}}async function nt(){const a=e(m).getTokenDepositAddress();let i=(await e(m).getUtxos()).filter(c=>c.token).filter(c=>c.token.amount>0).filter(c=>!c.token.capability),b=i.map(c=>c.token.tokenId),Z=b.filter((c,y)=>b.indexOf(c)!==y),q=[...new Set(Z.map(c=>c))].map(c=>{const y=i.filter(l=>l.token.tokenId==c&&l.token.amount>0n).map(l=>l.token.amount||0n).reduce((l,ot)=>l+ot,0n);return new Re({cashaddr:a,value:800,amount:y,tokenId:c})});return await e(m).send(q)}async function ct(){return await e(m).sendMax(e(m).getDepositAddress())}const yt=async function(a){let i=await C.request("blockchain.transaction.broadcast",a);if(i instanceof Error)throw T(g,Lt[C.status],!0),i},ht=function(a){let i=Object.groupBy(a,({token_data:b})=>b?I.has(b.category)&&Number(b?.amount)>0?"commodity":L.has(b.category)?"future":b.nft?.commitment.startsWith("6a035533")?"auth":"other":"cash");return T(S,i.cash,!0),T(E,i.commodity,!0),T(G,i.future,!0),T(F,i.auth,!0),T(rt,i.other,!0),a},At=async function(){console.log("updating wallet...");let a=await C.request("blockchain.scripthash.listunspent",e(K),"include_tokens");if(a instanceof Error)throw a;T(B,ht(a),!0),T(Y,Ae(e(B),!0),!0)};fe(async()=>{try{Ne.StorageProvider=Ee,T(m,A?await Be.named("vox"):await Ie.named("vox"),!0),T(it,We(e(m).mnemonic,e(m).derivationPath.slice(0,-2),e(m).isTestnet),!0);let a=qe(e(m).getDepositAddress());if(typeof a=="string")throw a;T(K,Me(a.bytecode,!0),!0),C=new Ue("vox/wallet","1.4.1",W);try{await C.connect()}catch(i){T(x,i,!0)}C.on("notification",U),await C.subscribe("blockchain.scripthash.subscribe",e(K)),await C.subscribe("blockchain.headers.subscribe"),await At()}catch(a){throw a}}),he(async()=>{await e(m).provider.disconnect(),await C.disconnect()});var wt=Ea();pe(a=>{var i=ia();ge.title="ðŸ‘› Wallet",n(a,i)});var jt=r(wt),Ht=r(jt);{var Jt=a=>{var i=na();p(()=>{st(i,"src",Pe),st(i,"alt",e(g))}),n(a,i)},Qt=a=>{var i=va();p(()=>st(i,"src",Le)),n(a,i)};_(Ht,a=>{e(g)=="CONNECTED"?a(Jt):a(Qt,!1)})}var Ot=s(Ht,2),Et=r(Ot);{var Xt=a=>{var i=bt(),b=h(i);{var Z=q=>{var c=ca(),y=h(c);y.__click=[la,j];var l=r(y);z(l,"id","qr1"),p(()=>z(l,"contents",e(m).getDepositAddress())),z(l,"module-color","#000"),z(l,"position-ring-color","#8dc351"),z(l,"position-center-color","#ff00ec"),z(l,"mask-x-to-y-ratio","1.2"),Rt(l,`width: 150px;
                height: 150px;
                margin: 0.5em auto;
                background-color: #fff;`);var ot=r(l);o(l),o(y);var H=s(y,2),Q=r(H,!0);o(H),p(V=>{st(ot,"src",je),k(Q,V)},[()=>e(m).getDepositAddress()]),n(q,c)},J=q=>{var c=_a(),y=h(c);y.__click=[da,j];var l=r(y);z(l,"id","qr1"),p(()=>z(l,"contents",e(m).getTokenDepositAddress())),z(l,"module-color","#000"),z(l,"position-ring-color","#8dc351"),z(l,"position-center-color","#ff00ec"),z(l,"mask-x-to-y-ratio","1.2"),Rt(l,`width: 150px;
                height: 150px;
                margin: 0.5em auto;
                background-color: #fff;`);var ot=r(l);o(l),o(y);var H=s(y,2),Q=r(H,!0);o(H),p(V=>{st(ot,"src",Ze),k(Q,V)},[()=>e(m).getTokenDepositAddress()]),n(q,c)};_(b,q=>{e(j)?q(J,!1):q(Z)})}n(a,i)};_(Et,a=>{e(m)&&a(Xt)})}var Zt=s(Et,2);{var $t=a=>{var i=ma(),b=r(i,!0);o(i),p(()=>k(b,e(x))),n(a,i)};_(Zt,a=>{e(x)&&a($t)})}o(Ot),o(jt);var Nt=s(jt,2),Bt=r(Nt);{var te=a=>{var i=xa(),b=h(i);{var Z=d=>{var w=ua(),X=s(h(w),2);dt(X,19,()=>e(S),u=>u.tx_hash+":"+u.tx_pos,(u,M)=>{kt(u,_t(()=>e(M),()=>({isMainnet:A})))}),n(d,w)};_(b,d=>{e(S).length>0&&d(Z)})}var J=s(b,2);{var q=d=>{var w=fa(),X=s(h(w),2);dt(X,19,()=>e(E),u=>u.tx_hash+":"+u.tx_pos,(u,M)=>{kt(u,_t(()=>e(M),()=>({isMainnet:A})))}),n(d,w)};_(J,d=>{e(E).length>0&&d(q)})}var c=s(J,2);{var y=d=>{var w=ha(),X=s(h(w),2);dt(X,19,()=>e(G),u=>u.tx_hash+":"+u.tx_pos,(u,M)=>{const mt=be(()=>L.get(e(M).token_data?.category));oa(u,_t(()=>e(M),()=>({isMainnet:A}),{get locktime(){return e(mt)},get now(){return e(R)},redeemFutures:lt}))}),n(d,w)};_(c,d=>{e(G).length>0&&d(y)})}var l=s(c,2);{var ot=d=>{var w=ga(),X=s(h(w),2);dt(X,19,()=>e(F),u=>u.tx_hash+":"+u.tx_pos,(u,M)=>{kt(u,_t(()=>e(M),()=>({isMainnet:A})))}),n(d,w)};_(l,d=>{e(F).length>0&&d(ot)})}var H=s(l,2);{var Q=d=>{var w=ba(),X=s(h(w),2);dt(X,19,()=>e(rt),u=>u.tx_hash+":"+u.tx_pos,(u,M)=>{kt(u,_t(()=>e(M),{get isMainnet(){return A}}))}),n(d,w)};_(H,d=>{e(rt).length>0&&d(Q)})}var V=s(H,2),$=r(V);$.__click=[ka,nt];var tt=s($,2);tt.__click=[pa,ct],o(V),n(a,i)},ee=a=>{var i=ya();n(a,i)};_(Bt,a=>{e(B)?a(te):a(ee,!1)})}var ae=s(Bt,2);{var re=a=>{var i=Oa(),b=h(i),Z=r(b);Z.__click=[sa,D];var J=s(Z,2);{var q=H=>{var Q=wa(),V=s(h(Q),2),$=r(V,!0);o(V);var tt=s(V);p((d,w)=>{k($,d),k(tt,` Note: vox.cash ${w??""}`)},[()=>e(m).toDbString(),()=>new Date().toLocaleDateString()]),n(H,Q)};_(J,H=>{e(D)&&H(q)})}o(b);var c=s(b,2),y=r(c);y.__click=[ja,f];var l=s(y,2);{var ot=H=>{var Q=Ha(),V=s(h(Q),2);xe(V,()=>e(m).getHistory({unit:"sat",fromHeight:e(R)-10}),$=>{var tt=Aa();n($,tt)},($,tt)=>{var d=bt(),w=h(d);{var X=M=>{var mt=bt(),oe=h(mt);dt(oe,19,()=>e(tt),St=>St.hash,(St,vt)=>{var It=Da(),Wt=h(It);{var se=et=>{var P=Sa(),ut=r(P,!0);o(P),p(gt=>k(ut,gt),[()=>new Date(e(vt).timestamp*1e3).toISOString()]),n(et,P)},ie=et=>{var P=Ta(),ut=r(P,!0);o(P),p(gt=>k(ut,gt),[()=>new Date().toISOString()]),n(et,P)};_(Wt,et=>{e(vt).timestamp>0?et(se):et(ie,!1)})}var Tt=s(Wt,2),ne=r(Tt);o(Tt);var Ct=s(Tt,2),ve=r(Ct);o(Ct);var Dt=s(Ct,2),le=r(Dt);o(Dt);var ce=s(Dt,2);dt(ce,17,()=>e(vt).tokenAmountChanges,ye,(et,P)=>{var ut=bt(),gt=h(ut);{var de=qt=>{var Mt=Ca(),_e=r(Mt);o(Mt),p(me=>k(_e,`  assets:cash:tokens  ${me??""} ${e(P).tokenId??""} `),[()=>e(P).amount.toLocaleString()]),n(qt,Mt)};_(gt,qt=>{e(P).amount!=0n&&qt(de)})}n(et,ut)}),ke(2),p((et,P)=>{k(ne,`# ${e(vt).blockHeight??""}â–  ${e(vt).hash??""} `),k(ve,`  assets:cash    ${et??""} sat`),k(le,`  expenses:fees  ${P??""} sat # ${e(vt).size??""} bytes`)},[()=>e(vt).valueChange.toLocaleString().padStart(14),()=>e(vt).fee.toLocaleString().padStart(14)]),n(St,It)}),n(M,mt)},u=M=>{var mt=qa();n(M,mt)};_(w,M=>{e(tt).length>0?M(X):M(u,!1)})}n($,d)},($,tt)=>{var d=Ma(),w=r(d,!0);o(d),p(()=>k(w,e(tt).message)),n($,d)}),n(H,Q)};_(l,H=>{e(f)&&H(ot)})}o(c),n(a,i)};_(ae,a=>{e(m)&&a(re)})}o(Nt),o(wt),n(N,wt),xt()}Ft(["click"]);export{sr as component,or as universal};
//# sourceMappingURL=17.Dt_jjhMB.js.map
