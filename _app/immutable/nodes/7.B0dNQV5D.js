import{f as g,a as v,t as q,c as te}from"../chunks/DTc5U4eY.js";import{o as ae}from"../chunks/_R59KZhj.js";import{aA as re,p as G,c,r as l,s as m,t as k,a as J,aB as u,ao as W,I as o,ak as n,f as oe}from"../chunks/CQU5mOuk.js";import{s as T,d as se}from"../chunks/CF3aPdyL.js";import{i as S}from"../chunks/CZ0rTjPC.js";import{e as ie,i as ne}from"../chunks/CbL2L94E.js";import{r as ce,s as j}from"../chunks/-rOGAMhN.js";import{b as le}from"../chunks/Oj09dCTU.js";import{s as ve}from"../chunks/DBDCTY7c.js";import{g as de}from"../chunks/B3ekedj9.js";import{p as me}from"../chunks/D-zPtVSw.js";import"../chunks/CuzQ0eOn.js";import{B as fe}from"../chunks/BzLj6JBc.js";import{C as ue}from"../chunks/B7hCbxZp.js";import{D as he}from"../chunks/DMvn4Q5j.js";import"../chunks/Bt3MikUi.js";import{o as pe,h as be,b as _e,k as ge,j as ke,d as ye}from"../chunks/BQUio51k.js";import{I as xe,B as we,W as Te,T as Se,g as Ee,N as Ne}from"../chunks/BTBIn4-B.js";import{T as ze}from"../chunks/otdWaXgM.js";/* empty css                */import{S as A}from"../chunks/zv45hi4S.js";import{a as U,$ as Be}from"../chunks/BDt1pbpk.js";const Ce=!0,De=({params:h,url:a})=>({key:a.searchParams.get("key")}),mt=Object.freeze(Object.defineProperty({__proto__:null,load:De,prerender:Ce},Symbol.toStringTag,{value:"Module"}));var Ie=g('<h3>About SmallIndex</h3> <p>Small Index is a key-value database protocol for storage small entries (on CashToken NFT commitments) at a rate of 1 satoshi per block for up to a year.</p> <p>More information about <a href="https://bitcoincashresearch.org/t/a-small-key-value-index-contract/1471" rel="nofollow">the contract</a></p>',1);function Ae(h){var a=Ie();re(4),v(h,a)}var Pe=g("<div><!></div>"),He=g('<pre class="svelte-1i23zbt"> </pre>'),Me=g('<pre class="svelte-1i23zbt"> undefined</pre>'),Oe=g('<div class="container svelte-1i23zbt"><div class="post svelte-1i23zbt"><div class="balance svelte-1i23zbt"><div><!></div> <div class="fill svelte-1i23zbt"><!></div> <div><!></div></div> <div class="header svelte-1i23zbt"><div class="fill svelte-1i23zbt"></div> <div class="timestamp svelte-1i23zbt"> </div></div></div></div>');function Re(h,a){G(a,!0);var p=Oe(),E=c(p),d=c(E),b=c(d),i=c(b);{var N=r=>{var s=Pe(),y=c(s);ze(y,{size:24,get category(){return a.token_data.category}}),l(s),v(r,s)};S(i,r=>{a.token_data&&r(N)})}l(b);var f=m(b,2),x=c(f);{var _=r=>{var s=He(),y=c(s);l(s),k(R=>T(y,` ${R??""}`),[()=>pe(be(a.token_data.nft.commitment))]),v(r,s)},P=r=>{var s=Me();v(r,s)};S(x,r=>{a.token_data.nft.commitment?r(_):r(P,!1)})}l(f);var w=m(f,2),H=c(w);{var z=r=>{var s=q();k(()=>T(s,a.height+a.value-a.now)),v(r,s)},M=r=>{var s=q();k(()=>T(s,a.height)),v(r,s)};S(H,r=>{a.height>0?r(z):r(M,!1)})}l(w),l(d);var B=m(d,2),C=m(c(B),2),O=c(C,!0);l(C),l(B),l(E),l(p),k(r=>T(O,r),[()=>Number(a.value).toLocaleString(void 0,{})]),v(h,p),J()}var We=g("<img/>"),je=g('<img alt="Disconnected"/>'),qe=(h,a)=>a(),Fe=(h,a)=>a(),Le=g('<section><div class="status svelte-6t9umo"><!> <!></div> <label for="key">Key:</label> <input id="key" placeholder="enter the index key"/> <br/> <br/> <!> <br/> <br/> <button class="svelte-6t9umo">Clear Expired</button> <!></section>');function ft(h,a){G(a,!0);let p=u(0),E=u(""),d=u(W(a.data.key?a.data.key:""));console.log(o(d));let b=u(""),i,N=u(""),f=u(void 0),x=u(""),_=u(W([])),P=u(W([]));const w=me.url.hostname=="vox.cash",H=w?"bch.imaginary.cash":"chipnet.bch.ninja";async function z(){de(`?key=${o(d)}`,{keepFocus:!0}),i&&o(p)>1e3&&n(_,await i.request("blockchain.scripthash.listunspent",A.getScriptHash(o(d)),"include_tokens"),!0)}const M=async function(){n(_,o(_).filter(I=>I.height+I.value<o(p)),!0),console.log(o(d));let e=A.drop(o(d),o(_)),t=_e(ge(e.transaction));await O(t)},B=function(e){if(n(b,U[i.status],!0),e.method==="blockchain.headers.subscribe"){let t=e.params[0];n(p,t.height,!0),z(),C()}else e.method==="blockchain.scripthash.subscribe"||console.log(e)},C=async function(){let e=await i.request("blockchain.scripthash.listunspent",o(N),"include_tokens");if(e instanceof Error)throw e;n(P,e.filter(t=>t.token_data&&t.token_data.nft&&t.token_data.nft.capability==Ne.minting),!0)},O=async function(e){let t=await i.request("blockchain.transaction.broadcast",e);if(t instanceof Error)throw n(b,U[i.status],!0),n(x,t.message,!0),t;n(x,t,!0)};ae(async()=>{we.StorageProvider=xe,n(f,w?await Te.named("vox"):await Se.named("vox"),!0),n(E,Ee(o(f).mnemonic,o(f).derivationPath.slice(0,-2),o(f).isTestnet),!0);let e=ke(o(f).getDepositAddress());if(typeof e=="string")throw e;n(N,ye(e.bytecode),!0),i=new Be(A.USER_AGENT,"1.4.1",H),await i.connect(),i.on("notification",B),await i.subscribe("blockchain.headers.subscribe")});var r=Le(),s=c(r),y=c(s);fe(y,{get template(){return A.template}});var R=m(y,2);{var Q=e=>{var t=We();k(()=>{j(t,"src",ue),j(t,"alt",o(b))}),v(e,t)},V=e=>{var t=je();k(()=>j(t,"src",he)),v(e,t)};S(R,e=>{o(b)=="CONNECTED"?e(Q):e(V,!1)})}l(s);var D=m(s,4);ce(D),D.__change=[qe,z];var F=m(D,6);{var X=e=>{var t=te(),I=oe(t);ie(I,17,()=>o(_),ne,($,ee)=>{Re($,ve(()=>o(ee),{get now(){return o(p)}}))}),v(e,t)},Y=e=>{var t=q("No Records");v(e,t)};S(F,e=>{o(_).length>0?e(X):e(Y,!1)})}var L=m(F,6);L.__click=[Fe,M];var K=m(L),Z=m(K);Ae(Z),l(r),k(()=>T(K,` ${o(x)??""} `)),le(D,()=>o(d),e=>n(d,e)),v(h,r),J()}se(["change","click"]);export{ft as component,mt as universal};
//# sourceMappingURL=7.B0dNQV5D.js.map
