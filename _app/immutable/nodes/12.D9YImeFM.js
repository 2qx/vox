import{f as d,a as c,d as gt,t as Jt}from"../chunks/DYbKDSXk.js";import{p as Dt,c as i,r as n,s as l,t as g,a as Mt,f as $,E as a,aG as T,ad as u,ac as At,aF as kt,au as ga}from"../chunks/DlUVEpaU.js";import{d as Xt,s as p}from"../chunks/DIwOIcma.js";import{i as m}from"../chunks/C6jlbT71.js";import"../chunks/vmZ8CxnS.js";import{o as ka,a as wa}from"../chunks/CPLxGhQo.js";import{a as xa}from"../chunks/Fv4VhMRE.js";import{e as ya,i as Ta}from"../chunks/CMKxWac-.js";import{s as A,r as qa,c as Ea}from"../chunks/vpaS6ag4.js";import{b as Na,a as Sa}from"../chunks/CdNq2YyO.js";import{p as Ca,s as Pa}from"../chunks/jyPZu9FF.js";import{p as Aa}from"../chunks/DlH6pspA.js";import{$ as Ia,a as It}from"../chunks/CRbVXWIV.js";import{I as Oa,B as za,W as Da,T as Ma,N as Kt,a as Qt}from"../chunks/1C4dGgcF.js";import{b as zt}from"../chunks/B8sppVjI.js";import{b as N,c as Ra,d as Ba,a as Ha}from"../chunks/moW41TmD.js";import{Q as Ot,H as La,p as Ua,I as Yt,b as ft,F as mt,y as Za}from"../chunks/0o8OGYDl.js";import{g as Fa}from"../chunks/TzW3FNAJ.js";import{B as Wa,D as Va}from"../chunks/CReqLTTF.js";import{s as ja}from"../chunks/BLKIXdiW.js";import{C as Ga}from"../chunks/B7hCbxZp.js";const Ka=!0,Qa=({params:h,url:e})=>({postId:e.searchParams.get("postId"),topic:e.searchParams.get("topic")}),ns=Object.freeze(Object.defineProperty({__proto__:null,load:Qa,prerender:Ka},Symbol.toStringTag,{value:"Module"}));var Ya=d("<p>Vox is a chat protocol running on Bitcoin Cash. Messages are stored in temporarily NFTs, then burned after a week… for a more stable future.</p>");function Ja(h){var e=Ya();c(h,e)}const Xa="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='15px'%20fill='%23000'%3e%3cpath%20d='M280-120q-33%200-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0%2033-23.5%2056.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160%200h80v-360h-80v360ZM280-720v520-520Z'/%3e%3c/svg%3e",$a="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='48px'%20viewBox='0%20-960%20960%20960'%20width='48px'%20fill='%23888'%3e%3cpath%20d='M272-120v-512l278-288%2058%2046-52%20242h359v171L767-120H272Zm60-60h397l126-299v-93H482l53-249-203%20214v427Zm0-427v427-427ZM79-120v-512h193v60H139v392h133v60H79Z'/%3e%3c/svg%3e";var te=d('<img height="32px" class="svelte-1kup2az"/>'),ae=d('<div style="width:32px"></div>'),ee=(h,e)=>{u(e,!a(e))},se=d('<div> <button class="svelte-1kup2az"> </button></div>'),re=(h,e)=>{u(e,!a(e))},oe=d('<div> <button class="svelte-1kup2az"> </button></div>'),ie=d('<div class="error svelte-1kup2az"> </div>'),ne=(h,e)=>{e.likePost(e.hash)},le=d('<img height="32px" class="svelte-1kup2az"/>'),ce=d('<div style="width:32px"></div>'),ve=d('<div class="container svelte-1kup2az"><div class="auth svelte-1kup2az"><!></div> <div><div class="footer svelte-1kup2az"><div class="fill svelte-1kup2az"></div> <div class="action"></div></div> <!> <div class="footer svelte-1kup2az"><div class="hash svelte-1kup2az"> </div> <div class="fill svelte-1kup2az"></div> <div class="actions svelte-1kup2az"><button class="svelte-1kup2az"><img height="16px" alt="likes"/> </button></div> <div class="timestamp svelte-1kup2az"> </div></div></div> <div class="auth svelte-1kup2az"><!></div></div>');function de(h,e){Dt(e,!0);let k=T(!1);const F=400;var W=ve(),V=i(W),vt=i(V);{var w=o=>{var r=te();g(L=>{A(r,"src",L),A(r,"alt",e.auth)},[()=>zt(e.auth,16)]),c(o,r)},M=o=>{var r=ae();c(o,r)};m(vt,o=>{e.thisAuth?o(M,!1):o(w)})}n(V);var x=l(V,2),S=l(i(x),2);{var pt=o=>{var r=gt(),L=$(r);{var xt=K=>{var at=se(),Q=i(at),et=l(Q);et.__click=[ee,k];var O=i(et,!0);n(et),n(at),g(()=>{p(Q,`${e.body??""} `),p(O,a(k)?"show less":"show more")}),c(K,at)},yt=(K,at)=>{{var Q=O=>{var Y=oe(),_t=i(Y),ut=l(_t);ut.__click=[re,k];var Tt=i(ut,!0);n(ut),n(Y),g(qt=>{p(_t,`${qt??""} `),p(Tt,a(k)?"show less":"show more")},[()=>e.body.substring(0,F)+" ..."]),c(O,Y)},et=O=>{var Y=Jt();g(()=>p(Y,e.body)),c(O,Y)};m(K,O=>{e.body.length>F+20?O(Q):O(et,!1)},at)}};m(L,K=>{e.body.length>F+20&&a(k)?K(xt):K(yt,!1)})}c(o,r)},q=o=>{var r=ie(),L=i(r,!0);n(r),g(()=>p(L,e.error)),c(o,r)};m(S,o=>{e.error?o(q,!1):o(pt)})}var j=l(S,2),C=i(j),R=i(C,!0);n(C);var ot=l(C,4),G=i(ot);G.__click=[ne,e];var B=i(G),wt=l(B);n(G),n(ot);var I=l(ot,2),it=i(I);n(I),n(j),n(x);var tt=l(x,2),H=i(tt);{var f=o=>{var r=le();g(L=>{A(r,"src",L),A(r,"alt",e.auth)},[()=>zt(e.auth,16)]),c(o,r)},dt=o=>{var r=ce();c(o,r)};m(H,o=>{e.thisAuth?o(f):o(dt,!1)})}n(tt),n(W),g(()=>{ja(x,1,`post ${e.thisAuth?"op":""} `,"svelte-1kup2az"),p(R,e.hash),A(B,"src",$a),p(wt,` ${e.likes??""}`),p(it,`${e.height??""} ■ ${e.sequence??""}`)}),c(h,W),Mt()}Xt(["click"]);var _e=(h,e)=>e(""),ue=d('<a target="_blank"> </a>'),he=d("<img/>"),fe=d('<img alt="Disconnected"/>'),me=(h,e,k)=>e(a(k)),pe=d('<div class="deleteMe svelte-180sfqa"><button class="svelte-180sfqa"><img height="36px"/></button></div>'),be=d("<!> <!>",1),ge=d('<p style="color: red"> </p>'),ke=(h,e)=>e(),we=d('<div class="row footer svelte-180sfqa"><h2>Create new identity</h2> <button class="svelte-180sfqa">New identity 1M sats</button></div>'),xe=d('<div class="row footer svelte-180sfqa"><p><a href="/wallet">Deposit funds</a> to create identity</p></div>'),ye=(h,e)=>e(),Te=d('<img height="32px" alt="avatar" class="svelte-180sfqa"/>'),qe=d('<div style="font-size:x-small;"> <br/> </div>'),Ee=(h,e,k)=>e(a(k)),Ne=d('<div class="edit svelte-180sfqa"><textarea class="svelte-180sfqa"> </textarea> <div class="estimate svelte-180sfqa"> </div></div> <div class="send svelte-180sfqa"><div class="auth svelte-180sfqa"><!> <!></div> <button class="svelte-180sfqa">Send</button></div>',1),Se=d("<p>Not connected?</p>"),Ce=d('<div class="row footer svelte-180sfqa"><!></div>'),Pe=(h,e)=>e(1e7),Ae=(h,e)=>e(1e6),Ie=(h,e)=>e(),Oe=(h,e)=>e(),ze=(h,e)=>e(),De=d('<button class="svelte-180sfqa">Empty Baton Sats</button>'),Me=d('<div class="row footer svelte-180sfqa"><button class="svelte-180sfqa">Top up 10M sats</button> <button class="svelte-180sfqa">Top up 1M sats</button></div> <div class="row footer svelte-180sfqa"><button class="svelte-180sfqa">Clear Old Posts</button> <button class="svelte-180sfqa">Burn Spam</button></div> <div class="row footer svelte-180sfqa"><!></div>',1),Re=d('<div class="box svelte-180sfqa"><div class="row header svelte-180sfqa"> <sub>■</sub> <div style="flex: 2 2 auto;"></div> <b class="svelte-180sfqa"><a href="/pop/">pop</a> </b> <div style="flex: 2 2 auto;"></div> <!> <!> <!></div> <div id="chat" class="row content svelte-180sfqa"><!></div> <!> <div class="row footer svelte-180sfqa"><div style="margin: auto;">Advanced</div> <div><label class="switch svelte-180sfqa"><input type="checkbox" class="svelte-180sfqa"/> <span class="slider round svelte-180sfqa"></span></label></div></div> <!></div>');function Be(h,e){Dt(e,!0);const k=Aa.url.hostname=="vox.cash",F=k?"bitcoincash":"bchtest",W=k?"bch.imaginary.cash":"chipnet.bch.ninja",V=k?"https://explorer.salemkode.com/address/":"https://cbch.loping.net/address/",vt=Ot(`OP_RETURN <"${N.PROTOCOL_IDENTIFIER}">`);let w=T(0),M=T(0),x=T(0),S=T(""),pt=T(""),q=Ca(e,"topic",15),j=T(""),C=T(""),R=T(0),ot=T(0),G=T(!1);const B=kt(()=>N.getScriptHash(q())),wt=kt(()=>N.getAddress(q(),F));let I=T(At([])),it=T(At([])),tt,H="",f,dt="",o,r=T(At([]));const L=()=>{clearTimeout(tt),tt=setTimeout(()=>{Q(),_t()},1500)},xt=async function(t){if(t.method==="blockchain.headers.subscribe"){let s=t.params[0];u(w,s.height,!0)}else t.method==="blockchain.scripthash.subscribe"?t.params[1]!==a(pt)&&(u(pt,t.params[1],!0),u(S,It[f.status],!0),L()):console.log(t)},yt=function(){let t=document.getElementById("chat");var s=t.scrollHeight;t.scrollTo(0,s)},K=async function(t){let s=N.like(q(),t,a(r)[0],(Math.round(a(w)/1e3)+10)*10,H),v=ft(mt(s.transaction));await ht(v)},at=async function(){let t=await f.request("blockchain.headers.get_tip");if(t instanceof Error)throw t;u(w,t.height,!0)},Q=async function(){let t=await f.request("blockchain.scripthash.listunspent",dt,"include_tokens");if(t instanceof Error)throw t;u(M,Yt(t),!0),u(r,t.filter(s=>s.token_data&&s.token_data.nft&&s.token_data.nft.commitment.startsWith(vt)),!0),a(r).length>0&&a(r)[0].token_data&&u(C,a(r)[0].token_data.category,!0)},et=async function(){let t=await o.send([new Qt({cashaddr:o.getTokenDepositAddress(),tokenId:a(r)[0].token_data.category,amount:0,capability:a(r)[0].token_data.nft.capability,commitment:a(r)[0].token_data.nft.commitment,value:800})]);console.log(t)},O=async function(){let t=await f.request("blockchain.scripthash.listunspent",a(B),"include_tokens");if(t instanceof Error)throw t;let s=t.filter(v=>v.height>0&&a(w)-v.height>1e3).slice(0,300);if(s.length>0){let v=N.clear(q(),s,a(r)[0],H,a(w)),_=ft(mt(v.transaction));console.log(_),await ht(_)}},Y=async function(){let t=await f.request("blockchain.scripthash.listunspent",a(B),"include_tokens");if(t instanceof Error)throw t;let s=t.filter(v=>Math.floor(v.value/10)*1e3-v.height<1e3);if(s.length>0){let v=N.clear(q(),s,a(r)[0],H,a(w)),_=ft(mt(v.transaction));console.log(_),await ht(_)}},_t=async function(){let t=await f.request("blockchain.scripthash.listunspent",a(B),"include_tokens");if(t instanceof Error)throw t;u(x,Yt(t),!0);let s=Array.from(new Set(t.map(_=>_.tx_hash))),v=await f.request("blockchain.scripthash.get_history",a(B),a(w)-1e4,-1);u(it,await Ra(f,s),!0),u(I,Ba(v,a(it),q()),!0),u(I,a(I).map(_=>({thisAuth:a(C)==_.auth,..._})),!0),a(I).slice(-1).length>0?u(R,a(I).slice(-1)[0].height<=0?a(I).slice(-1)[0].sequence+1:0,!0):u(R,0)},ut=async function(t){let s=await f.request("blockchain.scripthash.listunspent",a(B),"include_tokens");if(s instanceof Error)throw s;let v=s.filter(b=>b.tx_hash==t.hash).slice(0,300),_=N.clear(q(),v,a(r)[0],H,a(w)),y=ft(mt(_.transaction));await ht(y)},Tt=()=>{clearTimeout(tt),tt=setTimeout(()=>{u(ot,qt(a(j)),!0)},500)},qt=function(t){if(t.length>0){let s=N.post(q(),t,a(r)[0],(Math.round(a(w)/1e3)+10)*10,H,a(R));const v=s.transaction.outputs[s.transaction.outputs.length-1].valueSatoshis;return Number(Za(s.sourceOutputs)-v)}else return 0},$t=async function(t){let s=(Math.round(a(w)/1e3)+10)*10,v=N.post(q(),t,a(r)[0],s,H,a(R)),_=ft(mt(v.transaction));await ht(_),u(j,"")},ht=async function(t){let s=await f.request("blockchain.transaction.broadcast",t);if(u(R,a(R)+1),s instanceof Error)throw u(S,It[f.status],!0),s},ta=async function(){await o.sendMax(o.getDepositAddress());let t=Ot(`OP_RETURN <"${N.PROTOCOL_IDENTIFIER}"> <"pseudonymous">`);await o.tokenGenesis({cashaddr:o.getTokenDepositAddress(),commitment:t,capability:Kt.minting,value:1e6})},Rt=async function(t){u(M,a(r)[0].value,!0),u(C,a(r)[0].token_data.category,!0);let s=Ot(`OP_RETURN <"${N.PROTOCOL_IDENTIFIER}"> <"pseudonymous">`);await o.send(new Qt({cashaddr:o.getTokenDepositAddress(),tokenId:a(C),commitment:s,capability:Kt.minting,value:a(M)+t})),await Q()};ka(async()=>{za.StorageProvider=Oa,o=k?await Da.named("vox"):await Ma.named("vox"),H=Fa(o.mnemonic,o.derivationPath.slice(0,-2),o.isTestnet);let t=La(o.getDepositAddress());if(typeof t=="string")throw t;dt=Ua(t.bytecode),f=new Ia(N.USER_AGENT,"1.4.1",W),await f.connect(),f.on("notification",xt),u(S,It[f.status],!0),await f.subscribe("blockchain.scripthash.subscribe",a(B)),await f.subscribe("blockchain.scripthash.subscribe",dt),await at(),await Q(),await _t(),yt()}),wa(async()=>{await o.provider.disconnect(),await f.disconnect()});var Et=Re(),Nt=i(Et),Bt=i(Nt,!0),Ht=l(Bt,2),St=l(Ht,3),Lt=i(St);Lt.__click=[_e,q];var aa=l(Lt);n(St);var Ut=l(St,4);{var ea=t=>{var s=ue(),v=i(s);n(s),g(_=>{A(s,"href",`${V}${a(wt)??""}`),p(v,`${_??""}k sats  `)},[()=>Math.floor(Number(a(x))/1e3).toLocaleString()]),c(t,s)};m(Ut,t=>{a(x)&&t(ea)})}var Zt=l(Ut,2);Wa(Zt,{get template(){return N.template}});var sa=l(Zt,2);{var ra=t=>{var s=he();g(()=>{A(s,"src",Ga),A(s,"alt",a(S))}),c(t,s)},oa=t=>{var s=fe();g(()=>A(s,"src",Va)),c(t,s)};m(sa,t=>{a(S)=="CONNECTED"?t(ra):t(oa,!1)})}n(Nt);var Ct=l(Nt,2),ia=i(Ct);{var na=t=>{var s=gt(),v=$(s);xa(v,()=>a(it),null,(_,y)=>{var b=gt(),U=$(b);ya(U,17,()=>a(I),Ta,(nt,lt)=>{var E=be(),z=$(E);de(z,Pa({likePost:K},()=>a(lt)));var st=l(z,2);{var Z=J=>{var rt=pe(),D=i(rt);D.__click=[me,ut,lt];var X=i(D);n(D),n(rt),g(()=>A(X,"src",Xa)),c(J,rt)};m(st,J=>{a(G)&&J(Z)})}c(nt,E)}),c(_,b)},(_,y)=>{var b=ge(),U=i(b,!0);n(b),g(()=>p(U,a(y).message)),c(_,b)}),c(t,s)};m(ia,t=>{a(it)&&t(na)})}n(Ct);var Ft=l(Ct,2);{var la=t=>{var s=we(),v=l(i(s),2);v.__click=[ke,ta],n(s),c(t,s)},ca=(t,s)=>{{var v=y=>{var b=xe();c(y,b)},_=y=>{var b=Ce(),U=i(b);{var nt=E=>{var z=Ne(),st=$(z),Z=i(st);Ea(Z),Z.__keyup=[ye,Tt];var J=l(Z,2),rt=i(J);n(J),n(st);var D=l(st,2),X=i(D),Gt=i(X);{var _a=P=>{var ct=Te();g(bt=>A(ct,"src",bt),[()=>zt(a(C),16)]),c(P,ct)};m(Gt,P=>{a(C)&&P(_a)})}var ua=l(Gt,2);{var ha=P=>{var ct=qe(),bt=i(ct,!0),ma=l(bt,2);n(ct),g((pa,ba)=>{p(bt,pa),p(ma,` ${ba??""}sats`)},[()=>Ha(a(r)[0].token_data.nft.commitment),()=>a(r)[0].value.toLocaleString()]),c(P,ct)};m(ua,P=>{a(r).length>0&&P(ha)})}n(X);var fa=l(X,2);fa.__click=[Ee,$t,j],n(D),g(P=>p(rt,`${P??""} sats`),[()=>a(ot).toLocaleString()]),Sa(Z,()=>a(j),P=>u(j,P)),c(E,z)},lt=E=>{var z=Se();c(E,z)};m(U,E=>{a(S)=="CONNECTED"?E(nt):E(lt,!1)})}n(b),c(y,b)};m(t,y=>{a(M)<11e5&&a(r).length==0?y(v):y(_,!1)},s)}};m(Ft,t=>{a(M)>1e6&&a(r).length==0?t(la):t(ca,!1)})}var Pt=l(Ft,2),Wt=l(i(Pt),2),Vt=i(Wt),jt=i(Vt);qa(jt),ga(2),n(Vt),n(Wt),n(Pt);var va=l(Pt,2);{var da=t=>{var s=gt(),v=$(s);{var _=y=>{var b=Me(),U=$(b),nt=i(U);nt.__click=[Pe,Rt];var lt=l(nt,2);lt.__click=[Ae,Rt],n(U);var E=l(U,2),z=i(E);z.__click=[Ie,O];var st=l(z,2);st.__click=[Oe,Y],n(E);var Z=l(E,2),J=i(Z);{var rt=D=>{var X=De();X.__click=[ze,et],c(D,X)};m(J,D=>{a(C)&&D(rt)})}n(Z),c(y,b)};m(v,y=>{a(r).length>0&&y(_)})}c(t,s)};m(va,t=>{a(G)&&t(da)})}n(Et),g(t=>{p(Bt,t),p(Ht,` ${a(R)??""} `),p(aa,` ${q()??""}`)},[()=>a(w).toLocaleString()]),Na(jt,()=>a(G),t=>u(G,t)),c(h,Et),Mt()}Xt(["click","keyup"]);var He=d("<!> <!>",1);function ls(h,e){Dt(e,!0);let k=kt(()=>e.data.topic),F=kt(()=>e.data.postId);var W=He(),V=$(W);{var vt=x=>{var S=Jt();g(()=>p(S,`You are viewing an archived post
	${a(F)??""}`)),c(x,S)},w=x=>{Be(x,{get topic(){return a(k)}})};m(V,x=>{a(F)?x(vt):x(w,!1)})}var M=l(V,2);Ja(M),c(h,W),Mt()}export{ls as component,ns as universal};
//# sourceMappingURL=12.D9YImeFM.js.map
