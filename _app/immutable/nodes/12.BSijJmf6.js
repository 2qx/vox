import{f as c,a as l,d as Nt,t as Kt}from"../chunks/DYbKDSXk.js";import{p as Pt,c as i,r as n,s as v,t as b,a as Mt,f as et,E as e,aG as E,ad as d,ac as Ft,aF as mt,au as fe}from"../chunks/DlUVEpaU.js";import{d as Yt,s as p}from"../chunks/DIwOIcma.js";import{i as k}from"../chunks/C6jlbT71.js";import"../chunks/vmZ8CxnS.js";import{o as me,a as pe}from"../chunks/CPLxGhQo.js";import{a as be}from"../chunks/Fv4VhMRE.js";import{e as ge,i as ke}from"../chunks/CMKxWac-.js";import{s as M,r as we,c as xe}from"../chunks/vpaS6ag4.js";import{b as ye,a as ze}from"../chunks/CdNq2YyO.js";import{p as Te,s as Ee}from"../chunks/jyPZu9FF.js";import{p as Se}from"../chunks/D_gM3vc7.js";import{$ as Ce,a as St}from"../chunks/CRbVXWIV.js";import{I as Ne,B as Ae,W as Pe,T as Me,N as jt,a as He}from"../chunks/PlXE8sTw.js";import{b as At}from"../chunks/B8sppVjI.js";import{b as B,c as De,d as qe,a as Be}from"../chunks/B2gQH3vd.js";import{I as Ct,s as Ue,m as Oe,t as Gt,b as ct,C as dt,F as Re}from"../chunks/DLngWCRZ.js";import{g as Ie}from"../chunks/CKFQkxAk.js";import{B as Ze,D as Le}from"../chunks/DpKBRRcz.js";import{s as Ve}from"../chunks/BLKIXdiW.js";import{C as We}from"../chunks/B7hCbxZp.js";const Fe=!0,je=({params:_,url:a})=>({postId:a.searchParams.get("postId"),topic:a.searchParams.get("topic")}),as=Object.freeze(Object.defineProperty({__proto__:null,load:je,prerender:Fe},Symbol.toStringTag,{value:"Module"}));var Ge=c("<p>Vox is a chat protocol running on Bitcoin Cash. Messages are stored in temporarily NFTs, then burned after a week… for a more stable future.</p>");function Ke(_){var a=Ge();l(_,a)}const Ye="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='15px'%20fill='%23000'%3e%3cpath%20d='M280-120q-33%200-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0%2033-23.5%2056.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160%200h80v-360h-80v360ZM280-720v520-520Z'/%3e%3c/svg%3e",Je="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='48px'%20viewBox='0%20-960%20960%20960'%20width='48px'%20fill='%23888'%3e%3cpath%20d='M272-120v-512l278-288%2058%2046-52%20242h359v171L767-120H272Zm60-60h397l126-299v-93H482l53-249-203%20214v427Zm0-427v427-427ZM79-120v-512h193v60H139v392h133v60H79Z'/%3e%3c/svg%3e";var Qe=c('<img height="32px" class="svelte-1kup2az"/>'),Xe=c('<div style="width:32px"></div>'),$e=(_,a)=>{d(a,!e(a))},ta=c('<div> <button class="svelte-1kup2az"> </button></div>'),ea=(_,a)=>{d(a,!e(a))},aa=c('<div> <button class="svelte-1kup2az"> </button></div>'),sa=c('<div class="error svelte-1kup2az"> </div>'),oa=(_,a)=>{a.likePost(a.hash)},ra=c('<img height="32px" class="svelte-1kup2az"/>'),ia=c('<div style="width:32px"></div>'),na=c('<div class="container svelte-1kup2az"><div class="auth svelte-1kup2az"><!></div> <div><div class="footer svelte-1kup2az"><div class="fill svelte-1kup2az"></div> <div class="action"></div></div> <!> <div class="footer svelte-1kup2az"><div class="hash svelte-1kup2az"> </div> <div class="fill svelte-1kup2az"></div> <div class="actions svelte-1kup2az"><button class="svelte-1kup2az"><img height="16px" alt="likes"/> </button></div> <div class="timestamp svelte-1kup2az"> </div></div></div> <div class="auth svelte-1kup2az"><!></div></div>');function va(_,a){Pt(a,!0);let g=E(!1);const V=400;var W=na(),F=i(W),it=i(F);{var w=o=>{var f=Qe();b(I=>{M(f,"src",I),M(f,"alt",a.auth)},[()=>At(a.auth,16)]),l(o,f)},U=o=>{var f=Xe();l(o,f)};k(it,o=>{a.thisAuth?o(U,!1):o(w)})}n(F);var x=v(F,2),S=v(i(x),2);{var ut=o=>{var f=Nt(),I=et(f);{var bt=K=>{var Z=ta(),ot=i(Z),X=v(ot);X.__click=[$e,g];var C=i(X,!0);n(X),n(Z),b(()=>{p(ot,`${a.body??""} `),p(C,e(g)?"show less":"show more")}),l(K,Z)},gt=(K,Z)=>{{var ot=C=>{var Y=aa(),_t=i(Y),vt=v(_t);vt.__click=[ea,g];var kt=i(vt,!0);n(vt),n(Y),b($=>{p(_t,`${$??""} `),p(kt,e(g)?"show less":"show more")},[()=>a.body.substring(0,V)+" ..."]),l(C,Y)},X=C=>{var Y=Kt();b(()=>p(Y,a.body)),l(C,Y)};k(K,C=>{a.body.length>V+20?C(ot):C(X,!1)},Z)}};k(I,K=>{a.body.length>V+20&&e(g)?K(bt):K(gt,!1)})}l(o,f)},z=o=>{var f=sa(),I=i(f,!0);n(f),b(()=>p(I,a.error)),l(o,f)};k(S,o=>{a.error?o(z,!1):o(ut)})}var j=v(S,2),H=i(j),O=i(H,!0);n(H);var at=v(H,4),G=i(at);G.__click=[oa,a];var R=i(G),pt=v(R);n(G),n(at);var D=v(at,2),st=i(D);n(D),n(j),n(x);var q=v(x,2),h=i(q);{var nt=o=>{var f=ra();b(I=>{M(f,"src",I),M(f,"alt",a.auth)},[()=>At(a.auth,16)]),l(o,f)},y=o=>{var f=ia();l(o,f)};k(h,o=>{a.thisAuth?o(nt):o(y,!1)})}n(q),n(W),b(()=>{Ve(x,1,`post ${a.thisAuth?"op":""} `,"svelte-1kup2az"),p(O,a.hash),M(R,"src",Je),p(pt,` ${a.likes??""}`),p(st,`${a.height??""} ■ ${a.sequence??""}`)}),l(_,W),Mt()}Yt(["click"]);var la=(_,a)=>a(""),ca=c('<a target="_blank"> </a>'),da=c("<img/>"),ua=c('<img alt="Disconnected"/>'),_a=(_,a,g)=>a(e(g)),ha=c('<div class="deleteMe svelte-1f5vzoo"><button class="svelte-1f5vzoo"><img height="36px"/></button></div>'),fa=c("<!> <!>",1),ma=c('<p style="color: red"> </p>'),pa=(_,a)=>a(),ba=c('<div class="row footer svelte-1f5vzoo"><h2>Create new identity</h2> <button class="svelte-1f5vzoo">New identity 1M sats</button></div>'),ga=c('<div class="row footer svelte-1f5vzoo"><p><a href="/wallet">Deposit funds</a> to create identity</p></div>'),ka=(_,a)=>a(),wa=c('<img height="32px" alt="avatar" class="svelte-1f5vzoo"/>'),xa=c('<div style="font-size:x-small;"> <br/> </div>'),ya=(_,a,g)=>a(e(g)),za=c('<div class="edit svelte-1f5vzoo"><textarea class="svelte-1f5vzoo"> </textarea> <div class="estimate svelte-1f5vzoo"> </div></div> <div class="send svelte-1f5vzoo"><div class="auth svelte-1f5vzoo"><!> <!></div> <button class="svelte-1f5vzoo">Send</button></div>',1),Ta=c("<p>Not connected?</p>"),Ea=c('<div class="row footer svelte-1f5vzoo"><!></div>'),Sa=(_,a)=>a(1e7),Ca=(_,a)=>a(1e6),Na=(_,a)=>a(),Aa=(_,a)=>a(),Pa=c('<div class="row footer svelte-1f5vzoo"><button class="svelte-1f5vzoo">Top up 10M sats</button> <button class="svelte-1f5vzoo">Top up 1M sats</button></div> <div class="row footer svelte-1f5vzoo"><button class="svelte-1f5vzoo">Clear Old Posts</button> <button class="svelte-1f5vzoo">Burn Spam</button></div>',1),Ma=c('<div class="box svelte-1f5vzoo"><div class="row header svelte-1f5vzoo"> <sub>■</sub> <div style="flex: 2 2 auto;"></div> <b><a href="/pop/">pop</a> </b> <div style="flex: 2 2 auto;"></div> <!> <!> <!></div> <div id="chat" class="row content svelte-1f5vzoo"><!></div> <!> <div class="row footer svelte-1f5vzoo"><div style="margin: auto;">Advanced</div> <div><label class="switch svelte-1f5vzoo"><input type="checkbox" class="svelte-1f5vzoo"/> <span class="slider round svelte-1f5vzoo"></span></label></div></div> <!></div>');function Ha(_,a){Pt(a,!0);const g=Se.url.hostname=="vox.cash",V=g?"bitcoincash":"bchtest",W=g?"bch.imaginary.cash":"chipnet.bch.ninja",F=g?"https://explorer.salemkode.com/address/":"https://cbch.loping.net/address/",it=Ct('OP_RETURN <"U3V">');let w=E(0),U=E(0),x=E(0n),S=E(""),ut=E(""),z=Te(a,"topic",7),j=E(""),H=E(""),O=E(0),at=E(0),G=E(!1);const R=mt(()=>B.getScriptHash(z())),pt=mt(()=>B.getAddress(z(),V));let D=E(Ft([])),st,q="",h,nt="",y,o=E(Ft([]));const f=()=>{clearTimeout(st),st=setTimeout(()=>{Z(),C()},1500)},I=async function(t){if(t.method==="blockchain.headers.subscribe"){let s=t.params[0];d(w,s.height,!0)}else t.method==="blockchain.scripthash.subscribe"?t.params[1]!==e(ut)&&(d(ut,t.params[1],!0),d(S,St[h.status],!0),f()):console.log(t)},bt=function(){let t=document.getElementById("chat");var s=t.scrollHeight;t.scrollTo(0,s)},gt=async function(t){let s=B.like(z(),t,e(o)[0],(Math.round(e(w)/1e3)+10)*10,q),r=ct(dt(s.transaction));await $(r)},K=async function(){let t=await h.request("blockchain.headers.get_tip");if(t instanceof Error)throw t;d(w,t.height,!0)},Z=async function(){let t=await h.request("blockchain.scripthash.listunspent",nt,"include_tokens");if(t instanceof Error)throw t;d(U,Gt(t),!0),d(o,t.filter(s=>s.token_data&&s.token_data.nft&&s.token_data.nft.commitment.startsWith(it)),!0),e(o).length>0&&e(o)[0].token_data&&d(H,e(o)[0].token_data.category,!0)},ot=async function(){let t=await h.request("blockchain.scripthash.listunspent",e(R),"include_tokens");if(t instanceof Error)throw t;let s=t.filter(r=>r.height>0&&e(w)-r.height>1e3);if(s.length>0){let r=B.clear(z(),s,e(o)[0],q,e(w)),u=ct(dt(r.transaction));console.log(u),await $(u)}},X=async function(){let t=await h.request("blockchain.scripthash.listunspent",e(R),"include_tokens");if(t instanceof Error)throw t;let s=t.filter(r=>Math.floor(r.value/10)*1e3-r.height<1e3);if(s.length>0){let r=B.clear(z(),s,e(o)[0],q,e(w)),u=ct(dt(r.transaction));console.log(u),await $(u)}},C=async function(){let t=await h.request("blockchain.scripthash.listunspent",e(R),"include_tokens");if(t instanceof Error)throw t;d(x,Gt(t),!0);let s=Array.from(new Set(t.map(m=>m.tx_hash))),r=await h.request("blockchain.scripthash.get_history",e(R),e(w)-1500,-1),u=await De(h,s);d(D,qe(r,u,z()),!0),d(D,e(D).map(m=>({thisAuth:e(H)==m.auth,...m})),!0),e(D).slice(-1).length>0?d(O,e(D).slice(-1)[0].height<=0?e(D).slice(-1)[0].sequence+1:0,!0):d(O,0)},Y=async function(t){let s=await h.request("blockchain.scripthash.listunspent",e(R),"include_tokens");if(s instanceof Error)throw s;let r=s.filter(T=>T.tx_hash==t.hash),u=B.clear(z(),r,e(o)[0],q,e(w)),m=ct(dt(u.transaction));await $(m)},_t=()=>{clearTimeout(st),st=setTimeout(()=>{d(at,vt(e(j)),!0)},500)},vt=function(t){if(t.length>0){let s=B.post(z(),t,e(o)[0],(Math.round(e(w)/1e3)+10)*10,q,e(O));const r=s.transaction.outputs[s.transaction.outputs.length-1].valueSatoshis;return Number(Re(s.sourceOutputs)-r)}else return 0},kt=async function(t){let s=(Math.round(e(w)/1e3)+10)*10,r=B.post(z(),t,e(o)[0],s,q,e(O)),u=ct(dt(r.transaction));await $(u),d(j,"")},$=async function(t){let s=await h.request("blockchain.transaction.broadcast",t);if(d(O,e(O)+1),s instanceof Error)throw d(S,St[h.status],!0),s},Jt=async function(){await y.sendMax(y.getDepositAddress());let t=Ct('OP_RETURN <"U3V"> <"pseudonymous">');await y.tokenGenesis({cashaddr:y.getTokenDepositAddress(),commitment:t,capability:jt.minting,value:1e6})},Ht=async function(t){d(U,e(o)[0].value,!0),d(H,e(o)[0].token_data.category,!0);let s=Ct('OP_RETURN <"U3V"> <"pseudonymous">');await y.send(new He({cashaddr:y.getTokenDepositAddress(),tokenId:e(H),commitment:s,capability:jt.minting,value:e(U)+t})),await Z()};me(async()=>{Ae.StorageProvider=Ne,y=g?await Pe.named("vox"):await Me.named("vox"),q=Ie(y.mnemonic,y.derivationPath.slice(0,-2),y.isTestnet);let t=Ue(y.getDepositAddress());if(typeof t=="string")throw t;nt=Oe(t.bytecode),h=new Ce(B.USER_AGENT,"1.4.1",W),await h.connect(),h.on("notification",I),d(S,St[h.status],!0),await h.subscribe("blockchain.scripthash.subscribe",e(R)),await h.subscribe("blockchain.scripthash.subscribe",nt),await K(),await Z(),await C(),bt()}),pe(async()=>{await y.provider.disconnect(),await h.disconnect()});var wt=Ma(),xt=i(wt),Dt=i(xt,!0),qt=v(Dt,2),yt=v(qt,3),Bt=i(yt);Bt.__click=[la,z];var Qt=v(Bt);n(yt);var Ut=v(yt,4);{var Xt=t=>{var s=ca(),r=i(s);n(s),b(u=>{M(s,"href",`${F}${e(pt)??""}`),p(r,`${u??""}k sats  `)},[()=>Math.floor(Number(e(x))/1e3).toLocaleString()]),l(t,s)};k(Ut,t=>{e(x)&&t(Xt)})}var Ot=v(Ut,2);Ze(Ot,{get template(){return B.template}});var $t=v(Ot,2);{var te=t=>{var s=da();b(()=>{M(s,"src",We),M(s,"alt",e(S))}),l(t,s)},ee=t=>{var s=ua();b(()=>M(s,"src",Le)),l(t,s)};k($t,t=>{e(S)=="CONNECTED"?t(te):t(ee,!1)})}n(xt);var zt=v(xt,2),ae=i(zt);be(ae,()=>a.transactions,null,(t,s)=>{var r=Nt(),u=et(r);ge(u,17,()=>e(D),ke,(m,T)=>{var J=fa(),tt=et(J);va(tt,Ee({likePost:gt},()=>e(T)));var lt=v(tt,2);{var N=A=>{var L=ha(),Q=i(L);Q.__click=[_a,Y,T];var ht=i(Q);n(Q),n(L),b(()=>M(ht,"src",Ye)),l(A,L)};k(lt,A=>{e(G)&&A(N)})}l(m,J)}),l(t,r)},(t,s)=>{var r=ma(),u=i(r,!0);n(r),b(()=>p(u,e(s).message)),l(t,r)}),n(zt);var Rt=v(zt,2);{var se=t=>{var s=ba(),r=v(i(s),2);r.__click=[pa,Jt],n(s),l(t,s)},oe=(t,s)=>{{var r=m=>{var T=ga();l(m,T)},u=m=>{var T=Ea(),J=i(T);{var tt=N=>{var A=za(),L=et(A),Q=i(L);xe(Q),Q.__keyup=[ka,_t];var ht=v(Q,2),ne=i(ht);n(ht),n(L);var Vt=v(L,2),Et=i(Vt),Wt=i(Et);{var ve=P=>{var rt=wa();b(ft=>M(rt,"src",ft),[()=>At(e(H),16)]),l(P,rt)};k(Wt,P=>{e(H)&&P(ve)})}var le=v(Wt,2);{var ce=P=>{var rt=xa(),ft=i(rt,!0),ue=v(ft,2);n(rt),b((_e,he)=>{p(ft,_e),p(ue,` ${he??""}sats`)},[()=>Be(e(o)[0].token_data.nft.commitment),()=>e(o)[0].value.toLocaleString()]),l(P,rt)};k(le,P=>{e(o).length>0&&P(ce)})}n(Et);var de=v(Et,2);de.__click=[ya,kt,j],n(Vt),b(P=>p(ne,`${P??""} sats`),[()=>e(at).toLocaleString()]),ze(Q,()=>e(j),P=>d(j,P)),l(N,A)},lt=N=>{var A=Ta();l(N,A)};k(J,N=>{e(S)=="CONNECTED"?N(tt):N(lt,!1)})}n(T),l(m,T)};k(t,m=>{e(U)<11e5&&e(o).length==0?m(r):m(u,!1)},s)}};k(Rt,t=>{e(U)>1e6&&e(o).length==0?t(se):t(oe,!1)})}var Tt=v(Rt,2),It=v(i(Tt),2),Zt=i(It),Lt=i(Zt);we(Lt),fe(2),n(Zt),n(It),n(Tt);var re=v(Tt,2);{var ie=t=>{var s=Nt(),r=et(s);{var u=m=>{var T=Pa(),J=et(T),tt=i(J);tt.__click=[Sa,Ht];var lt=v(tt,2);lt.__click=[Ca,Ht],n(J);var N=v(J,2),A=i(N);A.__click=[Na,ot];var L=v(A,2);L.__click=[Aa,X],n(N),l(m,T)};k(r,m=>{e(o).length>0&&m(u)})}l(t,s)};k(re,t=>{e(G)&&t(ie)})}n(wt),b(t=>{p(Dt,t),p(qt,` ${e(O)??""} `),p(Qt,` ${z()??""}`)},[()=>e(w).toLocaleString()]),ye(Lt,()=>e(G),t=>d(G,t)),l(_,wt),Mt()}Yt(["click","keyup"]);var Da=c("<!> <!>",1);function ss(_,a){Pt(a,!0);let g=mt(()=>a.data.topic),V=mt(()=>a.data.postId);var W=Da(),F=et(W);{var it=x=>{var S=Kt();b(()=>p(S,`You are viewing an archived post
	${e(V)??""}`)),l(x,S)},w=x=>{Ha(x,{get topic(){return e(g)}})};k(F,x=>{e(V)?x(it):x(w,!1)})}var U=v(F,2);Ke(U),l(_,W),Mt()}export{ss as component,as as universal};
//# sourceMappingURL=12.BSijJmf6.js.map
